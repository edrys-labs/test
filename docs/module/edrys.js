!function(e,t,r,n,i,s,o){var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},l="function"==typeof a[n]&&a[n],c=l.i||{},h=l.cache||{},d="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function u(t,r){if(!h[t]){if(!e[t]){var i="function"==typeof a[n]&&a[n];if(!r&&i)return i(t,!0);if(l)return l(t,!0);if(d&&"string"==typeof t)return d(t);var s=Error("Cannot find module '"+t+"'");throw s.code="MODULE_NOT_FOUND",s}c.resolve=function(r){var n=e[t][1][r];return null!=n?n:r},c.cache={};var o=h[t]=new u.Module(t);e[t][0].call(o.exports,c,o,o.exports,a)}return h[t].exports;function c(e){var t=c.resolve(e);return!1===t?{}:u(t)}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.require=d,this.exports={}},u.modules=e,u.cache=h,u.parent=l,u.distDir=void 0,u.publicUrl=void 0,u.devServer=void 0,u.i=c,u.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]},Object.defineProperty(u,"root",{get:function(){return a[n]}}),a[n]=u;for(var f=0;f<t.length;f++)u(t[f]);if(r){var p=u(r);"object"==typeof exports&&"undefined"!=typeof module?module.exports=p:"function"==typeof define&&define.amd&&define(function(){return p})}}({"5Hf22":[function(e,t,r,n){var i,s=e("yjs"),o=e("msgpackr"),a=e("./streamHandler");let l="extern";var c=!1,h={onReady:!1,onUpdate:!1};function d(...e){window.Edrys.debug&&console.log(`Edrys (${window.Edrys.module.name||"not ready"}):`,...e)}function u(...e){console.warn(`Edrys (${window.Edrys.module.name}):`,...e)}window.addEventListener("unload",()=>{window.parent.postMessage({event:"reload",module:window.Edrys?.module.url},window.Edrys?.origin||"*")}),window.Edrys={origin:"*",ready:!1,role:void 0,username:void 0,liveClass:void 0,liveRoom:void 0,liveUser:void 0,module:void 0,class_id:void 0,debug:!1,rtcConfig:null,onReady(e){h.onReady=!0,window.Edrys.ready?(d("READY"),e(window.Edrys)):window.addEventListener("$Edrys.ready",t=>{d("READY"),e(window.Edrys)})},onUpdate(e){h.onUpdate=!0,window.addEventListener("$Edrys.update",t=>{window.Edrys.ready&&(d("UPDATE"),e(window.Edrys))})},onMessage(e,t=!1){window.addEventListener("$Edrys.message",r=>{if(!t&&r.detail.module!=window.Edrys.module?.url)return;let n=r.detail;if(!n?._decoded)try{n.body=function(e){try{let t=atob(e),r=new Uint8Array([...t].map(e=>e.charCodeAt(0)));return(0,o.unpack)(r)}catch(e){throw e}}(n.body),n._decoded=!0}catch(e){u("Error decoding message =>",n,e);return}d("RECEIVED MESSAGE",n.subject,n.body),e(n)})},sendMessage:(e,t,r)=>{"string"!=typeof e&&(e=JSON.stringify(e)),d("SENDING MESSAGE",e,t);try{t=function(e){try{let t=(0,o.pack)(e);return btoa(String.fromCharCode(...t))}catch(e){throw e}}(t)}catch(e){console.warn("Edrys: Error encoding message =>",t,e);return}window.parent.postMessage({event:"message",subject:e,body:t,module:window.Edrys.module.url,user:r},window.Edrys.origin)},setItem(e,t){localStorage.setItem(`${window.Edrys.class_id}.${window.Edrys.liveUser.room}.${e}`,t)},getItem:e=>localStorage.getItem(`${window.Edrys.class_id}.${window.Edrys.liveUser.room}.${e}`),clearState(e){i.getMap("rooms").get(window.Edrys.liveUser.room).delete(e)},updateState(e,t){i.transact(e,t)},getState(e,t,r){let n,o=i.getMap("rooms").get(window.Edrys.liveUser.room);if(!e)return o;if(o.has(e)&&("Value"!==t||"Value"===t&&void 0===r))return o.get(e);switch(t){case"Map":n=new s.Map;break;case"Array":n=new s.Array;break;case"Text":n=new s.Text;break;case"XmlFragment":n=new s.XmlFragment;break;case"XmlText":n=new s.XmlText;break;case"XmlElement":n=new s.XmlElement;break;case"Value":if(void 0===r)return;let a=o.get(e);if(JSON.stringify(a)===JSON.stringify(r))return a;n=r;break;default:u("Unknown type =>",t);return}return o.set(e,n),n},async sendStream(e){let t=await this.getWebRTCConfig(),r=new a.StreamServer(this,e,t);return{stop:()=>r.stop()}},onStream(e){return this.getWebRTCConfig().then(async t=>{await new Promise(e=>setTimeout(e,4e3));let r=new a.StreamClient(this,e,t);return{stop:()=>r.stop()}})},async getWebRTCConfig(){return this.rtcConfig||(window.parent.postMessage({event:"requestWebRTCConfig"},this.origin),this.rtcConfig=await new Promise(e=>{let t=r=>{"webrtcConfig"===r.data.event&&(window.removeEventListener("message",t),e(r.data.config))};window.addEventListener("message",t)})),this.rtcConfig}};let f=e=>({get(t,r){if("isProxy"==r)return!0;let n=t[r];if(void 0!==n)return n.isProxy||"object"!=typeof n||(t[r]=new Proxy(n,f([...e,r]))),t[r]},set(t,r,n){if(!e.includes("__ob__")){let t=[...e,r];window.parent.postMessage({event:"update",path:t,value:n},window.Edrys.origin)}return t[r]=n,!0}});function p(){let e={users:i.getMap("users").toJSON(),rooms:i.getMap("rooms").toJSON()};Object.entries(e.rooms).forEach(([e,t])=>({name:e,data:t})),Object.entries(e.users).forEach(([e,t])=>{t.name=e}),window.Edrys.liveClass=new Proxy(e,f("")),window.Edrys.liveUser=e.users[window.Edrys.username],window.Edrys.liveRoom=e.rooms[window.Edrys.liveUser.room]}function g(){p(),dispatchEvent(new CustomEvent("$Edrys.update",{bubbles:!1}))}function m(){window.Edrys.ready||(u("Module not ready yet ..."),window.parent.postMessage({event:"reload",module:window.Edrys?.module.url||"*"},window.Edrys?.origin||"*"),setTimeout(m,5e3))}window.addEventListener("message",function(e){switch(e.data.event){case"update":window.Edrys.origin=e.data.origin,window.Edrys.role=e.data.role,window.Edrys.username=e.data.username,window.Edrys.module=e.data.module,i||((i=new s.Doc).getMap("users"),i.getMap("rooms"),i.on("update",(t,r)=>{if(p(),d("DOC",t,r),r===l){!window.Edrys.ready&&c&&(this.setTimeout(()=>{window.Edrys.ready=!0,h.onReady?dispatchEvent(new CustomEvent("$Edrys.ready",{bubbles:!1,detail:e.data})):h.onUpdate&&g()},1e3),i.getMap("rooms").observeDeep((e,t)=>{g()}),i.getMap("users").observeDeep((e,t)=>{g()}),setTimeout(g,500));return}window.parent.postMessage({event:"state",data:t},window.Edrys.origin)}));try{window.Edrys.module.config=JSON.parse(e.data.module.config)}catch(e){}try{window.Edrys.module.studentConfig=JSON.parse(e.data.module.studentConfig)}catch(e){}try{window.Edrys.module.teacherConfig=JSON.parse(e.data.module.teacherConfig)}catch(e){}try{window.Edrys.module.stationConfig=JSON.parse(e.data.module.stationConfig)}catch(e){}window.Edrys.class_id=e.data.class_id,e.data.liveClass&&(c=!0,s.applyUpdate(i,e.data.liveClass,l));break;case"message":break;case"echo":console.log("ECHO:",e.data);break;case"webrtcConfig":window.Edrys.rtcConfig=e.data.config}"update"!==e.data.event&&dispatchEvent(new CustomEvent("$Edrys."+e.data.event,{bubbles:!1,detail:e.data}))},!1),window.addEventListener("load",()=>{setTimeout(m,2e3)})},{yjs:"dTroZ",msgpackr:"jCq4q","./streamHandler":"blYkP"}],dTroZ:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"AbsolutePosition",()=>eD),i.export(r,"AbstractConnector",()=>k),i.export(r,"AbstractStruct",()=>rN),i.export(r,"AbstractType",()=>tZ),i.export(r,"Array",()=>rd),i.export(r,"ContentAny",()=>rG),i.export(r,"ContentBinary",()=>rV),i.export(r,"ContentDeleted",()=>rP),i.export(r,"ContentDoc",()=>rq),i.export(r,"ContentEmbed",()=>r$),i.export(r,"ContentFormat",()=>rz),i.export(r,"ContentJSON",()=>rH),i.export(r,"ContentString",()=>rY),i.export(r,"ContentType",()=>r8),i.export(r,"Doc",()=>F),i.export(r,"GC",()=>rL),i.export(r,"ID",()=>ex),i.export(r,"Item",()=>r7),i.export(r,"Map",()=>rf),i.export(r,"PermanentUserData",()=>eT),i.export(r,"RelativePosition",()=>eC),i.export(r,"Skip",()=>nr),i.export(r,"Snapshot",()=>eq),i.export(r,"Text",()=>r_),i.export(r,"Transaction",()=>tn),i.export(r,"UndoManager",()=>tg),i.export(r,"UpdateDecoderV1",()=>$),i.export(r,"UpdateDecoderV2",()=>H),i.export(r,"UpdateEncoderV1",()=>G),i.export(r,"UpdateEncoderV2",()=>W),i.export(r,"XmlElement",()=>rB),i.export(r,"XmlFragment",()=>rj),i.export(r,"XmlHook",()=>rR),i.export(r,"XmlText",()=>rM),i.export(r,"YArrayEvent",()=>rh),i.export(r,"YEvent",()=>tF),i.export(r,"YMapEvent",()=>ru),i.export(r,"YTextEvent",()=>rA),i.export(r,"YXmlEvent",()=>rO),i.export(r,"applyUpdate",()=>ei),i.export(r,"applyUpdateV2",()=>en),i.export(r,"cleanupYTextFormatting",()=>rU),i.export(r,"compareIDs",()=>eb),i.export(r,"compareRelativePositions",()=>eF),i.export(r,"convertUpdateFormatV1ToV2",()=>tL),i.export(r,"convertUpdateFormatV2ToV1",()=>tV),i.export(r,"createAbsolutePositionFromRelativePosition",()=>eP),i.export(r,"createDeleteSet",()=>O),i.export(r,"createDeleteSetFromStructStore",()=>R),i.export(r,"createDocFromSnapshot",()=>eZ),i.export(r,"createID",()=>eE),i.export(r,"createRelativePositionFromJSON",()=>e_),i.export(r,"createRelativePositionFromTypeIndex",()=>eO),i.export(r,"createSnapshot",()=>eY),i.export(r,"decodeRelativePosition",()=>eL),i.export(r,"decodeSnapshot",()=>eG),i.export(r,"decodeSnapshotV2",()=>eJ),i.export(r,"decodeStateVector",()=>ec),i.export(r,"decodeUpdate",()=>tx),i.export(r,"decodeUpdateV2",()=>tb),i.export(r,"diffUpdate",()=>t_),i.export(r,"diffUpdateV2",()=>tA),i.export(r,"emptySnapshot",()=>eW),i.export(r,"encodeRelativePosition",()=>eM),i.export(r,"encodeSnapshot",()=>eH),i.export(r,"encodeSnapshotV2",()=>ez),i.export(r,"encodeStateAsUpdate",()=>ea),i.export(r,"encodeStateAsUpdateV2",()=>eo),i.export(r,"encodeStateVector",()=>ef),i.export(r,"encodeStateVectorFromUpdate",()=>tv),i.export(r,"encodeStateVectorFromUpdateV2",()=>tS),i.export(r,"equalDeleteSets",()=>V),i.export(r,"equalSnapshots",()=>e$),i.export(r,"findIndexSS",()=>e5),i.export(r,"findRootTypeKey",()=>ev),i.export(r,"getItem",()=>e4),i.export(r,"getItemCleanEnd",()=>te),i.export(r,"getItemCleanStart",()=>e7),i.export(r,"getState",()=>e6),i.export(r,"getTypeChildren",()=>tK),i.export(r,"isDeleted",()=>_),i.export(r,"isParentOf",()=>ek),i.export(r,"iterateDeletedStructs",()=>C),i.export(r,"logType",()=>eU),i.export(r,"logUpdate",()=>ty),i.export(r,"logUpdateV2",()=>tw),i.export(r,"mergeDeleteSets",()=>j),i.export(r,"mergeUpdates",()=>tI),i.export(r,"mergeUpdatesV2",()=>tC),i.export(r,"obfuscateUpdate",()=>tM),i.export(r,"obfuscateUpdateV2",()=>tN),i.export(r,"parseUpdateMeta",()=>tU),i.export(r,"parseUpdateMetaV2",()=>tk),i.export(r,"readUpdate",()=>er),i.export(r,"readUpdateV2",()=>et),i.export(r,"relativePositionToJSON",()=>eA),i.export(r,"snapshot",()=>eX),i.export(r,"snapshotContainsUpdate",()=>e1),i.export(r,"transact",()=>td),i.export(r,"tryGc",()=>tc),i.export(r,"typeListToArraySnapshot",()=>t2),i.export(r,"typeMapGetAllSnapshot",()=>rl),i.export(r,"typeMapGetSnapshot",()=>ra);var s=e("lib0/observable"),o=e("lib0/array"),a=e("lib0/math"),l=e("lib0/map"),c=e("lib0/encoding"),h=e("lib0/decoding"),d=e("lib0/random"),u=e("lib0/promise"),f=e("lib0/buffer"),p=e("lib0/error"),g=e("lib0/binary"),m=e("lib0/function"),y=e("lib0/set"),w=e("lib0/logging"),x=e("lib0/time"),b=e("lib0/string"),E=e("lib0/iterator"),I=e("lib0/object"),S=e("lib0/environment"),v=arguments[3];class k extends s.ObservableV2{constructor(e,t){super(),this.doc=e,this.awareness=t}}class U{constructor(e,t){this.clock=e,this.len=t}}class T{constructor(){this.clients=new Map}}let C=(e,t,r)=>t.clients.forEach((t,n)=>{let i=e.doc.store.clients.get(n);for(let n=0;n<t.length;n++){let s=t[n];tr(e,i,s.clock,s.len,r)}}),A=(e,t)=>{let r=0,n=e.length-1;for(;r<=n;){let i=a.floor((r+n)/2),s=e[i],o=s.clock;if(o<=t){if(t<o+s.len)return i;r=i+1}else n=i-1}return null},_=(e,t)=>{let r=e.clients.get(t.client);return void 0!==r&&null!==A(r,t.clock)},D=e=>{e.clients.forEach(e=>{let t,r;for(e.sort((e,t)=>e.clock-t.clock),t=1,r=1;t<e.length;t++){let n=e[r-1],i=e[t];n.clock+n.len>=i.clock?n.len=a.max(n.len,i.clock+i.len-n.clock):(r<t&&(e[r]=i),r++)}e.length=r})},j=e=>{let t=new T;for(let r=0;r<e.length;r++)e[r].clients.forEach((n,i)=>{if(!t.clients.has(i)){let s=n.slice();for(let t=r+1;t<e.length;t++)o.appendTo(s,e[t].clients.get(i)||[]);t.clients.set(i,s)}});return D(t),t},B=(e,t,r,n)=>{l.setIfUndefined(e.clients,t,()=>[]).push(new U(r,n))},O=()=>new T,R=e=>{let t=O();return e.clients.forEach((e,r)=>{let n=[];for(let t=0;t<e.length;t++){let r=e[t];if(r.deleted){let i=r.id.clock,s=r.length;if(t+1<e.length)for(let r=e[t+1];t+1<e.length&&r.deleted;r=e[++t+1])s+=r.length;n.push(new U(i,s))}}n.length>0&&t.clients.set(r,n)}),t},M=(e,t)=>{c.writeVarUint(e.restEncoder,t.clients.size),o.from(t.clients.entries()).sort((e,t)=>t[0]-e[0]).forEach(([t,r])=>{e.resetDsCurVal(),c.writeVarUint(e.restEncoder,t);let n=r.length;c.writeVarUint(e.restEncoder,n);for(let t=0;t<n;t++){let n=r[t];e.writeDsClock(n.clock),e.writeDsLen(n.len)}})},N=e=>{let t=new T,r=h.readVarUint(e.restDecoder);for(let n=0;n<r;n++){e.resetDsCurVal();let r=h.readVarUint(e.restDecoder),n=h.readVarUint(e.restDecoder);if(n>0){let i=l.setIfUndefined(t.clients,r,()=>[]);for(let t=0;t<n;t++)i.push(new U(e.readDsClock(),e.readDsLen()))}}return t},L=(e,t,r)=>{let n=new T,i=h.readVarUint(e.restDecoder);for(let s=0;s<i;s++){e.resetDsCurVal();let i=h.readVarUint(e.restDecoder),s=h.readVarUint(e.restDecoder),o=r.clients.get(i)||[],a=e6(r,i);for(let r=0;r<s;r++){let r=e.readDsClock(),s=r+e.readDsLen();if(r<a){a<s&&B(n,i,a,s-a);let e=e5(o,r),l=o[e];for(!l.deleted&&l.id.clock<r&&(o.splice(e+1,0,r5(t,l,r-l.id.clock)),e++);e<o.length;)if((l=o[e++]).id.clock<s)l.deleted||(s<l.id.clock+l.length&&o.splice(e,0,r5(t,l,s-l.id.clock)),l.delete(t));else break}else B(n,i,r,s-r)}}if(n.clients.size>0){let e=new W;return c.writeVarUint(e.restEncoder,0),M(e,n),e.toUint8Array()}return null},V=(e,t)=>{if(e.clients.size!==t.clients.size)return!1;for(let[r,n]of e.clients.entries()){let e=t.clients.get(r);if(void 0===e||n.length!==e.length)return!1;for(let t=0;t<n.length;t++){let r=n[t],i=e[t];if(r.clock!==i.clock||r.len!==i.len)return!1}}return!0},P=d.uint32;class F extends s.ObservableV2{constructor({guid:e=d.uuidv4(),collectionid:t=null,gc:r=!0,gcFilter:n=()=>!0,meta:i=null,autoLoad:s=!1,shouldLoad:o=!0}={}){super(),this.gc=r,this.gcFilter=n,this.clientID=P(),this.guid=e,this.collectionid=t,this.share=new Map,this.store=new e2,this._transaction=null,this._transactionCleanups=[],this.subdocs=new Set,this._item=null,this.shouldLoad=o,this.autoLoad=s,this.meta=i,this.isLoaded=!1,this.isSynced=!1,this.isDestroyed=!1,this.whenLoaded=u.create(e=>{this.on("load",()=>{this.isLoaded=!0,e(this)})});let a=()=>u.create(e=>{let t=r=>{(void 0===r||!0===r)&&(this.off("sync",t),e())};this.on("sync",t)});this.on("sync",e=>{!1===e&&this.isSynced&&(this.whenSynced=a()),this.isSynced=void 0===e||!0===e,this.isSynced&&!this.isLoaded&&this.emit("load",[this])}),this.whenSynced=a()}load(){let e=this._item;null===e||this.shouldLoad||td(e.parent.doc,e=>{e.subdocsLoaded.add(this)},null,!0),this.shouldLoad=!0}getSubdocs(){return this.subdocs}getSubdocGuids(){return new Set(o.from(this.subdocs).map(e=>e.guid))}transact(e,t=null){return td(this,e,t)}get(e,t=tZ){let r=l.setIfUndefined(this.share,e,()=>{let e=new t;return e._integrate(this,null),e}),n=r.constructor;if(t!==tZ&&n!==t){if(n===tZ){let n=new t;n._map=r._map,r._map.forEach(e=>{for(;null!==e;e=e.left)e.parent=n}),n._start=r._start;for(let e=n._start;null!==e;e=e.right)e.parent=n;return n._length=r._length,this.share.set(e,n),n._integrate(this,null),n}throw Error(`Type with the name ${e} has already been defined with a different constructor`)}return r}getArray(e=""){return this.get(e,rd)}getText(e=""){return this.get(e,r_)}getMap(e=""){return this.get(e,rf)}getXmlElement(e=""){return this.get(e,rB)}getXmlFragment(e=""){return this.get(e,rj)}toJSON(){let e={};return this.share.forEach((t,r)=>{e[r]=t.toJSON()}),e}destroy(){this.isDestroyed=!0,o.from(this.subdocs).forEach(e=>e.destroy());let e=this._item;if(null!==e){this._item=null;let t=e.content;t.doc=new F({guid:this.guid,...t.opts,shouldLoad:!1}),t.doc._item=e,td(e.parent.doc,r=>{let n=t.doc;e.deleted||r.subdocsAdded.add(n),r.subdocsRemoved.add(this)},null,!0)}this.emit("destroyed",[!0]),this.emit("destroy",[this]),super.destroy()}}class q{constructor(e){this.restDecoder=e}resetDsCurVal(){}readDsClock(){return h.readVarUint(this.restDecoder)}readDsLen(){return h.readVarUint(this.restDecoder)}}class $ extends q{readLeftID(){return eE(h.readVarUint(this.restDecoder),h.readVarUint(this.restDecoder))}readRightID(){return eE(h.readVarUint(this.restDecoder),h.readVarUint(this.restDecoder))}readClient(){return h.readVarUint(this.restDecoder)}readInfo(){return h.readUint8(this.restDecoder)}readString(){return h.readVarString(this.restDecoder)}readParentInfo(){return 1===h.readVarUint(this.restDecoder)}readTypeRef(){return h.readVarUint(this.restDecoder)}readLen(){return h.readVarUint(this.restDecoder)}readAny(){return h.readAny(this.restDecoder)}readBuf(){return f.copyUint8Array(h.readVarUint8Array(this.restDecoder))}readJSON(){return JSON.parse(h.readVarString(this.restDecoder))}readKey(){return h.readVarString(this.restDecoder)}}class z{constructor(e){this.dsCurrVal=0,this.restDecoder=e}resetDsCurVal(){this.dsCurrVal=0}readDsClock(){return this.dsCurrVal+=h.readVarUint(this.restDecoder),this.dsCurrVal}readDsLen(){let e=h.readVarUint(this.restDecoder)+1;return this.dsCurrVal+=e,e}}class H extends z{constructor(e){super(e),this.keys=[],h.readVarUint(e),this.keyClockDecoder=new h.IntDiffOptRleDecoder(h.readVarUint8Array(e)),this.clientDecoder=new h.UintOptRleDecoder(h.readVarUint8Array(e)),this.leftClockDecoder=new h.IntDiffOptRleDecoder(h.readVarUint8Array(e)),this.rightClockDecoder=new h.IntDiffOptRleDecoder(h.readVarUint8Array(e)),this.infoDecoder=new h.RleDecoder(h.readVarUint8Array(e),h.readUint8),this.stringDecoder=new h.StringDecoder(h.readVarUint8Array(e)),this.parentInfoDecoder=new h.RleDecoder(h.readVarUint8Array(e),h.readUint8),this.typeRefDecoder=new h.UintOptRleDecoder(h.readVarUint8Array(e)),this.lenDecoder=new h.UintOptRleDecoder(h.readVarUint8Array(e))}readLeftID(){return new ex(this.clientDecoder.read(),this.leftClockDecoder.read())}readRightID(){return new ex(this.clientDecoder.read(),this.rightClockDecoder.read())}readClient(){return this.clientDecoder.read()}readInfo(){return this.infoDecoder.read()}readString(){return this.stringDecoder.read()}readParentInfo(){return 1===this.parentInfoDecoder.read()}readTypeRef(){return this.typeRefDecoder.read()}readLen(){return this.lenDecoder.read()}readAny(){return h.readAny(this.restDecoder)}readBuf(){return h.readVarUint8Array(this.restDecoder)}readJSON(){return h.readAny(this.restDecoder)}readKey(){let e=this.keyClockDecoder.read();if(e<this.keys.length)return this.keys[e];{let e=this.stringDecoder.read();return this.keys.push(e),e}}}class J{constructor(){this.restEncoder=c.createEncoder()}toUint8Array(){return c.toUint8Array(this.restEncoder)}resetDsCurVal(){}writeDsClock(e){c.writeVarUint(this.restEncoder,e)}writeDsLen(e){c.writeVarUint(this.restEncoder,e)}}class G extends J{writeLeftID(e){c.writeVarUint(this.restEncoder,e.client),c.writeVarUint(this.restEncoder,e.clock)}writeRightID(e){c.writeVarUint(this.restEncoder,e.client),c.writeVarUint(this.restEncoder,e.clock)}writeClient(e){c.writeVarUint(this.restEncoder,e)}writeInfo(e){c.writeUint8(this.restEncoder,e)}writeString(e){c.writeVarString(this.restEncoder,e)}writeParentInfo(e){c.writeVarUint(this.restEncoder,+!!e)}writeTypeRef(e){c.writeVarUint(this.restEncoder,e)}writeLen(e){c.writeVarUint(this.restEncoder,e)}writeAny(e){c.writeAny(this.restEncoder,e)}writeBuf(e){c.writeVarUint8Array(this.restEncoder,e)}writeJSON(e){c.writeVarString(this.restEncoder,JSON.stringify(e))}writeKey(e){c.writeVarString(this.restEncoder,e)}}class Y{constructor(){this.restEncoder=c.createEncoder(),this.dsCurrVal=0}toUint8Array(){return c.toUint8Array(this.restEncoder)}resetDsCurVal(){this.dsCurrVal=0}writeDsClock(e){let t=e-this.dsCurrVal;this.dsCurrVal=e,c.writeVarUint(this.restEncoder,t)}writeDsLen(e){0===e&&p.unexpectedCase(),c.writeVarUint(this.restEncoder,e-1),this.dsCurrVal+=e}}class W extends Y{constructor(){super(),this.keyMap=new Map,this.keyClock=0,this.keyClockEncoder=new c.IntDiffOptRleEncoder,this.clientEncoder=new c.UintOptRleEncoder,this.leftClockEncoder=new c.IntDiffOptRleEncoder,this.rightClockEncoder=new c.IntDiffOptRleEncoder,this.infoEncoder=new c.RleEncoder(c.writeUint8),this.stringEncoder=new c.StringEncoder,this.parentInfoEncoder=new c.RleEncoder(c.writeUint8),this.typeRefEncoder=new c.UintOptRleEncoder,this.lenEncoder=new c.UintOptRleEncoder}toUint8Array(){let e=c.createEncoder();return c.writeVarUint(e,0),c.writeVarUint8Array(e,this.keyClockEncoder.toUint8Array()),c.writeVarUint8Array(e,this.clientEncoder.toUint8Array()),c.writeVarUint8Array(e,this.leftClockEncoder.toUint8Array()),c.writeVarUint8Array(e,this.rightClockEncoder.toUint8Array()),c.writeVarUint8Array(e,c.toUint8Array(this.infoEncoder)),c.writeVarUint8Array(e,this.stringEncoder.toUint8Array()),c.writeVarUint8Array(e,c.toUint8Array(this.parentInfoEncoder)),c.writeVarUint8Array(e,this.typeRefEncoder.toUint8Array()),c.writeVarUint8Array(e,this.lenEncoder.toUint8Array()),c.writeUint8Array(e,c.toUint8Array(this.restEncoder)),c.toUint8Array(e)}writeLeftID(e){this.clientEncoder.write(e.client),this.leftClockEncoder.write(e.clock)}writeRightID(e){this.clientEncoder.write(e.client),this.rightClockEncoder.write(e.clock)}writeClient(e){this.clientEncoder.write(e)}writeInfo(e){this.infoEncoder.write(e)}writeString(e){this.stringEncoder.write(e)}writeParentInfo(e){this.parentInfoEncoder.write(+!!e)}writeTypeRef(e){this.typeRefEncoder.write(e)}writeLen(e){this.lenEncoder.write(e)}writeAny(e){c.writeAny(this.restEncoder,e)}writeBuf(e){c.writeVarUint8Array(this.restEncoder,e)}writeJSON(e){c.writeAny(this.restEncoder,e)}writeKey(e){let t=this.keyMap.get(e);void 0===t?(this.keyClockEncoder.write(this.keyClock++),this.stringEncoder.write(e)):this.keyClockEncoder.write(t)}}let X=(e,t,r,n)=>{n=a.max(n,t[0].id.clock);let i=e5(t,n);c.writeVarUint(e.restEncoder,t.length-i),e.writeClient(r),c.writeVarUint(e.restEncoder,n);let s=t[i];s.write(e,n-s.id.clock);for(let r=i+1;r<t.length;r++)t[r].write(e,0)},K=(e,t,r)=>{let n=new Map;r.forEach((e,r)=>{e6(t,r)>e&&n.set(r,e)}),e8(t).forEach((e,t)=>{r.has(t)||n.set(t,0)}),c.writeVarUint(e.restEncoder,n.size),o.from(n.entries()).sort((e,t)=>t[0]-e[0]).forEach(([r,n])=>{X(e,t.clients.get(r),r,n)})},Q=(e,t)=>{let r=l.create(),n=h.readVarUint(e.restDecoder);for(let i=0;i<n;i++){let n=h.readVarUint(e.restDecoder),i=Array(n),s=e.readClient(),o=h.readVarUint(e.restDecoder);r.set(s,{i:0,refs:i});for(let r=0;r<n;r++){let n=e.readInfo();switch(g.BITS5&n){case 0:{let t=e.readLen();i[r]=new rL(eE(s,o),t),o+=t;break}case 10:{let t=h.readVarUint(e.restDecoder);i[r]=new nr(eE(s,o),t),o+=t;break}default:{let a=(n&(g.BIT7|g.BIT8))==0,l=new r7(eE(s,o),null,(n&g.BIT8)===g.BIT8?e.readLeftID():null,null,(n&g.BIT7)===g.BIT7?e.readRightID():null,a?e.readParentInfo()?t.get(e.readString()):e.readLeftID():null,a&&(n&g.BIT6)===g.BIT6?e.readString():null,ne(e,n));i[r]=l,o+=l.length}}}}return r},Z=(e,t,r)=>{let n=[],i=o.from(r.keys()).sort((e,t)=>e-t);if(0===i.length)return null;let s=()=>{if(0===i.length)return null;let e=r.get(i[i.length-1]);for(;e.refs.length===e.i;){if(i.pop(),!(i.length>0))return null;e=r.get(i[i.length-1])}return e},a=s();if(null===a)return null;let h=new e2,d=new Map,u=(e,t)=>{let r=d.get(e);(null==r||r>t)&&d.set(e,t)},f=a.refs[a.i++],p=new Map,g=()=>{for(let e of n){let t=e.id.client,n=r.get(t);n?(n.i--,h.clients.set(t,n.refs.slice(n.i)),r.delete(t),n.i=0,n.refs=[]):h.clients.set(t,[e]),i=i.filter(e=>e!==t)}n.length=0};for(;;){if(f.constructor!==nr){let i=l.setIfUndefined(p,f.id.client,()=>e6(t,f.id.client))-f.id.clock;if(i<0)n.push(f),u(f.id.client,f.id.clock-1),g();else{let s=f.getMissing(e,t);if(null!==s){n.push(f);let e=r.get(s)||{refs:[],i:0};if(e.refs.length===e.i)u(s,e6(t,s)),g();else{f=e.refs[e.i++];continue}}else(0===i||i<f.length)&&(f.integrate(e,i),p.set(f.id.client,f.id.clock+f.length))}}if(n.length>0)f=n.pop();else if(null!==a&&a.i<a.refs.length)f=a.refs[a.i++];else{if(null===(a=s()))break;f=a.refs[a.i++]}}if(h.clients.size>0){let e=new W;return K(e,h,new Map),c.writeVarUint(e.restEncoder,0),{missing:d,update:e.toUint8Array()}}return null},ee=(e,t)=>K(e,t.doc.store,t.beforeState),et=(e,t,r,n=new H(e))=>td(t,e=>{e.local=!1;let t=!1,r=e.doc,i=r.store,s=Z(e,i,Q(n,r)),o=i.pendingStructs;if(o){for(let[e,r]of o.missing)if(r<e6(i,e)){t=!0;break}if(s){for(let[e,t]of s.missing){let r=o.missing.get(e);(null==r||r>t)&&o.missing.set(e,t)}o.update=tC([o.update,s.update])}}else i.pendingStructs=s;let a=L(n,e,i);if(i.pendingDs){let t=new H(h.createDecoder(i.pendingDs));h.readVarUint(t.restDecoder);let r=L(t,e,i);a&&r?i.pendingDs=tC([a,r]):i.pendingDs=a||r}else i.pendingDs=a;if(t){let t=i.pendingStructs.update;i.pendingStructs=null,en(e.doc,t)}},r,!1),er=(e,t,r)=>et(e,t,r,new $(e)),en=(e,t,r,n=H)=>{let i=h.createDecoder(t);et(i,e,r,new n(i))},ei=(e,t,r)=>en(e,t,r,$),es=(e,t,r=new Map)=>{K(e,t.store,r),M(e,R(t.store))},eo=(e,t=new Uint8Array([0]),r=new W)=>{es(r,e,ec(t));let n=[r.toUint8Array()];if(e.store.pendingDs&&n.push(e.store.pendingDs),e.store.pendingStructs&&n.push(tA(e.store.pendingStructs.update,t)),n.length>1){if(r.constructor===G)return tI(n.map((e,t)=>0===t?e:tV(e)));if(r.constructor===W)return tC(n)}return n[0]},ea=(e,t)=>eo(e,t,new G),el=e=>{let t=new Map,r=h.readVarUint(e.restDecoder);for(let n=0;n<r;n++){let r=h.readVarUint(e.restDecoder),n=h.readVarUint(e.restDecoder);t.set(r,n)}return t},ec=e=>el(new q(h.createDecoder(e))),eh=(e,t)=>(c.writeVarUint(e.restEncoder,t.size),o.from(t.entries()).sort((e,t)=>t[0]-e[0]).forEach(([t,r])=>{c.writeVarUint(e.restEncoder,t),c.writeVarUint(e.restEncoder,r)}),e),ed=(e,t)=>eh(e,e8(t.store)),eu=(e,t=new Y)=>(e instanceof Map?eh(t,e):ed(t,e),t.toUint8Array()),ef=e=>eu(e,new J);class ep{constructor(){this.l=[]}}let eg=()=>new ep,em=(e,t)=>e.l.push(t),ey=(e,t)=>{let r=e.l,n=r.length;e.l=r.filter(e=>t!==e),n===e.l.length&&console.error("[yjs] Tried to remove event handler that doesn't exist.")},ew=(e,t,r)=>m.callAll(e.l,[t,r]);class ex{constructor(e,t){this.client=e,this.clock=t}}let eb=(e,t)=>e===t||null!==e&&null!==t&&e.client===t.client&&e.clock===t.clock,eE=(e,t)=>new ex(e,t),eI=(e,t)=>{c.writeVarUint(e,t.client),c.writeVarUint(e,t.clock)},eS=e=>eE(h.readVarUint(e),h.readVarUint(e)),ev=e=>{for(let[t,r]of e.doc.share.entries())if(r===e)return t;throw p.unexpectedCase()},ek=(e,t)=>{for(;null!==t;){if(t.parent===e)return!0;t=t.parent._item}return!1},eU=e=>{let t=[],r=e._start;for(;r;)t.push(r),r=r.right;console.log("Children: ",t),console.log("Children content: ",t.filter(e=>!e.deleted).map(e=>e.content))};class eT{constructor(e,t=e.getMap("users")){let r=new Map;this.yusers=t,this.doc=e,this.clients=new Map,this.dss=r;let n=(e,t)=>{let r=e.get("ds"),n=e.get("ids"),i=e=>this.clients.set(e,t);r.observe(e=>{e.changes.added.forEach(e=>{e.content.getContent().forEach(e=>{e instanceof Uint8Array&&this.dss.set(t,j([this.dss.get(t)||O(),N(new q(h.createDecoder(e)))]))})})}),this.dss.set(t,j(r.map(e=>N(new q(h.createDecoder(e)))))),n.observe(e=>e.changes.added.forEach(e=>e.content.getContent().forEach(i))),n.forEach(i)};t.observe(e=>{e.keysChanged.forEach(e=>n(t.get(e),e))}),t.forEach(n)}setUserMapping(e,t,r,{filter:n=()=>!0}={}){let i=this.yusers,s=i.get(r);s||((s=new rf).set("ids",new rd),s.set("ds",new rd),i.set(r,s)),s.get("ids").push([t]),i.observe(e=>{setTimeout(()=>{let e=i.get(r);if(e!==s){s=e,this.clients.forEach((e,t)=>{r===e&&s.get("ids").push([t])});let t=new J,n=this.dss.get(r);n&&(M(t,n),s.get("ds").push([t.toUint8Array()]))}},0)}),e.on("afterTransaction",e=>{setTimeout(()=>{let t=s.get("ds"),r=e.deleteSet;if(e.local&&r.clients.size>0&&n(e,r)){let e=new J;M(e,r),t.push([e.toUint8Array()])}})})}getUserByClientId(e){return this.clients.get(e)||null}getUserByDeletedId(e){for(let[t,r]of this.dss.entries())if(_(r,e))return t;return null}}class eC{constructor(e,t,r,n=0){this.type=e,this.tname=t,this.item=r,this.assoc=n}}let eA=e=>{let t={};return e.type&&(t.type=e.type),e.tname&&(t.tname=e.tname),e.item&&(t.item=e.item),null!=e.assoc&&(t.assoc=e.assoc),t},e_=e=>new eC(null==e.type?null:eE(e.type.client,e.type.clock),e.tname??null,null==e.item?null:eE(e.item.client,e.item.clock),null==e.assoc?0:e.assoc);class eD{constructor(e,t,r=0){this.type=e,this.index=t,this.assoc=r}}let ej=(e,t,r=0)=>new eD(e,t,r),eB=(e,t,r)=>{let n=null,i=null;return null===e._item?i=ev(e):n=eE(e._item.id.client,e._item.id.clock),new eC(n,i,t,r)},eO=(e,t,r=0)=>{let n=e._start;if(r<0){if(0===t)return eB(e,null,r);t--}for(;null!==n;){if(!n.deleted&&n.countable){if(n.length>t)return eB(e,eE(n.id.client,n.id.clock+t),r);t-=n.length}if(null===n.right&&r<0)return eB(e,n.lastId,r);n=n.right}return eB(e,null,r)},eR=(e,t)=>{let{type:r,tname:n,item:i,assoc:s}=t;if(null!==i)c.writeVarUint(e,0),eI(e,i);else if(null!==n)c.writeUint8(e,1),c.writeVarString(e,n);else if(null!==r)c.writeUint8(e,2),eI(e,r);else throw p.unexpectedCase();return c.writeVarInt(e,s),e},eM=e=>{let t=c.createEncoder();return eR(t,e),c.toUint8Array(t)},eN=e=>{let t=null,r=null,n=null;switch(h.readVarUint(e)){case 0:n=eS(e);break;case 1:r=h.readVarString(e);break;case 2:t=eS(e)}return new eC(t,r,n,h.hasContent(e)?h.readVarInt(e):0)},eL=e=>eN(h.createDecoder(e)),eV=(e,t)=>{let r=e4(e,t),n=t.clock-r.id.clock;return{item:r,diff:n}},eP=(e,t,r=!0)=>{let n=t.store,i=e.item,s=e.type,o=e.tname,a=e.assoc,l=null,c=0;if(null!==i){if(e6(n,i.client)<=i.clock)return null;let e=r?r6(n,i):eV(n,i),t=e.item;if(!(t instanceof r7))return null;if(null===(l=t.parent)._item||!l._item.deleted){c=t.deleted||!t.countable?0:e.diff+(a>=0?0:1);let r=t.left;for(;null!==r;)!r.deleted&&r.countable&&(c+=r.length),r=r.left}}else{if(null!==o)l=t.get(o);else if(null!==s){if(e6(n,s.client)<=s.clock)return null;let{item:e}=r?r6(n,s):{item:e4(n,s)};if(!(e instanceof r7)||!(e.content instanceof r8))return null;l=e.content.type}else throw p.unexpectedCase();c=a>=0?l._length:0}return ej(l,c,e.assoc)},eF=(e,t)=>e===t||null!==e&&null!==t&&e.tname===t.tname&&eb(e.item,t.item)&&eb(e.type,t.type)&&e.assoc===t.assoc;class eq{constructor(e,t){this.ds=e,this.sv=t}}let e$=(e,t)=>{let r=e.ds.clients,n=t.ds.clients,i=e.sv,s=t.sv;if(i.size!==s.size||r.size!==n.size)return!1;for(let[e,t]of i.entries())if(s.get(e)!==t)return!1;for(let[e,t]of r.entries()){let r=n.get(e)||[];if(t.length!==r.length)return!1;for(let e=0;e<t.length;e++){let n=t[e],i=r[e];if(n.clock!==i.clock||n.len!==i.len)return!1}}return!0},ez=(e,t=new Y)=>(M(t,e.ds),eh(t,e.sv),t.toUint8Array()),eH=e=>ez(e,new J),eJ=(e,t=new z(h.createDecoder(e)))=>new eq(N(t),el(t)),eG=e=>eJ(e,new q(h.createDecoder(e))),eY=(e,t)=>new eq(e,t),eW=eY(O(),new Map),eX=e=>eY(R(e.store),e8(e.store)),eK=(e,t)=>void 0===t?!e.deleted:t.sv.has(e.id.client)&&(t.sv.get(e.id.client)||0)>e.id.clock&&!_(t.ds,e.id),eQ=(e,t)=>{let r=l.setIfUndefined(e.meta,eQ,y.create),n=e.doc.store;r.has(t)||(t.sv.forEach((t,r)=>{t<e6(n,r)&&e7(e,eE(r,t))}),C(e,t.ds,e=>{}),r.add(t))},eZ=(e,t,r=new F)=>{if(e.gc)throw Error("Garbage-collection must be disabled in `originDoc`!");let{sv:n,ds:i}=t,s=new W;return e.transact(t=>{let r=0;for(let[i,o]of(n.forEach(e=>{e>0&&r++}),c.writeVarUint(s.restEncoder,r),n)){if(0===o)continue;o<e6(e.store,i)&&e7(t,eE(i,o));let r=e.store.clients.get(i)||[],n=e5(r,o-1);c.writeVarUint(s.restEncoder,n+1),s.writeClient(i),c.writeVarUint(s.restEncoder,0);for(let e=0;e<=n;e++)r[e].write(s,0)}M(s,i)}),en(r,s.toUint8Array(),"snapshot"),r},e0=(e,t,r=H)=>{let n=new r(h.createDecoder(t)),i=new tm(n,!1);for(let t=i.curr;null!==t;t=i.next())if((e.sv.get(t.id.client)||0)<t.id.clock+t.length)return!1;let s=j([e.ds,N(n)]);return V(e.ds,s)},e1=(e,t)=>e0(e,t,$);class e2{constructor(){this.clients=new Map,this.pendingStructs=null,this.pendingDs=null}}let e8=e=>{let t=new Map;return e.clients.forEach((e,r)=>{let n=e[e.length-1];t.set(r,n.id.clock+n.length)}),t},e6=(e,t)=>{let r=e.clients.get(t);if(void 0===r)return 0;let n=r[r.length-1];return n.id.clock+n.length},e3=(e,t)=>{let r=e.clients.get(t.id.client);if(void 0===r)r=[],e.clients.set(t.id.client,r);else{let e=r[r.length-1];if(e.id.clock+e.length!==t.id.clock)throw p.unexpectedCase()}r.push(t)},e5=(e,t)=>{let r=0,n=e.length-1,i=e[n],s=i.id.clock;if(s===t)return n;let o=a.floor(t/(s+i.length-1)*n);for(;r<=n;){if((s=(i=e[o]).id.clock)<=t){if(t<s+i.length)return o;r=o+1}else n=o-1;o=a.floor((r+n)/2)}throw p.unexpectedCase()},e4=(e,t)=>{let r=e.clients.get(t.client);return r[e5(r,t.clock)]},e9=(e,t,r)=>{let n=e5(t,r),i=t[n];return i.id.clock<r&&i instanceof r7?(t.splice(n+1,0,r5(e,i,r-i.id.clock)),n+1):n},e7=(e,t)=>{let r=e.doc.store.clients.get(t.client);return r[e9(e,r,t.clock)]},te=(e,t,r)=>{let n=t.clients.get(r.client),i=e5(n,r.clock),s=n[i];return r.clock!==s.id.clock+s.length-1&&s.constructor!==rL&&n.splice(i+1,0,r5(e,s,r.clock-s.id.clock+1)),s},tt=(e,t,r)=>{let n=e.clients.get(t.id.client);n[e5(n,t.id.clock)]=r},tr=(e,t,r,n,i)=>{let s;if(0===n)return;let o=r+n,a=e9(e,t,r);do o<(s=t[a++]).id.clock+s.length&&e9(e,t,o),i(s);while(a<t.length&&t[a].id.clock<o)};class tn{constructor(e,t,r){this.doc=e,this.deleteSet=new T,this.beforeState=e8(e.store),this.afterState=new Map,this.changed=new Map,this.changedParentTypes=new Map,this._mergeStructs=[],this.origin=t,this.meta=new Map,this.local=r,this.subdocsAdded=new Set,this.subdocsRemoved=new Set,this.subdocsLoaded=new Set,this._needFormattingCleanup=!1}}let ti=(e,t)=>!!(0!==t.deleteSet.clients.size||l.any(t.afterState,(e,r)=>t.beforeState.get(r)!==e))&&(D(t.deleteSet),ee(e,t),M(e,t.deleteSet),!0),ts=(e,t,r)=>{let n=t._item;(null===n||n.id.clock<(e.beforeState.get(n.id.client)||0)&&!n.deleted)&&l.setIfUndefined(e.changed,t,y.create).add(r)},to=(e,t)=>{let r=e[t],n=e[t-1],i=t;for(;i>0;r=n,n=e[--i-1]){if(n.deleted===r.deleted&&n.constructor===r.constructor&&n.mergeWith(r)){r instanceof r7&&null!==r.parentSub&&r.parent._map.get(r.parentSub)===r&&r.parent._map.set(r.parentSub,n);continue}break}let s=t-i;return s&&e.splice(t+1-s,s),s},ta=(e,t,r)=>{for(let[n,i]of e.clients.entries()){let e=t.clients.get(n);for(let n=i.length-1;n>=0;n--){let s=i[n],o=s.clock+s.len;for(let n=e5(e,s.clock),i=e[n];n<e.length&&i.id.clock<o;i=e[++n]){let i=e[n];if(s.clock+s.len<=i.id.clock)break;i instanceof r7&&i.deleted&&!i.keep&&r(i)&&i.gc(t,!1)}}}},tl=(e,t)=>{e.clients.forEach((e,r)=>{let n=t.clients.get(r);for(let t=e.length-1;t>=0;t--){let r=e[t],i=a.min(n.length-1,1+e5(n,r.clock+r.len-1));for(let e=i,t=n[e];e>0&&t.id.clock>=r.clock;t=n[e])e-=1+to(n,e)}})},tc=(e,t,r)=>{ta(e,t,r),tl(e,t)},th=(e,t)=>{if(t<e.length){let r=e[t],n=r.doc,i=n.store,s=r.deleteSet,o=r._mergeStructs;try{D(s),r.afterState=e8(r.doc.store),n.emit("beforeObserverCalls",[r,n]);let e=[];r.changed.forEach((t,n)=>e.push(()=>{null!==n._item&&n._item.deleted||n._callObserver(r,t)})),e.push(()=>{r.changedParentTypes.forEach((e,t)=>{t._dEH.l.length>0&&(null===t._item||!t._item.deleted)&&((e=e.filter(e=>null===e.target._item||!e.target._item.deleted)).forEach(e=>{e.currentTarget=t,e._path=null}),e.sort((e,t)=>e.path.length-t.path.length),ew(t._dEH,e,r))})}),e.push(()=>n.emit("afterTransaction",[r,n])),(0,m.callAll)(e,[]),r._needFormattingCleanup&&rT(r)}finally{n.gc&&ta(s,i,n.gcFilter),tl(s,i),r.afterState.forEach((e,t)=>{let n=r.beforeState.get(t)||0;if(n!==e){let e=i.clients.get(t),r=a.max(e5(e,n),1);for(let t=e.length-1;t>=r;)t-=1+to(e,t)}});for(let e=o.length-1;e>=0;e--){let{client:t,clock:r}=o[e].id,n=i.clients.get(t),s=e5(n,r);!(s+1<n.length&&to(n,s+1)>1)&&s>0&&to(n,s)}if(r.local||r.afterState.get(n.clientID)===r.beforeState.get(n.clientID)||(w.print(w.ORANGE,w.BOLD,"[yjs] ",w.UNBOLD,w.RED,"Changed the client-id because another client seems to be using it."),n.clientID=P()),n.emit("afterTransactionCleanup",[r,n]),n._observers.has("update")){let e=new G;ti(e,r)&&n.emit("update",[e.toUint8Array(),r.origin,n,r])}if(n._observers.has("updateV2")){let e=new W;ti(e,r)&&n.emit("updateV2",[e.toUint8Array(),r.origin,n,r])}let{subdocsAdded:l,subdocsLoaded:c,subdocsRemoved:h}=r;(l.size>0||h.size>0||c.size>0)&&(l.forEach(e=>{e.clientID=n.clientID,null==e.collectionid&&(e.collectionid=n.collectionid),n.subdocs.add(e)}),h.forEach(e=>n.subdocs.delete(e)),n.emit("subdocs",[{loaded:c,added:l,removed:h},n,r]),h.forEach(e=>e.destroy())),e.length<=t+1?(n._transactionCleanups=[],n.emit("afterAllTransactions",[n,e])):th(e,t+1)}}},td=(e,t,r=null,n=!0)=>{let i=e._transactionCleanups,s=!1,o=null;null===e._transaction&&(s=!0,e._transaction=new tn(e,r,n),i.push(e._transaction),1===i.length&&e.emit("beforeAllTransactions",[e]),e.emit("beforeTransaction",[e._transaction,e]));try{o=t(e._transaction)}finally{if(s){let t=e._transaction===i[0];e._transaction=null,t&&th(i,0)}}return o};class tu{constructor(e,t){this.insertions=t,this.deletions=e,this.meta=new Map}}let tf=(e,t,r)=>{C(e,r.deletions,r=>{r instanceof r7&&t.scope.some(t=>t===e.doc||ek(t,r))&&r3(r,!1)})},tp=(e,t,r)=>{let n=null,i=e.doc,s=e.scope;td(i,r=>{for(;t.length>0&&null===e.currStackItem;){let n=i.store,o=t.pop(),a=new Set,l=[],c=!1;C(r,o.insertions,e=>{if(e instanceof r7){if(null!==e.redone){let{item:t,diff:i}=r6(n,e.id);i>0&&(t=e7(r,eE(t.id.client,t.id.clock+i))),e=t}!e.deleted&&s.some(t=>t===r.doc||ek(t,e))&&l.push(e)}}),C(r,o.deletions,e=>{e instanceof r7&&s.some(t=>t===r.doc||ek(t,e))&&!_(o.insertions,e.id)&&a.add(e)}),a.forEach(t=>{c=null!==r9(r,t,a,o.insertions,e.ignoreRemoteMapChanges,e)||c});for(let t=l.length-1;t>=0;t--){let n=l[t];e.deleteFilter(n)&&(n.delete(r),c=!0)}e.currStackItem=c?o:null}r.changed.forEach((e,t)=>{e.has(null)&&t._searchMarker&&(t._searchMarker.length=0)}),n=r},e);let o=e.currStackItem;if(null!=o){let t=n.changedParentTypes;e.emit("stack-item-popped",[{stackItem:o,type:r,changedParentTypes:t,origin:e},e]),e.currStackItem=null}return o};class tg extends s.ObservableV2{constructor(e,{captureTimeout:t=500,captureTransaction:r=e=>!0,deleteFilter:n=()=>!0,trackedOrigins:i=new Set([null]),ignoreRemoteMapChanges:s=!1,doc:a=o.isArray(e)?e[0].doc:e instanceof F?e:e.doc}={}){super(),this.scope=[],this.doc=a,this.addToScope(e),this.deleteFilter=n,i.add(this),this.trackedOrigins=i,this.captureTransaction=r,this.undoStack=[],this.redoStack=[],this.undoing=!1,this.redoing=!1,this.currStackItem=null,this.lastChange=0,this.ignoreRemoteMapChanges=s,this.captureTimeout=t,this.afterTransactionHandler=e=>{if(!this.captureTransaction(e)||!this.scope.some(t=>e.changedParentTypes.has(t)||t===this.doc)||!this.trackedOrigins.has(e.origin)&&(!e.origin||!this.trackedOrigins.has(e.origin.constructor)))return;let t=this.undoing,r=this.redoing,n=t?this.redoStack:this.undoStack;t?this.stopCapturing():r||this.clear(!1,!0);let i=new T;e.afterState.forEach((t,r)=>{let n=e.beforeState.get(r)||0,s=t-n;s>0&&B(i,r,n,s)});let s=x.getUnixTime(),o=!1;if(this.lastChange>0&&s-this.lastChange<this.captureTimeout&&n.length>0&&!t&&!r){let t=n[n.length-1];t.deletions=j([t.deletions,e.deleteSet]),t.insertions=j([t.insertions,i])}else n.push(new tu(e.deleteSet,i)),o=!0;t||r||(this.lastChange=s),C(e,e.deleteSet,t=>{t instanceof r7&&this.scope.some(r=>r===e.doc||ek(r,t))&&r3(t,!0)});let a=[{stackItem:n[n.length-1],origin:e.origin,type:t?"redo":"undo",changedParentTypes:e.changedParentTypes},this];o?this.emit("stack-item-added",a):this.emit("stack-item-updated",a)},this.doc.on("afterTransaction",this.afterTransactionHandler),this.doc.on("destroy",()=>{this.destroy()})}addToScope(e){let t=new Set(this.scope);(e=o.isArray(e)?e:[e]).forEach(e=>{t.has(e)||(t.add(e),(e instanceof tZ?e.doc!==this.doc:e!==this.doc)&&w.warn("[yjs#509] Not same Y.Doc"),this.scope.push(e))})}addTrackedOrigin(e){this.trackedOrigins.add(e)}removeTrackedOrigin(e){this.trackedOrigins.delete(e)}clear(e=!0,t=!0){(e&&this.canUndo()||t&&this.canRedo())&&this.doc.transact(r=>{e&&(this.undoStack.forEach(e=>tf(r,this,e)),this.undoStack=[]),t&&(this.redoStack.forEach(e=>tf(r,this,e)),this.redoStack=[]),this.emit("stack-cleared",[{undoStackCleared:e,redoStackCleared:t}])})}stopCapturing(){this.lastChange=0}undo(){let e;this.undoing=!0;try{e=tp(this,this.undoStack,"undo")}finally{this.undoing=!1}return e}redo(){let e;this.redoing=!0;try{e=tp(this,this.redoStack,"redo")}finally{this.redoing=!1}return e}canUndo(){return this.undoStack.length>0}canRedo(){return this.redoStack.length>0}destroy(){this.trackedOrigins.delete(this),this.doc.off("afterTransaction",this.afterTransactionHandler),super.destroy()}}class tm{constructor(e,t){this.gen=function*(e){let t=h.readVarUint(e.restDecoder);for(let r=0;r<t;r++){let t=h.readVarUint(e.restDecoder),r=e.readClient(),n=h.readVarUint(e.restDecoder);for(let i=0;i<t;i++){let t=e.readInfo();if(10===t){let t=h.readVarUint(e.restDecoder);yield new nr(eE(r,n),t),n+=t}else if((g.BITS5&t)!=0){let i=(t&(g.BIT7|g.BIT8))==0,s=new r7(eE(r,n),null,(t&g.BIT8)===g.BIT8?e.readLeftID():null,null,(t&g.BIT7)===g.BIT7?e.readRightID():null,i?e.readParentInfo()?e.readString():e.readLeftID():null,i&&(t&g.BIT6)===g.BIT6?e.readString():null,ne(e,t));yield s,n+=s.length}else{let t=e.readLen();yield new rL(eE(r,n),t),n+=t}}}}(e),this.curr=null,this.done=!1,this.filterSkips=t,this.next()}next(){do this.curr=this.gen.next().value||null;while(this.filterSkips&&null!==this.curr&&this.curr.constructor===nr)return this.curr}}let ty=e=>tw(e,$),tw=(e,t=H)=>{let r=[],n=new t(h.createDecoder(e)),i=new tm(n,!1);for(let e=i.curr;null!==e;e=i.next())r.push(e);w.print("Structs: ",r);let s=N(n);w.print("DeleteSet: ",s)},tx=e=>tb(e,$),tb=(e,t=H)=>{let r=[],n=new t(h.createDecoder(e)),i=new tm(n,!1);for(let e=i.curr;null!==e;e=i.next())r.push(e);return{structs:r,ds:N(n)}};class tE{constructor(e){this.currClient=0,this.startClock=0,this.written=0,this.encoder=e,this.clientStructs=[]}}let tI=e=>tC(e,$,G),tS=(e,t=Y,r=H)=>{let n=new t,i=new tm(new r(h.createDecoder(e)),!1),s=i.curr;if(null===s)return c.writeVarUint(n.restEncoder,0),n.toUint8Array();{let e=0,t=s.id.client,r=0!==s.id.clock,o=r?0:s.id.clock+s.length;for(;null!==s;s=i.next())t!==s.id.client&&(0!==o&&(e++,c.writeVarUint(n.restEncoder,t),c.writeVarUint(n.restEncoder,o)),t=s.id.client,o=0,r=0!==s.id.clock),s.constructor===nr&&(r=!0),r||(o=s.id.clock+s.length);0!==o&&(e++,c.writeVarUint(n.restEncoder,t),c.writeVarUint(n.restEncoder,o));let a=c.createEncoder();return c.writeVarUint(a,e),c.writeBinaryEncoder(a,n.restEncoder),n.restEncoder=a,n.toUint8Array()}},tv=e=>tS(e,J,$),tk=(e,t=H)=>{let r=new Map,n=new Map,i=new tm(new t(h.createDecoder(e)),!1),s=i.curr;if(null!==s){let e=s.id.client,t=s.id.clock;for(r.set(e,t);null!==s;s=i.next())e!==s.id.client&&(n.set(e,t),r.set(s.id.client,s.id.clock),e=s.id.client),t=s.id.clock+s.length;n.set(e,t)}return{from:r,to:n}},tU=e=>tk(e,$),tT=(e,t)=>{if(e.constructor===rL){let{client:r,clock:n}=e.id;return new rL(eE(r,n+t),e.length-t)}if(e.constructor===nr){let{client:r,clock:n}=e.id;return new nr(eE(r,n+t),e.length-t)}{let{client:r,clock:n}=e.id;return new r7(eE(r,n+t),null,eE(r,n+t-1),null,e.rightOrigin,e.parent,e.parentSub,e.content.splice(t))}},tC=(e,t=H,r=W)=>{if(1===e.length)return e[0];let n=e.map(e=>new t(h.createDecoder(e))),i=n.map(e=>new tm(e,!0)),s=null,o=new r,a=new tE(o);for(;(i=i.filter(e=>null!==e.curr)).sort((e,t)=>{if(e.curr.id.client!==t.curr.id.client)return t.curr.id.client-e.curr.id.client;{let r=e.curr.id.clock-t.curr.id.clock;return 0===r?e.curr.constructor===t.curr.constructor?0:e.curr.constructor===nr?1:-1:r}}),0!==i.length;){let e=i[0],t=e.curr.id.client;if(null!==s){let r=e.curr,n=!1;for(;null!==r&&r.id.clock+r.length<=s.struct.id.clock+s.struct.length&&r.id.client>=s.struct.id.client;)r=e.next(),n=!0;if(null===r||r.id.client!==t||n&&r.id.clock>s.struct.id.clock+s.struct.length)continue;if(t!==s.struct.id.client)tj(a,s.struct,s.offset),s={struct:r,offset:0},e.next();else if(s.struct.id.clock+s.struct.length<r.id.clock){if(s.struct.constructor===nr)s.struct.length=r.id.clock+r.length-s.struct.id.clock;else{tj(a,s.struct,s.offset);let e=r.id.clock-s.struct.id.clock-s.struct.length;s={struct:new nr(eE(t,s.struct.id.clock+s.struct.length),e),offset:0}}}else{let t=s.struct.id.clock+s.struct.length-r.id.clock;t>0&&(s.struct.constructor===nr?s.struct.length-=t:r=tT(r,t)),s.struct.mergeWith(r)||(tj(a,s.struct,s.offset),s={struct:r,offset:0},e.next())}}else s={struct:e.curr,offset:0},e.next();for(let r=e.curr;null!==r&&r.id.client===t&&r.id.clock===s.struct.id.clock+s.struct.length&&r.constructor!==nr;r=e.next())tj(a,s.struct,s.offset),s={struct:r,offset:0}}return null!==s&&(tj(a,s.struct,s.offset),s=null),tB(a),M(o,j(n.map(e=>N(e)))),o.toUint8Array()},tA=(e,t,r=H,n=W)=>{let i=ec(t),s=new n,o=new tE(s),l=new r(h.createDecoder(e)),c=new tm(l,!1);for(;c.curr;){let e=c.curr,t=e.id.client,r=i.get(t)||0;if(c.curr.constructor===nr){c.next();continue}if(e.id.clock+e.length>r)for(tj(o,e,a.max(r-e.id.clock,0)),c.next();c.curr&&c.curr.id.client===t;)tj(o,c.curr,0),c.next();else for(;c.curr&&c.curr.id.client===t&&c.curr.id.clock+c.curr.length<=r;)c.next()}return tB(o),M(s,N(l)),s.toUint8Array()},t_=(e,t)=>tA(e,t,$,G),tD=e=>{e.written>0&&(e.clientStructs.push({written:e.written,restEncoder:c.toUint8Array(e.encoder.restEncoder)}),e.encoder.restEncoder=c.createEncoder(),e.written=0)},tj=(e,t,r)=>{e.written>0&&e.currClient!==t.id.client&&tD(e),0===e.written&&(e.currClient=t.id.client,e.encoder.writeClient(t.id.client),c.writeVarUint(e.encoder.restEncoder,t.id.clock+r)),t.write(e.encoder,r),e.written++},tB=e=>{tD(e);let t=e.encoder.restEncoder;c.writeVarUint(t,e.clientStructs.length);for(let r=0;r<e.clientStructs.length;r++){let n=e.clientStructs[r];c.writeVarUint(t,n.written),c.writeUint8Array(t,n.restEncoder)}},tO=(e,t,r,n)=>{let i=new r(h.createDecoder(e)),s=new tm(i,!1),o=new n,a=new tE(o);for(let e=s.curr;null!==e;e=s.next())tj(a,t(e),0);return tB(a),M(o,N(i)),o.toUint8Array()},tR=({formatting:e=!0,subdocs:t=!0,yxml:r=!0}={})=>{let n=0,i=l.create(),s=l.create(),o=l.create(),a=l.create();return a.set(null,null),c=>{switch(c.constructor){case rL:case nr:return c;case r7:{let h=c.content;switch(h.constructor){case rP:break;case r8:if(r){let e=h.type;e instanceof rB&&(e.nodeName=l.setIfUndefined(s,e.nodeName,()=>"node-"+n)),e instanceof rR&&(e.hookName=l.setIfUndefined(s,e.hookName,()=>"hook-"+n))}break;case rG:h.arr=h.arr.map(()=>n);break;case rV:h.content=new Uint8Array([n]);break;case rq:t&&(h.opts={},h.doc.guid=n+"");break;case r$:h.embed={};break;case rz:e&&(h.key=l.setIfUndefined(o,h.key,()=>n+""),h.value=l.setIfUndefined(a,h.value,()=>({i:n})));break;case rH:h.arr=h.arr.map(()=>n);break;case rY:h.str=b.repeat(n%10+"",h.str.length);break;default:p.unexpectedCase()}return c.parentSub&&(c.parentSub=l.setIfUndefined(i,c.parentSub,()=>n+"")),n++,c}default:p.unexpectedCase()}}},tM=(e,t)=>tO(e,tR(t),$,G),tN=(e,t)=>tO(e,tR(t),H,W),tL=e=>tO(e,m.id,$,W),tV=e=>tO(e,m.id,H,G),tP="You must not compute changes after the event-handler fired.";class tF{constructor(e,t){this.target=e,this.currentTarget=e,this.transaction=t,this._changes=null,this._keys=null,this._delta=null,this._path=null}get path(){return this._path||(this._path=tq(this.currentTarget,this.target))}deletes(e){return _(this.transaction.deleteSet,e.id)}get keys(){if(null===this._keys){if(0===this.transaction.doc._transactionCleanups.length)throw p.create(tP);let e=new Map,t=this.target;this.transaction.changed.get(t).forEach(r=>{if(null!==r){let n,i,s=t._map.get(r);if(this.adds(s)){let e=s.left;for(;null!==e&&this.adds(e);)e=e.left;if(this.deletes(s)){if(!(null!==e&&this.deletes(e)))return;n="delete",i=o.last(e.content.getContent())}else null!==e&&this.deletes(e)?(n="update",i=o.last(e.content.getContent())):(n="add",i=void 0)}else{if(!this.deletes(s))return;n="delete",i=o.last(s.content.getContent())}e.set(r,{action:n,oldValue:i})}}),this._keys=e}return this._keys}get delta(){return this.changes.delta}adds(e){return e.id.clock>=(this.transaction.beforeState.get(e.id.client)||0)}get changes(){let e=this._changes;if(null===e){if(0===this.transaction.doc._transactionCleanups.length)throw p.create(tP);let t=this.target,r=y.create(),n=y.create(),i=[];if(e={added:r,deleted:n,delta:i,keys:this.keys},this.transaction.changed.get(t).has(null)){let e=null,s=()=>{e&&i.push(e)};for(let i=t._start;null!==i;i=i.right)i.deleted?this.deletes(i)&&!this.adds(i)&&((null===e||void 0===e.delete)&&(s(),e={delete:0}),e.delete+=i.length,n.add(i)):this.adds(i)?((null===e||void 0===e.insert)&&(s(),e={insert:[]}),e.insert=e.insert.concat(i.content.getContent()),r.add(i)):((null===e||void 0===e.retain)&&(s(),e={retain:0}),e.retain+=i.length);null!==e&&void 0===e.retain&&s()}this._changes=e}return e}}let tq=(e,t)=>{let r=[];for(;null!==t._item&&t!==e;){if(null!==t._item.parentSub)r.unshift(t._item.parentSub);else{let e=0,n=t._item.parent._start;for(;n!==t._item&&null!==n;)!n.deleted&&n.countable&&(e+=n.length),n=n.right;r.unshift(e)}t=t._item.parent}return r},t$=()=>{w.warn("Invalid access: Add Yjs type to a document before reading data.")},tz=0;class tH{constructor(e,t){e.marker=!0,this.p=e,this.index=t,this.timestamp=tz++}}let tJ=e=>{e.timestamp=tz++},tG=(e,t,r)=>{e.p.marker=!1,e.p=t,t.marker=!0,e.index=r,e.timestamp=tz++},tY=(e,t,r)=>{if(e.length>=80){let n=e.reduce((e,t)=>e.timestamp<t.timestamp?e:t);return tG(n,t,r),n}{let n=new tH(t,r);return e.push(n),n}},tW=(e,t)=>{if(null===e._start||0===t||null===e._searchMarker)return null;let r=0===e._searchMarker.length?null:e._searchMarker.reduce((e,r)=>a.abs(t-e.index)<a.abs(t-r.index)?e:r),n=e._start,i=0;for(null!==r&&(n=r.p,i=r.index,tJ(r));null!==n.right&&i<t;){if(!n.deleted&&n.countable){if(t<i+n.length)break;i+=n.length}n=n.right}for(;null!==n.left&&i>t;)!(n=n.left).deleted&&n.countable&&(i-=n.length);for(;null!==n.left&&n.left.id.client===n.id.client&&n.left.id.clock+n.left.length===n.id.clock;)!(n=n.left).deleted&&n.countable&&(i-=n.length);return null!==r&&a.abs(r.index-i)<n.parent.length/80?(tG(r,n,i),r):tY(e._searchMarker,n,i)},tX=(e,t,r)=>{for(let n=e.length-1;n>=0;n--){let i=e[n];if(r>0){let t=i.p;for(t.marker=!1;t&&(t.deleted||!t.countable);)(t=t.left)&&!t.deleted&&t.countable&&(i.index-=t.length);if(null===t||!0===t.marker){e.splice(n,1);continue}i.p=t,t.marker=!0}(t<i.index||r>0&&t===i.index)&&(i.index=a.max(t,i.index+r))}},tK=e=>{e.doc??t$();let t=e._start,r=[];for(;t;)r.push(t),t=t.right;return r},tQ=(e,t,r)=>{let n=e,i=t.changedParentTypes;for(;l.setIfUndefined(i,e,()=>[]).push(r),null!==e._item;)e=e._item.parent;ew(n._eH,r,t)};class tZ{constructor(){this._item=null,this._map=new Map,this._start=null,this.doc=null,this._length=0,this._eH=eg(),this._dEH=eg(),this._searchMarker=null}get parent(){return this._item?this._item.parent:null}_integrate(e,t){this.doc=e,this._item=t}_copy(){throw p.methodUnimplemented()}clone(){throw p.methodUnimplemented()}_write(e){}get _first(){let e=this._start;for(;null!==e&&e.deleted;)e=e.right;return e}_callObserver(e,t){!e.local&&this._searchMarker&&(this._searchMarker.length=0)}observe(e){em(this._eH,e)}observeDeep(e){em(this._dEH,e)}unobserve(e){ey(this._eH,e)}unobserveDeep(e){ey(this._dEH,e)}toJSON(){}}let t0=(e,t,r)=>{e.doc??t$(),t<0&&(t=e._length+t),r<0&&(r=e._length+r);let n=r-t,i=[],s=e._start;for(;null!==s&&n>0;){if(s.countable&&!s.deleted){let e=s.content.getContent();if(e.length<=t)t-=e.length;else{for(let r=t;r<e.length&&n>0;r++)i.push(e[r]),n--;t=0}}s=s.right}return i},t1=e=>{e.doc??t$();let t=[],r=e._start;for(;null!==r;){if(r.countable&&!r.deleted){let e=r.content.getContent();for(let r=0;r<e.length;r++)t.push(e[r])}r=r.right}return t},t2=(e,t)=>{let r=[],n=e._start;for(;null!==n;){if(n.countable&&eK(n,t)){let e=n.content.getContent();for(let t=0;t<e.length;t++)r.push(e[t])}n=n.right}return r},t8=(e,t)=>{let r=0,n=e._start;for(e.doc??t$();null!==n;){if(n.countable&&!n.deleted){let i=n.content.getContent();for(let n=0;n<i.length;n++)t(i[n],r++,e)}n=n.right}},t6=(e,t)=>{let r=[];return t8(e,(n,i)=>{r.push(t(n,i,e))}),r},t3=e=>{let t=e._start,r=null,n=0;return{[Symbol.iterator](){return this},next:()=>{if(null===r){for(;null!==t&&t.deleted;)t=t.right;if(null===t)return{done:!0,value:void 0};r=t.content.getContent(),n=0,t=t.right}let e=r[n++];return r.length<=n&&(r=null),{done:!1,value:e}}}},t5=(e,t)=>{e.doc??t$();let r=tW(e,t),n=e._start;for(null!==r&&(n=r.p,t-=r.index);null!==n;n=n.right)if(!n.deleted&&n.countable){if(t<n.length)return n.content.getContent()[t];t-=n.length}},t4=(e,t,r,n)=>{let i=r,s=e.doc,o=s.clientID,a=s.store,l=null===r?t._start:r.right,c=[],h=()=>{c.length>0&&((i=new r7(eE(o,e6(a,o)),i,i&&i.lastId,l,l&&l.id,t,null,new rG(c))).integrate(e,0),c=[])};n.forEach(r=>{if(null===r)c.push(r);else switch(r.constructor){case Number:case Object:case Boolean:case Array:case String:c.push(r);break;default:switch(h(),r.constructor){case Uint8Array:case ArrayBuffer:(i=new r7(eE(o,e6(a,o)),i,i&&i.lastId,l,l&&l.id,t,null,new rV(new Uint8Array(r)))).integrate(e,0);break;case F:(i=new r7(eE(o,e6(a,o)),i,i&&i.lastId,l,l&&l.id,t,null,new rq(r))).integrate(e,0);break;default:if(r instanceof tZ)(i=new r7(eE(o,e6(a,o)),i,i&&i.lastId,l,l&&l.id,t,null,new r8(r))).integrate(e,0);else throw Error("Unexpected content type in insert operation")}}}),h()},t9=()=>p.create("Length exceeded!"),t7=(e,t,r,n)=>{if(r>t._length)throw t9();if(0===r)return t._searchMarker&&tX(t._searchMarker,r,n.length),t4(e,t,null,n);let i=r,s=tW(t,r),o=t._start;for(null!==s&&(o=s.p,0==(r-=s.index)&&(r+=(o=o.prev)&&o.countable&&!o.deleted?o.length:0));null!==o;o=o.right)if(!o.deleted&&o.countable){if(r<=o.length){r<o.length&&e7(e,eE(o.id.client,o.id.clock+r));break}r-=o.length}return t._searchMarker&&tX(t._searchMarker,i,n.length),t4(e,t,o,n)},re=(e,t,r)=>{let n=(t._searchMarker||[]).reduce((e,t)=>t.index>e.index?t:e,{index:0,p:t._start}).p;if(n)for(;n.right;)n=n.right;return t4(e,t,n,r)},rt=(e,t,r,n)=>{if(0===n)return;let i=r,s=n,o=tW(t,r),a=t._start;for(null!==o&&(a=o.p,r-=o.index);null!==a&&r>0;a=a.right)!a.deleted&&a.countable&&(r<a.length&&e7(e,eE(a.id.client,a.id.clock+r)),r-=a.length);for(;n>0&&null!==a;)a.deleted||(n<a.length&&e7(e,eE(a.id.client,a.id.clock+n)),a.delete(e),n-=a.length),a=a.right;if(n>0)throw t9();t._searchMarker&&tX(t._searchMarker,i,-s+n)},rr=(e,t,r)=>{let n=t._map.get(r);void 0!==n&&n.delete(e)},rn=(e,t,r,n)=>{let i,s=t._map.get(r)||null,o=e.doc,a=o.clientID;if(null==n)i=new rG([n]);else switch(n.constructor){case Number:case Object:case Boolean:case Array:case String:i=new rG([n]);break;case Uint8Array:i=new rV(n);break;case F:i=new rq(n);break;default:if(n instanceof tZ)i=new r8(n);else throw Error("Unexpected content type")}new r7(eE(a,e6(o.store,a)),s,s&&s.lastId,null,null,t,r,i).integrate(e,0)},ri=(e,t)=>{e.doc??t$();let r=e._map.get(t);return void 0===r||r.deleted?void 0:r.content.getContent()[r.length-1]},rs=e=>{let t={};return e.doc??t$(),e._map.forEach((e,r)=>{e.deleted||(t[r]=e.content.getContent()[e.length-1])}),t},ro=(e,t)=>{e.doc??t$();let r=e._map.get(t);return void 0!==r&&!r.deleted},ra=(e,t,r)=>{let n=e._map.get(t)||null;for(;null!==n&&(!r.sv.has(n.id.client)||n.id.clock>=(r.sv.get(n.id.client)||0));)n=n.left;return null!==n&&eK(n,r)?n.content.getContent()[n.length-1]:void 0},rl=(e,t)=>{let r={};return e._map.forEach((e,n)=>{let i=e;for(;null!==i&&(!t.sv.has(i.id.client)||i.id.clock>=(t.sv.get(i.id.client)||0));)i=i.left;null!==i&&eK(i,t)&&(r[n]=i.content.getContent()[i.length-1])}),r},rc=e=>(e.doc??t$(),E.iteratorFilter(e._map.entries(),e=>!e[1].deleted));class rh extends tF{}class rd extends tZ{constructor(){super(),this._prelimContent=[],this._searchMarker=[]}static from(e){let t=new rd;return t.push(e),t}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new rd}clone(){let e=new rd;return e.insert(0,this.toArray().map(e=>e instanceof tZ?e.clone():e)),e}get length(){return this.doc??t$(),this._length}_callObserver(e,t){super._callObserver(e,t),tQ(this,e,new rh(this,e))}insert(e,t){null!==this.doc?td(this.doc,r=>{t7(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}push(e){null!==this.doc?td(this.doc,t=>{re(t,this,e)}):this._prelimContent.push(...e)}unshift(e){this.insert(0,e)}delete(e,t=1){null!==this.doc?td(this.doc,r=>{rt(r,this,e,t)}):this._prelimContent.splice(e,t)}get(e){return t5(this,e)}toArray(){return t1(this)}slice(e=0,t=this.length){return t0(this,e,t)}toJSON(){return this.map(e=>e instanceof tZ?e.toJSON():e)}map(e){return t6(this,e)}forEach(e){t8(this,e)}[Symbol.iterator](){return t3(this)}_write(e){e.writeTypeRef(rX)}}class ru extends tF{constructor(e,t,r){super(e,t),this.keysChanged=r}}class rf extends tZ{constructor(e){super(),this._prelimContent=null,void 0===e?this._prelimContent=new Map:this._prelimContent=new Map(e)}_integrate(e,t){super._integrate(e,t),this._prelimContent.forEach((e,t)=>{this.set(t,e)}),this._prelimContent=null}_copy(){return new rf}clone(){let e=new rf;return this.forEach((t,r)=>{e.set(r,t instanceof tZ?t.clone():t)}),e}_callObserver(e,t){tQ(this,e,new ru(this,e,t))}toJSON(){this.doc??t$();let e={};return this._map.forEach((t,r)=>{if(!t.deleted){let n=t.content.getContent()[t.length-1];e[r]=n instanceof tZ?n.toJSON():n}}),e}get size(){return[...rc(this)].length}keys(){return E.iteratorMap(rc(this),e=>e[0])}values(){return E.iteratorMap(rc(this),e=>e[1].content.getContent()[e[1].length-1])}entries(){return E.iteratorMap(rc(this),e=>[e[0],e[1].content.getContent()[e[1].length-1]])}forEach(e){this.doc??t$(),this._map.forEach((t,r)=>{t.deleted||e(t.content.getContent()[t.length-1],r,this)})}[Symbol.iterator](){return this.entries()}delete(e){null!==this.doc?td(this.doc,t=>{rr(t,this,e)}):this._prelimContent.delete(e)}set(e,t){return null!==this.doc?td(this.doc,r=>{rn(r,this,e,t)}):this._prelimContent.set(e,t),t}get(e){return ri(this,e)}has(e){return ro(this,e)}clear(){null!==this.doc?td(this.doc,e=>{this.forEach(function(t,r,n){rr(e,n,r)})}):this._prelimContent.clear()}_write(e){e.writeTypeRef(rK)}}let rp=(e,t)=>e===t||"object"==typeof e&&"object"==typeof t&&e&&t&&I.equalFlat(e,t);class rg{constructor(e,t,r,n){this.left=e,this.right=t,this.index=r,this.currentAttributes=n}forward(){(null===this.right&&p.unexpectedCase(),this.right.content.constructor===rz)?this.right.deleted||rx(this.currentAttributes,this.right.content):this.right.deleted||(this.index+=this.right.length),this.left=this.right,this.right=this.right.right}}let rm=(e,t,r)=>{for(;null!==t.right&&r>0;)t.right.content.constructor===rz?t.right.deleted||rx(t.currentAttributes,t.right.content):t.right.deleted||(r<t.right.length&&e7(e,eE(t.right.id.client,t.right.id.clock+r)),t.index+=t.right.length,r-=t.right.length),t.left=t.right,t.right=t.right.right;return t},ry=(e,t,r,n)=>{let i=new Map,s=n?tW(t,r):null;return s?rm(e,new rg(s.p.left,s.p,s.index,i),r-s.index):rm(e,new rg(null,t._start,0,i),r)},rw=(e,t,r,n)=>{for(;null!==r.right&&(!0===r.right.deleted||r.right.content.constructor===rz&&rp(n.get(r.right.content.key),r.right.content.value));)r.right.deleted||n.delete(r.right.content.key),r.forward();let i=e.doc,s=i.clientID;n.forEach((n,o)=>{let a=r.left,l=r.right,c=new r7(eE(s,e6(i.store,s)),a,a&&a.lastId,l,l&&l.id,t,null,new rz(o,n));c.integrate(e,0),r.right=c,r.forward()})},rx=(e,t)=>{let{key:r,value:n}=t;null===n?e.delete(r):e.set(r,n)},rb=(e,t)=>{for(;null!==e.right&&(e.right.deleted||e.right.content.constructor===rz&&rp(t[e.right.content.key]??null,e.right.content.value));){;e.forward()}},rE=(e,t,r,n)=>{let i=e.doc,s=i.clientID,o=new Map;for(let a in n){let l=n[a],c=r.currentAttributes.get(a)??null;if(!rp(c,l)){o.set(a,c);let{left:n,right:h}=r;r.right=new r7(eE(s,e6(i.store,s)),n,n&&n.lastId,h,h&&h.id,t,null,new rz(a,l)),r.right.integrate(e,0),r.forward()}}return o},rI=(e,t,r,n,i)=>{r.currentAttributes.forEach((e,t)=>{void 0===i[t]&&(i[t]=null)});let s=e.doc,o=s.clientID;rb(r,i);let a=rE(e,t,r,i),l=n.constructor===String?new rY(n):n instanceof tZ?new r8(n):new r$(n),{left:c,right:h,index:d}=r;t._searchMarker&&tX(t._searchMarker,r.index,l.getLength()),(h=new r7(eE(o,e6(s.store,o)),c,c&&c.lastId,h,h&&h.id,t,null,l)).integrate(e,0),r.right=h,r.index=d,r.forward(),rw(e,t,r,a)},rS=(e,t,r,n,i)=>{let s=e.doc,o=s.clientID;rb(r,i);let a=rE(e,t,r,i);for(;null!==r.right&&(n>0||a.size>0&&(r.right.deleted||r.right.content.constructor===rz));){if(!r.right.deleted){if(r.right.content.constructor===rz){let{key:t,value:s}=r.right.content,o=i[t];if(void 0!==o){if(rp(o,s))a.delete(t);else{if(0===n)break;a.set(t,s)}r.right.delete(e)}else r.currentAttributes.set(t,s)}else n<r.right.length&&e7(e,eE(r.right.id.client,r.right.id.clock+n)),n-=r.right.length}r.forward()}if(n>0){let i="";for(;n>0;n--)i+="\n";r.right=new r7(eE(o,e6(s.store,o)),r.left,r.left&&r.left.lastId,r.right,r.right&&r.right.id,t,null,new rY(i)),r.right.integrate(e,0),r.forward()}rw(e,t,r,a)},rv=(e,t,r,n,i)=>{let s=t,o=l.create();for(;s&&(!s.countable||s.deleted);){if(!s.deleted&&s.content.constructor===rz){let e=s.content;o.set(e.key,e)}s=s.right}let a=0,c=!1;for(;t!==s;){if(r===t&&(c=!0),!t.deleted){let r=t.content;if(r.constructor===rz){let{key:s,value:l}=r,h=n.get(s)??null;o.get(s)===r&&h!==l||(t.delete(e),a++,c||(i.get(s)??null)!==l||h===l||(null===h?i.delete(s):i.set(s,h))),c||t.deleted||rx(i,r)}}t=t.right}return a},rk=(e,t)=>{for(;t&&t.right&&(t.right.deleted||!t.right.countable);)t=t.right;let r=new Set;for(;t&&(t.deleted||!t.countable);){if(!t.deleted&&t.content.constructor===rz){let n=t.content.key;r.has(n)?t.delete(e):r.add(n)}t=t.left}},rU=e=>{let t=0;return td(e.doc,r=>{let n=e._start,i=e._start,s=l.create(),o=l.copy(s);for(;i;)!1===i.deleted&&(i.content.constructor===rz?rx(o,i.content):(t+=rv(r,n,i,s,o),s=l.copy(o),n=i)),i=i.right}),t},rT=e=>{let t=new Set,r=e.doc;for(let[n,i]of e.afterState.entries()){let s=e.beforeState.get(n)||0;i!==s&&tr(e,r.store.clients.get(n),s,i,e=>{e.deleted||e.content.constructor!==rz||e.constructor===rL||t.add(e.parent)})}td(r,r=>{for(let n of(C(e,e.deleteSet,e=>{if(e instanceof rL||!e.parent._hasFormatting||t.has(e.parent))return;let n=e.parent;e.content.constructor===rz?t.add(n):rk(r,e)}),t))rU(n)})},rC=(e,t,r)=>{let n=r,i=l.copy(t.currentAttributes),s=t.right;for(;r>0&&null!==t.right;){if(!1===t.right.deleted)switch(t.right.content.constructor){case r8:case r$:case rY:r<t.right.length&&e7(e,eE(t.right.id.client,t.right.id.clock+r)),r-=t.right.length,t.right.delete(e)}t.forward()}s&&rv(e,s,t.right,i,t.currentAttributes);let o=(t.left||t.right).parent;return o._searchMarker&&tX(o._searchMarker,t.index,-n+r),t};class rA extends tF{constructor(e,t,r){super(e,t),this.childListChanged=!1,this.keysChanged=new Set,r.forEach(e=>{null===e?this.childListChanged=!0:this.keysChanged.add(e)})}get changes(){if(null===this._changes){let e={keys:this.keys,delta:this.delta,added:new Set,deleted:new Set};this._changes=e}return this._changes}get delta(){if(null===this._delta){let e=this.target.doc,t=[];td(e,e=>{let r=new Map,n=new Map,i=this.target._start,s=null,o={},a="",l=0,c=0,h=()=>{if(null!==s){let e=null;switch(s){case"delete":c>0&&(e={delete:c}),c=0;break;case"insert":("object"==typeof a||a.length>0)&&(e={insert:a},r.size>0&&(e.attributes={},r.forEach((t,r)=>{null!==t&&(e.attributes[r]=t)}))),a="";break;case"retain":l>0&&(e={retain:l},I.isEmpty(o)||(e.attributes=I.assign({},o))),l=0}e&&t.push(e),s=null}};for(;null!==i;){switch(i.content.constructor){case r8:case r$:this.adds(i)?this.deletes(i)||(h(),s="insert",a=i.content.getContent()[0],h()):this.deletes(i)?("delete"!==s&&(h(),s="delete"),c+=1):i.deleted||("retain"!==s&&(h(),s="retain"),l+=1);break;case rY:this.adds(i)?this.deletes(i)||("insert"!==s&&(h(),s="insert"),a+=i.content.str):this.deletes(i)?("delete"!==s&&(h(),s="delete"),c+=i.length):i.deleted||("retain"!==s&&(h(),s="retain"),l+=i.length);break;case rz:{let{key:t,value:a}=i.content;if(this.adds(i))this.deletes(i)||(rp(r.get(t)??null,a)?null!==a&&i.delete(e):("retain"===s&&h(),rp(a,n.get(t)??null)?delete o[t]:o[t]=a));else if(this.deletes(i)){n.set(t,a);let e=r.get(t)??null;rp(e,a)||("retain"===s&&h(),o[t]=e)}else if(!i.deleted){n.set(t,a);let r=o[t];void 0!==r&&(rp(r,a)?null!==r&&i.delete(e):("retain"===s&&h(),null===a?delete o[t]:o[t]=a))}i.deleted||("insert"===s&&h(),rx(r,i.content))}}i=i.right}for(h();t.length>0;){let e=t[t.length-1];if(void 0!==e.retain&&void 0===e.attributes)t.pop();else break}}),this._delta=t}return this._delta}}class r_ extends tZ{constructor(e){super(),this._pending=void 0!==e?[()=>this.insert(0,e)]:[],this._searchMarker=[],this._hasFormatting=!1}get length(){return this.doc??t$(),this._length}_integrate(e,t){super._integrate(e,t);try{this._pending.forEach(e=>e())}catch(e){console.error(e)}this._pending=null}_copy(){return new r_}clone(){let e=new r_;return e.applyDelta(this.toDelta()),e}_callObserver(e,t){super._callObserver(e,t);let r=new rA(this,e,t);tQ(this,e,r),!e.local&&this._hasFormatting&&(e._needFormattingCleanup=!0)}toString(){this.doc??t$();let e="",t=this._start;for(;null!==t;)!t.deleted&&t.countable&&t.content.constructor===rY&&(e+=t.content.str),t=t.right;return e}toJSON(){return this.toString()}applyDelta(e,{sanitize:t=!0}={}){null!==this.doc?td(this.doc,r=>{let n=new rg(null,this._start,0,new Map);for(let i=0;i<e.length;i++){let s=e[i];if(void 0!==s.insert){let o=t||"string"!=typeof s.insert||i!==e.length-1||null!==n.right||"\n"!==s.insert.slice(-1)?s.insert:s.insert.slice(0,-1);("string"!=typeof o||o.length>0)&&rI(r,this,n,o,s.attributes||{})}else void 0!==s.retain?rS(r,this,n,s.retain,s.attributes||{}):void 0!==s.delete&&rC(r,n,s.delete)}}):this._pending.push(()=>this.applyDelta(e))}toDelta(e,t,r){this.doc??t$();let n=[],i=new Map,s=this.doc,o="",a=this._start;function l(){if(o.length>0){let e={},t=!1;i.forEach((r,n)=>{t=!0,e[n]=r});let r={insert:o};t&&(r.attributes=e),n.push(r),o=""}}let c=()=>{for(;null!==a;){if(eK(a,e)||void 0!==t&&eK(a,t))switch(a.content.constructor){case rY:{let n=i.get("ychange");void 0===e||eK(a,e)?void 0===t||eK(a,t)?void 0!==n&&(l(),i.delete("ychange")):(void 0===n||n.user!==a.id.client||"added"!==n.type)&&(l(),i.set("ychange",r?r("added",a.id):{type:"added"})):(void 0===n||n.user!==a.id.client||"removed"!==n.type)&&(l(),i.set("ychange",r?r("removed",a.id):{type:"removed"})),o+=a.content.str;break}case r8:case r$:{l();let e={insert:a.content.getContent()[0]};if(i.size>0){let t={};e.attributes=t,i.forEach((e,r)=>{t[r]=e})}n.push(e);break}case rz:eK(a,e)&&(l(),rx(i,a.content))}a=a.right}l()};return e||t?td(s,r=>{e&&eQ(r,e),t&&eQ(r,t),c()},"cleanup"):c(),n}insert(e,t,r){if(t.length<=0)return;let n=this.doc;null!==n?td(n,n=>{let i=ry(n,this,e,!r);r||(r={},i.currentAttributes.forEach((e,t)=>{r[t]=e})),rI(n,this,i,t,r)}):this._pending.push(()=>this.insert(e,t,r))}insertEmbed(e,t,r){let n=this.doc;null!==n?td(n,n=>{let i=ry(n,this,e,!r);rI(n,this,i,t,r||{})}):this._pending.push(()=>this.insertEmbed(e,t,r||{}))}delete(e,t){if(0===t)return;let r=this.doc;null!==r?td(r,r=>{rC(r,ry(r,this,e,!0),t)}):this._pending.push(()=>this.delete(e,t))}format(e,t,r){if(0===t)return;let n=this.doc;null!==n?td(n,n=>{let i=ry(n,this,e,!1);null!==i.right&&rS(n,this,i,t,r)}):this._pending.push(()=>this.format(e,t,r))}removeAttribute(e){null!==this.doc?td(this.doc,t=>{rr(t,this,e)}):this._pending.push(()=>this.removeAttribute(e))}setAttribute(e,t){null!==this.doc?td(this.doc,r=>{rn(r,this,e,t)}):this._pending.push(()=>this.setAttribute(e,t))}getAttribute(e){return ri(this,e)}getAttributes(){return rs(this)}_write(e){e.writeTypeRef(rQ)}}class rD{constructor(e,t=()=>!0){this._filter=t,this._root=e,this._currentNode=e._start,this._firstCall=!0,e.doc??t$()}[Symbol.iterator](){return this}next(){let e=this._currentNode,t=e&&e.content&&e.content.type;if(null!==e&&(!this._firstCall||e.deleted||!this._filter(t)))do if(t=e.content.type,e.deleted||t.constructor!==rB&&t.constructor!==rj||null===t._start)for(;null!==e;){let t=e.next;if(null!==t){e=t;break}e=e.parent===this._root?null:e.parent._item}else e=t._start;while(null!==e&&(e.deleted||!this._filter(e.content.type)))return(this._firstCall=!1,null===e)?{value:void 0,done:!0}:(this._currentNode=e,{value:e.content.type,done:!1})}}class rj extends tZ{constructor(){super(),this._prelimContent=[]}get firstChild(){let e=this._first;return e?e.content.getContent()[0]:null}_integrate(e,t){super._integrate(e,t),this.insert(0,this._prelimContent),this._prelimContent=null}_copy(){return new rj}clone(){let e=new rj;return e.insert(0,this.toArray().map(e=>e instanceof tZ?e.clone():e)),e}get length(){return this.doc??t$(),null===this._prelimContent?this._length:this._prelimContent.length}createTreeWalker(e){return new rD(this,e)}querySelector(e){e=e.toUpperCase();let t=new rD(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e).next();return t.done?null:t.value}querySelectorAll(e){return e=e.toUpperCase(),o.from(new rD(this,t=>t.nodeName&&t.nodeName.toUpperCase()===e))}_callObserver(e,t){tQ(this,e,new rO(this,t,e))}toString(){return t6(this,e=>e.toString()).join("")}toJSON(){return this.toString()}toDOM(e=document,t={},r){let n=e.createDocumentFragment();return void 0!==r&&r._createAssociation(n,this),t8(this,i=>{n.insertBefore(i.toDOM(e,t,r),null)}),n}insert(e,t){null!==this.doc?td(this.doc,r=>{t7(r,this,e,t)}):this._prelimContent.splice(e,0,...t)}insertAfter(e,t){if(null!==this.doc)td(this.doc,r=>{t4(r,this,e&&e instanceof tZ?e._item:e,t)});else{let r=this._prelimContent,n=null===e?0:r.findIndex(t=>t===e)+1;if(0===n&&null!==e)throw p.create("Reference item not found");r.splice(n,0,...t)}}delete(e,t=1){null!==this.doc?td(this.doc,r=>{rt(r,this,e,t)}):this._prelimContent.splice(e,t)}toArray(){return t1(this)}push(e){this.insert(this.length,e)}unshift(e){this.insert(0,e)}get(e){return t5(this,e)}slice(e=0,t=this.length){return t0(this,e,t)}forEach(e){t8(this,e)}_write(e){e.writeTypeRef(r0)}}class rB extends rj{constructor(e="UNDEFINED"){super(),this.nodeName=e,this._prelimAttrs=new Map}get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_integrate(e,t){super._integrate(e,t),this._prelimAttrs.forEach((e,t)=>{this.setAttribute(t,e)}),this._prelimAttrs=null}_copy(){return new rB(this.nodeName)}clone(){let e=new rB(this.nodeName),t=this.getAttributes();return I.forEach(t,(t,r)=>{"string"==typeof t&&e.setAttribute(r,t)}),e.insert(0,this.toArray().map(e=>e instanceof tZ?e.clone():e)),e}toString(){let e=this.getAttributes(),t=[],r=[];for(let t in e)r.push(t);r.sort();let n=r.length;for(let i=0;i<n;i++){let n=r[i];t.push(n+'="'+e[n]+'"')}let i=this.nodeName.toLocaleLowerCase(),s=t.length>0?" "+t.join(" "):"";return`<${i}${s}>${super.toString()}</${i}>`}removeAttribute(e){null!==this.doc?td(this.doc,t=>{rr(t,this,e)}):this._prelimAttrs.delete(e)}setAttribute(e,t){null!==this.doc?td(this.doc,r=>{rn(r,this,e,t)}):this._prelimAttrs.set(e,t)}getAttribute(e){return ri(this,e)}hasAttribute(e){return ro(this,e)}getAttributes(e){return e?rl(this,e):rs(this)}toDOM(e=document,t={},r){let n=e.createElement(this.nodeName),i=this.getAttributes();for(let e in i){let t=i[e];"string"==typeof t&&n.setAttribute(e,t)}return t8(this,i=>{n.appendChild(i.toDOM(e,t,r))}),void 0!==r&&r._createAssociation(n,this),n}_write(e){e.writeTypeRef(rZ),e.writeKey(this.nodeName)}}class rO extends tF{constructor(e,t,r){super(e,r),this.childListChanged=!1,this.attributesChanged=new Set,t.forEach(e=>{null===e?this.childListChanged=!0:this.attributesChanged.add(e)})}}class rR extends rf{constructor(e){super(),this.hookName=e}_copy(){return new rR(this.hookName)}clone(){let e=new rR(this.hookName);return this.forEach((t,r)=>{e.set(r,t)}),e}toDOM(e=document,t={},r){let n,i=t[this.hookName];return(n=void 0!==i?i.createDom(this):document.createElement(this.hookName)).setAttribute("data-yjs-hook",this.hookName),void 0!==r&&r._createAssociation(n,this),n}_write(e){e.writeTypeRef(r1),e.writeKey(this.hookName)}}class rM extends r_{get nextSibling(){let e=this._item?this._item.next:null;return e?e.content.type:null}get prevSibling(){let e=this._item?this._item.prev:null;return e?e.content.type:null}_copy(){return new rM}clone(){let e=new rM;return e.applyDelta(this.toDelta()),e}toDOM(e=document,t,r){let n=e.createTextNode(this.toString());return void 0!==r&&r._createAssociation(n,this),n}toString(){return this.toDelta().map(e=>{let t=[];for(let r in e.attributes){let n=[];for(let t in e.attributes[r])n.push({key:t,value:e.attributes[r][t]});n.sort((e,t)=>e.key<t.key?-1:1),t.push({nodeName:r,attrs:n})}t.sort((e,t)=>e.nodeName<t.nodeName?-1:1);let r="";for(let e=0;e<t.length;e++){let n=t[e];r+=`<${n.nodeName}`;for(let e=0;e<n.attrs.length;e++){let t=n.attrs[e];r+=` ${t.key}="${t.value}"`}r+=">"}r+=e.insert;for(let e=t.length-1;e>=0;e--)r+=`</${t[e].nodeName}>`;return r}).join("")}toJSON(){return this.toString()}_write(e){e.writeTypeRef(r2)}}class rN{constructor(e,t){this.id=e,this.length=t}get deleted(){throw p.methodUnimplemented()}mergeWith(e){return!1}write(e,t,r){throw p.methodUnimplemented()}integrate(e,t){throw p.methodUnimplemented()}}class rL extends rN{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){t>0&&(this.id.clock+=t,this.length-=t),e3(e.doc.store,this)}write(e,t){e.writeInfo(0),e.writeLen(this.length-t)}getMissing(e,t){return null}}class rV{constructor(e){this.content=e}getLength(){return 1}getContent(){return[this.content]}isCountable(){return!0}copy(){return new rV(this.content)}splice(e){throw p.methodUnimplemented()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeBuf(this.content)}getRef(){return 3}}class rP{constructor(e){this.len=e}getLength(){return this.len}getContent(){return[]}isCountable(){return!1}copy(){return new rP(this.len)}splice(e){let t=new rP(this.len-e);return this.len=e,t}mergeWith(e){return this.len+=e.len,!0}integrate(e,t){B(e.deleteSet,t.id.client,t.id.clock,this.len),t.markDeleted()}delete(e){}gc(e){}write(e,t){e.writeLen(this.len-t)}getRef(){return 1}}let rF=(e,t)=>new F({guid:e,...t,shouldLoad:t.shouldLoad||t.autoLoad||!1});class rq{constructor(e){e._item&&console.error("This document was already integrated as a sub-document. You should create a second instance instead with the same guid."),this.doc=e;let t={};this.opts=t,e.gc||(t.gc=!1),e.autoLoad&&(t.autoLoad=!0),null!==e.meta&&(t.meta=e.meta)}getLength(){return 1}getContent(){return[this.doc]}isCountable(){return!0}copy(){return new rq(rF(this.doc.guid,this.opts))}splice(e){throw p.methodUnimplemented()}mergeWith(e){return!1}integrate(e,t){this.doc._item=t,e.subdocsAdded.add(this.doc),this.doc.shouldLoad&&e.subdocsLoaded.add(this.doc)}delete(e){e.subdocsAdded.has(this.doc)?e.subdocsAdded.delete(this.doc):e.subdocsRemoved.add(this.doc)}gc(e){}write(e,t){e.writeString(this.doc.guid),e.writeAny(this.opts)}getRef(){return 9}}class r${constructor(e){this.embed=e}getLength(){return 1}getContent(){return[this.embed]}isCountable(){return!0}copy(){return new r$(this.embed)}splice(e){throw p.methodUnimplemented()}mergeWith(e){return!1}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeJSON(this.embed)}getRef(){return 5}}class rz{constructor(e,t){this.key=e,this.value=t}getLength(){return 1}getContent(){return[]}isCountable(){return!1}copy(){return new rz(this.key,this.value)}splice(e){throw p.methodUnimplemented()}mergeWith(e){return!1}integrate(e,t){let r=t.parent;r._searchMarker=null,r._hasFormatting=!0}delete(e){}gc(e){}write(e,t){e.writeKey(this.key),e.writeJSON(this.value)}getRef(){return 6}}class rH{constructor(e){this.arr=e}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new rH(this.arr)}splice(e){let t=new rH(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){let r=this.arr.length;e.writeLen(r-t);for(let n=t;n<r;n++){let t=this.arr[n];e.writeString(void 0===t?"undefined":JSON.stringify(t))}}getRef(){return 2}}let rJ="development"===S.getVariable("node_env");class rG{constructor(e){this.arr=e,rJ&&I.deepFreeze(e)}getLength(){return this.arr.length}getContent(){return this.arr}isCountable(){return!0}copy(){return new rG(this.arr)}splice(e){let t=new rG(this.arr.slice(e));return this.arr=this.arr.slice(0,e),t}mergeWith(e){return this.arr=this.arr.concat(e.arr),!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){let r=this.arr.length;e.writeLen(r-t);for(let n=t;n<r;n++){let t=this.arr[n];e.writeAny(t)}}getRef(){return 8}}class rY{constructor(e){this.str=e}getLength(){return this.str.length}getContent(){return this.str.split("")}isCountable(){return!0}copy(){return new rY(this.str)}splice(e){let t=new rY(this.str.slice(e));this.str=this.str.slice(0,e);let r=this.str.charCodeAt(e-1);return r>=55296&&r<=56319&&(this.str=this.str.slice(0,e-1)+"",t.str=""+t.str.slice(1)),t}mergeWith(e){return this.str+=e.str,!0}integrate(e,t){}delete(e){}gc(e){}write(e,t){e.writeString(0===t?this.str:this.str.slice(t))}getRef(){return 4}}let rW=[e=>new rd,e=>new rf,e=>new r_,e=>new rB(e.readKey()),e=>new rj,e=>new rR(e.readKey()),e=>new rM],rX=0,rK=1,rQ=2,rZ=3,r0=4,r1=5,r2=6;class r8{constructor(e){this.type=e}getLength(){return 1}getContent(){return[this.type]}isCountable(){return!0}copy(){return new r8(this.type._copy())}splice(e){throw p.methodUnimplemented()}mergeWith(e){return!1}integrate(e,t){this.type._integrate(e.doc,t)}delete(e){let t=this.type._start;for(;null!==t;)t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e),t=t.right;this.type._map.forEach(t=>{t.deleted?t.id.clock<(e.beforeState.get(t.id.client)||0)&&e._mergeStructs.push(t):t.delete(e)}),e.changed.delete(this.type)}gc(e){let t=this.type._start;for(;null!==t;)t.gc(e,!0),t=t.right;this.type._start=null,this.type._map.forEach(t=>{for(;null!==t;)t.gc(e,!0),t=t.left}),this.type._map=new Map}write(e,t){this.type._write(e)}getRef(){return 7}}let r6=(e,t)=>{let r,n=t,i=0;do i>0&&(n=eE(n.client,n.clock+i)),r=e4(e,n),i=n.clock-r.id.clock,n=r.redone;while(null!==n&&r instanceof r7)return{item:r,diff:i}},r3=(e,t)=>{for(;null!==e&&e.keep!==t;)e.keep=t,e=e.parent._item},r5=(e,t,r)=>{let{client:n,clock:i}=t.id,s=new r7(eE(n,i+r),t,eE(n,i+r-1),t.right,t.rightOrigin,t.parent,t.parentSub,t.content.splice(r));return t.deleted&&s.markDeleted(),t.keep&&(s.keep=!0),null!==t.redone&&(s.redone=eE(t.redone.client,t.redone.clock+r)),t.right=s,null!==s.right&&(s.right.left=s),e._mergeStructs.push(s),null!==s.parentSub&&null===s.right&&s.parent._map.set(s.parentSub,s),t.length=r,s},r4=(e,t)=>o.some(e,e=>_(e.deletions,t)),r9=(e,t,r,n,i,s)=>{let o,a=e.doc,l=a.store,c=a.clientID,h=t.redone;if(null!==h)return e7(e,h);let d=t.parent._item,u=null;if(null!==d&&!0===d.deleted){if(null===d.redone&&(!r.has(d)||null===r9(e,d,r,n,i,s)))return null;for(;null!==d.redone;)d=e7(e,d.redone)}let f=null===d?t.parent:d.content.type;if(null===t.parentSub){for(u=t.left,o=t;null!==u;){let t=u;for(;null!==t&&t.parent._item!==d;)t=null===t.redone?null:e7(e,t.redone);if(null!==t&&t.parent._item===d){u=t;break}u=u.left}for(;null!==o;){let t=o;for(;null!==t&&t.parent._item!==d;)t=null===t.redone?null:e7(e,t.redone);if(null!==t&&t.parent._item===d){o=t;break}o=o.right}}else if(o=null,t.right&&!i){for(u=t;null!==u&&null!==u.right&&(u.right.redone||_(n,u.right.id)||r4(s.undoStack,u.right.id)||r4(s.redoStack,u.right.id));)for(u=u.right;u.redone;)u=e7(e,u.redone);if(u&&null!==u.right)return null}else u=f._map.get(t.parentSub)||null;let p=e6(l,c),g=eE(c,p),m=new r7(g,u,u&&u.lastId,o,o&&o.id,f,t.parentSub,t.content.copy());return t.redone=g,r3(m,!0),m.integrate(e,0),m};class r7 extends rN{constructor(e,t,r,n,i,s,o,a){super(e,a.getLength()),this.origin=r,this.left=t,this.right=n,this.rightOrigin=i,this.parent=s,this.parentSub=o,this.redone=null,this.content=a,this.info=this.content.isCountable()?g.BIT2:0}set marker(e){(this.info&g.BIT4)>0!==e&&(this.info^=g.BIT4)}get marker(){return(this.info&g.BIT4)>0}get keep(){return(this.info&g.BIT1)>0}set keep(e){this.keep!==e&&(this.info^=g.BIT1)}get countable(){return(this.info&g.BIT2)>0}get deleted(){return(this.info&g.BIT3)>0}set deleted(e){this.deleted!==e&&(this.info^=g.BIT3)}markDeleted(){this.info|=g.BIT3}getMissing(e,t){if(this.origin&&this.origin.client!==this.id.client&&this.origin.clock>=e6(t,this.origin.client))return this.origin.client;if(this.rightOrigin&&this.rightOrigin.client!==this.id.client&&this.rightOrigin.clock>=e6(t,this.rightOrigin.client))return this.rightOrigin.client;if(this.parent&&this.parent.constructor===ex&&this.id.client!==this.parent.client&&this.parent.clock>=e6(t,this.parent.client))return this.parent.client;if(this.origin&&(this.left=te(e,t,this.origin),this.origin=this.left.lastId),this.rightOrigin&&(this.right=e7(e,this.rightOrigin),this.rightOrigin=this.right.id),this.left&&this.left.constructor===rL||this.right&&this.right.constructor===rL)this.parent=null;else if(this.parent){if(this.parent.constructor===ex){let e=e4(t,this.parent);e.constructor===rL?this.parent=null:this.parent=e.content.type}}else this.left&&this.left.constructor===r7?(this.parent=this.left.parent,this.parentSub=this.left.parentSub):this.right&&this.right.constructor===r7&&(this.parent=this.right.parent,this.parentSub=this.right.parentSub);return null}integrate(e,t){if(t>0&&(this.id.clock+=t,this.left=te(e,e.doc.store,eE(this.id.client,this.id.clock-1)),this.origin=this.left.lastId,this.content=this.content.splice(t),this.length-=t),this.parent){if(!this.left&&(!this.right||null!==this.right.left)||this.left&&this.left.right!==this.right){let t,r=this.left;if(null!==r)t=r.right;else if(null!==this.parentSub)for(t=this.parent._map.get(this.parentSub)||null;null!==t&&null!==t.left;)t=t.left;else t=this.parent._start;let n=new Set,i=new Set;for(;null!==t&&t!==this.right;){if(i.add(t),n.add(t),eb(this.origin,t.origin)){if(t.id.client<this.id.client)r=t,n.clear();else if(eb(this.rightOrigin,t.rightOrigin))break}else if(null!==t.origin&&i.has(e4(e.doc.store,t.origin)))n.has(e4(e.doc.store,t.origin))||(r=t,n.clear());else break;t=t.right}this.left=r}if(null!==this.left){let e=this.left.right;this.right=e,this.left.right=this}else{let e;if(null!==this.parentSub)for(e=this.parent._map.get(this.parentSub)||null;null!==e&&null!==e.left;)e=e.left;else e=this.parent._start,this.parent._start=this;this.right=e}null!==this.right?this.right.left=this:null!==this.parentSub&&(this.parent._map.set(this.parentSub,this),null!==this.left&&this.left.delete(e)),null===this.parentSub&&this.countable&&!this.deleted&&(this.parent._length+=this.length),e3(e.doc.store,this),this.content.integrate(e,this),ts(e,this.parent,this.parentSub),(null!==this.parent._item&&this.parent._item.deleted||null!==this.parentSub&&null!==this.right)&&this.delete(e)}else new rL(this.id,this.length).integrate(e,0)}get next(){let e=this.right;for(;null!==e&&e.deleted;)e=e.right;return e}get prev(){let e=this.left;for(;null!==e&&e.deleted;)e=e.left;return e}get lastId(){return 1===this.length?this.id:eE(this.id.client,this.id.clock+this.length-1)}mergeWith(e){if(this.constructor===e.constructor&&eb(e.origin,this.lastId)&&this.right===e&&eb(this.rightOrigin,e.rightOrigin)&&this.id.client===e.id.client&&this.id.clock+this.length===e.id.clock&&this.deleted===e.deleted&&null===this.redone&&null===e.redone&&this.content.constructor===e.content.constructor&&this.content.mergeWith(e.content)){let t=this.parent._searchMarker;return t&&t.forEach(t=>{t.p===e&&(t.p=this,!this.deleted&&this.countable&&(t.index-=this.length))}),e.keep&&(this.keep=!0),this.right=e.right,null!==this.right&&(this.right.left=this),this.length+=e.length,!0}return!1}delete(e){if(!this.deleted){let t=this.parent;this.countable&&null===this.parentSub&&(t._length-=this.length),this.markDeleted(),B(e.deleteSet,this.id.client,this.id.clock,this.length),ts(e,t,this.parentSub),this.content.delete(e)}}gc(e,t){if(!this.deleted)throw p.unexpectedCase();this.content.gc(e),t?tt(e,this,new rL(this.id,this.length)):this.content=new rP(this.length)}write(e,t){let r=t>0?eE(this.id.client,this.id.clock+t-1):this.origin,n=this.rightOrigin,i=this.parentSub,s=this.content.getRef()&g.BITS5|(null===r?0:g.BIT8)|(null===n?0:g.BIT7)|(null===i?0:g.BIT6);if(e.writeInfo(s),null!==r&&e.writeLeftID(r),null!==n&&e.writeRightID(n),null===r&&null===n){let t=this.parent;if(void 0!==t._item){let r=t._item;if(null===r){let r=ev(t);e.writeParentInfo(!0),e.writeString(r)}else e.writeParentInfo(!1),e.writeLeftID(r.id)}else t.constructor===String?(e.writeParentInfo(!0),e.writeString(t)):t.constructor===ex?(e.writeParentInfo(!1),e.writeLeftID(t)):p.unexpectedCase();null!==i&&e.writeString(i)}this.content.write(e,t)}}let ne=(e,t)=>nt[t&g.BITS5](e),nt=[()=>{p.unexpectedCase()},e=>new rP(e.readLen()),e=>{let t=e.readLen(),r=[];for(let n=0;n<t;n++){let t=e.readString();"undefined"===t?r.push(void 0):r.push(JSON.parse(t))}return new rH(r)},e=>new rV(e.readBuf()),e=>new rY(e.readString()),e=>new r$(e.readJSON()),e=>new rz(e.readKey(),e.readJSON()),e=>new r8(rW[e.readTypeRef()](e)),e=>{let t=e.readLen(),r=[];for(let n=0;n<t;n++)r.push(e.readAny());return new rG(r)},e=>new rq(rF(e.readString(),e.readAny())),()=>{p.unexpectedCase()}];class nr extends rN{get deleted(){return!0}delete(){}mergeWith(e){return this.constructor===e.constructor&&(this.length+=e.length,!0)}integrate(e,t){p.unexpectedCase()}write(e,t){e.writeInfo(10),c.writeVarUint(e.restEncoder,this.length-t)}getMissing(e,t){return null}}let nn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==v?v:{},ni="__ $YJS$ __";!0===nn[ni]&&console.error("Yjs was already imported. This breaks constructor checks and will lead to issues! - https://github.com/yjs/yjs/issues/438"),nn[ni]=!0},{"lib0/observable":"9aNB9","lib0/array":"kcR8B","lib0/math":"icsnC","lib0/map":"gsPjK","lib0/encoding":"jAo8y","lib0/decoding":"2MQNo","lib0/random":"6zQml","lib0/promise":"98Jbs","lib0/buffer":"ezlBF","lib0/error":"gsHuq","lib0/binary":"c3vnv","lib0/function":"5S3AJ","lib0/set":"5gNQm","lib0/logging":"blwZs","lib0/time":"b6cMp","lib0/string":"l5ap6","lib0/iterator":"dOXgT","lib0/object":"eUSla","lib0/environment":"8YiHn","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],"9aNB9":[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"ObservableV2",()=>l),i.export(r,"Observable",()=>c);var s=e("./map.js"),o=e("./set.js"),a=e("./array.js");class l{constructor(){this._observers=s.create()}on(e,t){return s.setIfUndefined(this._observers,e,o.create).add(t),t}once(e,t){let r=(...n)=>{this.off(e,r),t(...n)};this.on(e,r)}off(e,t){let r=this._observers.get(e);void 0!==r&&(r.delete(t),0===r.size&&this._observers.delete(e))}emit(e,t){return a.from((this._observers.get(e)||s.create()).values()).forEach(e=>e(...t))}destroy(){this._observers=s.create()}}class c{constructor(){this._observers=s.create()}on(e,t){s.setIfUndefined(this._observers,e,o.create).add(t)}once(e,t){let r=(...n)=>{this.off(e,r),t(...n)};this.on(e,r)}off(e,t){let r=this._observers.get(e);void 0!==r&&(r.delete(t),0===r.size&&this._observers.delete(e))}emit(e,t){return a.from((this._observers.get(e)||s.create()).values()).forEach(e=>e(...t))}destroy(){this._observers=s.create()}}},{"./map.js":"gsPjK","./set.js":"5gNQm","./array.js":"kcR8B","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],gsPjK:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"create",()=>s),i.export(r,"copy",()=>o),i.export(r,"setIfUndefined",()=>a),i.export(r,"map",()=>l),i.export(r,"any",()=>c),i.export(r,"all",()=>h);let s=()=>new Map,o=e=>{let t=s();return e.forEach((e,r)=>{t.set(r,e)}),t},a=(e,t,r)=>{let n=e.get(t);return void 0===n&&e.set(t,n=r()),n},l=(e,t)=>{let r=[];for(let[n,i]of e)r.push(t(i,n));return r},c=(e,t)=>{for(let[r,n]of e)if(t(n,r))return!0;return!1},h=(e,t)=>{for(let[r,n]of e)if(!t(n,r))return!1;return!0}},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],j9EeU:[function(e,t,r,n){r.interopDefault=function(e){return e&&e.__esModule?e:{default:e}},r.defineInteropFlag=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.exportAll=function(e,t){return Object.keys(e).forEach(function(r){"default"===r||"__esModule"===r||Object.prototype.hasOwnProperty.call(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[r]}})}),t},r.export=function(e,t,r){Object.defineProperty(e,t,{enumerable:!0,get:r})}},{}],"5gNQm":[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"create",()=>s),i.export(r,"toArray",()=>o),i.export(r,"first",()=>a),i.export(r,"from",()=>l);let s=()=>new Set,o=e=>Array.from(e),a=e=>e.values().next().value??void 0,l=e=>new Set(e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],kcR8B:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"last",()=>o),i.export(r,"create",()=>a),i.export(r,"copy",()=>l),i.export(r,"appendTo",()=>c),i.export(r,"from",()=>h),i.export(r,"every",()=>d),i.export(r,"some",()=>u),i.export(r,"equalFlat",()=>f),i.export(r,"flatten",()=>p),i.export(r,"unfold",()=>g),i.export(r,"fold",()=>m),i.export(r,"isArray",()=>y),i.export(r,"unique",()=>w),i.export(r,"uniqueBy",()=>x),i.export(r,"map",()=>b);var s=e("./set.js");let o=e=>e[e.length-1],a=()=>[],l=e=>e.slice(),c=(e,t)=>{for(let r=0;r<t.length;r++)e.push(t[r])},h=Array.from,d=(e,t)=>{for(let r=0;r<e.length;r++)if(!t(e[r],r,e))return!1;return!0},u=(e,t)=>{for(let r=0;r<e.length;r++)if(t(e[r],r,e))return!0;return!1},f=(e,t)=>e.length===t.length&&d(e,(e,r)=>e===t[r]),p=e=>m(e,[],(e,t)=>e.concat(t)),g=(e,t)=>{let r=Array(e);for(let n=0;n<e;n++)r[n]=t(n,r);return r},m=(e,t,r)=>e.reduce(r,t),y=Array.isArray,w=e=>h(s.from(e)),x=(e,t)=>{let r=s.create(),n=[];for(let i=0;i<e.length;i++){let s=e[i],o=t(s);r.has(o)||(r.add(o),n.push(s))}return n},b=(e,t)=>{let r=Array(e.length);for(let n=0;n<e.length;n++)r[n]=t(e[n],n,e);return r}},{"./set.js":"5gNQm","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],icsnC:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"floor",()=>s),i.export(r,"ceil",()=>o),i.export(r,"abs",()=>a),i.export(r,"imul",()=>l),i.export(r,"round",()=>c),i.export(r,"log10",()=>h),i.export(r,"log2",()=>d),i.export(r,"log",()=>u),i.export(r,"sqrt",()=>f),i.export(r,"add",()=>p),i.export(r,"min",()=>g),i.export(r,"max",()=>m),i.export(r,"isNaN",()=>y),i.export(r,"pow",()=>w),i.export(r,"exp10",()=>x),i.export(r,"sign",()=>b),i.export(r,"isNegativeZero",()=>E);let s=Math.floor,o=Math.ceil,a=Math.abs,l=Math.imul,c=Math.round,h=Math.log10,d=Math.log2,u=Math.log,f=Math.sqrt,p=(e,t)=>e+t,g=(e,t)=>e<t?e:t,m=(e,t)=>e>t?e:t,y=Number.isNaN,w=Math.pow,x=e=>Math.pow(10,e),b=Math.sign,E=e=>0!==e?e<0:1/e<0},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],jAo8y:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"Encoder",()=>h),i.export(r,"createEncoder",()=>d),i.export(r,"encode",()=>u),i.export(r,"length",()=>f),i.export(r,"hasContent",()=>p),i.export(r,"toUint8Array",()=>g),i.export(r,"verifyLen",()=>m),i.export(r,"write",()=>y),i.export(r,"set",()=>w),i.export(r,"writeUint8",()=>x),i.export(r,"setUint8",()=>b),i.export(r,"writeUint16",()=>E),i.export(r,"setUint16",()=>I),i.export(r,"writeUint32",()=>S),i.export(r,"writeUint32BigEndian",()=>v),i.export(r,"setUint32",()=>k),i.export(r,"writeVarUint",()=>U),i.export(r,"writeVarInt",()=>T),i.export(r,"_writeVarStringNative",()=>_),i.export(r,"_writeVarStringPolyfill",()=>D),i.export(r,"writeVarString",()=>j),i.export(r,"writeTerminatedString",()=>B),i.export(r,"writeTerminatedUint8Array",()=>O),i.export(r,"writeBinaryEncoder",()=>R),i.export(r,"writeUint8Array",()=>M),i.export(r,"writeVarUint8Array",()=>N),i.export(r,"writeOnDataView",()=>L),i.export(r,"writeFloat32",()=>V),i.export(r,"writeFloat64",()=>P),i.export(r,"writeBigInt64",()=>F),i.export(r,"writeBigUint64",()=>q),i.export(r,"writeAny",()=>H),i.export(r,"RleEncoder",()=>J),i.export(r,"IntDiffEncoder",()=>G),i.export(r,"RleIntDiffEncoder",()=>Y),i.export(r,"UintOptRleEncoder",()=>X),i.export(r,"IncUintOptRleEncoder",()=>K),i.export(r,"IntDiffOptRleEncoder",()=>Z),i.export(r,"StringEncoder",()=>ee);var s=e("./math.js"),o=e("./number.js"),a=e("./binary.js"),l=e("./string.js"),c=e("./array.js");class h{constructor(){this.cpos=0,this.cbuf=new Uint8Array(100),this.bufs=[]}}let d=()=>new h,u=e=>{let t=d();return e(t),g(t)},f=e=>{let t=e.cpos;for(let r=0;r<e.bufs.length;r++)t+=e.bufs[r].length;return t},p=e=>e.cpos>0||e.bufs.length>0,g=e=>{let t=new Uint8Array(f(e)),r=0;for(let n=0;n<e.bufs.length;n++){let i=e.bufs[n];t.set(i,r),r+=i.length}return t.set(new Uint8Array(e.cbuf.buffer,0,e.cpos),r),t},m=(e,t)=>{let r=e.cbuf.length;r-e.cpos<t&&(e.bufs.push(new Uint8Array(e.cbuf.buffer,0,e.cpos)),e.cbuf=new Uint8Array(2*s.max(r,t)),e.cpos=0)},y=(e,t)=>{let r=e.cbuf.length;e.cpos===r&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(2*r),e.cpos=0),e.cbuf[e.cpos++]=t},w=(e,t,r)=>{let n=null;for(let r=0;r<e.bufs.length&&null===n;r++){let i=e.bufs[r];t<i.length?n=i:t-=i.length}null===n&&(n=e.cbuf),n[t]=r},x=y,b=w,E=(e,t)=>{y(e,t&a.BITS8),y(e,t>>>8&a.BITS8)},I=(e,t,r)=>{w(e,t,r&a.BITS8),w(e,t+1,r>>>8&a.BITS8)},S=(e,t)=>{for(let r=0;r<4;r++)y(e,t&a.BITS8),t>>>=8},v=(e,t)=>{for(let r=3;r>=0;r--)y(e,t>>>8*r&a.BITS8)},k=(e,t,r)=>{for(let n=0;n<4;n++)w(e,t+n,r&a.BITS8),r>>>=8},U=(e,t)=>{for(;t>a.BITS7;)y(e,a.BIT8|a.BITS7&t),t=s.floor(t/128);y(e,a.BITS7&t)},T=(e,t)=>{let r=s.isNegativeZero(t);for(r&&(t=-t),y(e,(t>a.BITS6?a.BIT8:0)|(r?a.BIT7:0)|a.BITS6&t),t=s.floor(t/64);t>0;)y(e,(t>a.BITS7?a.BIT8:0)|a.BITS7&t),t=s.floor(t/128)},C=new Uint8Array(3e4),A=C.length/3,_=(e,t)=>{if(t.length<A){let r=l.utf8TextEncoder.encodeInto(t,C).written||0;U(e,r);for(let t=0;t<r;t++)y(e,C[t])}else N(e,l.encodeUtf8(t))},D=(e,t)=>{let r=unescape(encodeURIComponent(t)),n=r.length;U(e,n);for(let t=0;t<n;t++)y(e,r.codePointAt(t))},j=l.utf8TextEncoder&&l.utf8TextEncoder.encodeInto?_:D,B=(e,t)=>O(e,l.encodeUtf8(t)),O=(e,t)=>{for(let r=0;r<t.length;r++){let n=t[r];(0===n||1===n)&&y(e,1),y(e,t[r])}y(e,0)},R=(e,t)=>M(e,g(t)),M=(e,t)=>{let r=e.cbuf.length,n=e.cpos,i=s.min(r-n,t.length),o=t.length-i;e.cbuf.set(t.subarray(0,i),n),e.cpos+=i,o>0&&(e.bufs.push(e.cbuf),e.cbuf=new Uint8Array(s.max(2*r,o)),e.cbuf.set(t.subarray(i)),e.cpos=o)},N=(e,t)=>{U(e,t.byteLength),M(e,t)},L=(e,t)=>{m(e,t);let r=new DataView(e.cbuf.buffer,e.cpos,t);return e.cpos+=t,r},V=(e,t)=>L(e,4).setFloat32(0,t,!1),P=(e,t)=>L(e,8).setFloat64(0,t,!1),F=(e,t)=>L(e,8).setBigInt64(0,t,!1),q=(e,t)=>L(e,8).setBigUint64(0,t,!1),$=new DataView(new ArrayBuffer(4)),z=e=>($.setFloat32(0,e),$.getFloat32(0)===e),H=(e,t)=>{switch(typeof t){case"string":y(e,119),j(e,t);break;case"number":o.isInteger(t)&&s.abs(t)<=a.BITS31?(y(e,125),T(e,t)):z(t)?(y(e,124),V(e,t)):(y(e,123),P(e,t));break;case"bigint":y(e,122),F(e,t);break;case"object":if(null===t)y(e,126);else if(c.isArray(t)){y(e,117),U(e,t.length);for(let r=0;r<t.length;r++)H(e,t[r])}else if(t instanceof Uint8Array)y(e,116),N(e,t);else{y(e,118);let r=Object.keys(t);U(e,r.length);for(let n=0;n<r.length;n++){let i=r[n];j(e,i),H(e,t[i])}}break;case"boolean":y(e,t?120:121);break;default:y(e,127)}};class J extends h{constructor(e){super(),this.w=e,this.s=null,this.count=0}write(e){this.s===e?this.count++:(this.count>0&&U(this,this.count-1),this.count=1,this.w(this,e),this.s=e)}}class G extends h{constructor(e){super(),this.s=e}write(e){T(this,e-this.s),this.s=e}}class Y extends h{constructor(e){super(),this.s=e,this.count=0}write(e){this.s===e&&this.count>0?this.count++:(this.count>0&&U(this,this.count-1),this.count=1,T(this,e-this.s),this.s=e)}}let W=e=>{e.count>0&&(T(e.encoder,1===e.count?e.s:-e.s),e.count>1&&U(e.encoder,e.count-2))};class X{constructor(){this.encoder=new h,this.s=0,this.count=0}write(e){this.s===e?this.count++:(W(this),this.count=1,this.s=e)}toUint8Array(){return W(this),g(this.encoder)}}class K{constructor(){this.encoder=new h,this.s=0,this.count=0}write(e){this.s+this.count===e?this.count++:(W(this),this.count=1,this.s=e)}toUint8Array(){return W(this),g(this.encoder)}}let Q=e=>{if(e.count>0){let t=2*e.diff+ +(1!==e.count);T(e.encoder,t),e.count>1&&U(e.encoder,e.count-2)}};class Z{constructor(){this.encoder=new h,this.s=0,this.count=0,this.diff=0}write(e){this.diff===e-this.s?(this.s=e,this.count++):(Q(this),this.count=1,this.diff=e-this.s,this.s=e)}toUint8Array(){return Q(this),g(this.encoder)}}class ee{constructor(){this.sarr=[],this.s="",this.lensE=new X}write(e){this.s+=e,this.s.length>19&&(this.sarr.push(this.s),this.s=""),this.lensE.write(e.length)}toUint8Array(){let e=new h;return this.sarr.push(this.s),this.s="",j(e,this.sarr.join("")),M(e,this.lensE.toUint8Array()),g(e)}}},{"./math.js":"icsnC","./number.js":"64qVp","./binary.js":"c3vnv","./string.js":"l5ap6","./array.js":"kcR8B","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],"64qVp":[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"MAX_SAFE_INTEGER",()=>a),i.export(r,"MIN_SAFE_INTEGER",()=>l),i.export(r,"LOWEST_INT32",()=>c),i.export(r,"HIGHEST_INT32",()=>h),i.export(r,"HIGHEST_UINT32",()=>d),i.export(r,"isInteger",()=>u),i.export(r,"isNaN",()=>f),i.export(r,"parseInt",()=>p),i.export(r,"countBits",()=>g);var s=e("./math.js"),o=e("./binary.js");let a=Number.MAX_SAFE_INTEGER,l=Number.MIN_SAFE_INTEGER,c=-0x80000000,h=o.BITS31,d=o.BITS32,u=Number.isInteger||(e=>"number"==typeof e&&isFinite(e)&&s.floor(e)===e),f=Number.isNaN,p=Number.parseInt,g=e=>{e&=o.BITS32;let t=0;for(;e;)e&=e-1,t++;return t}},{"./math.js":"icsnC","./binary.js":"c3vnv","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],c3vnv:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"BIT1",()=>s),i.export(r,"BIT2",()=>o),i.export(r,"BIT3",()=>a),i.export(r,"BIT4",()=>l),i.export(r,"BIT5",()=>c),i.export(r,"BIT6",()=>h),i.export(r,"BIT7",()=>d),i.export(r,"BIT8",()=>u),i.export(r,"BIT9",()=>f),i.export(r,"BIT10",()=>p),i.export(r,"BIT11",()=>g),i.export(r,"BIT12",()=>m),i.export(r,"BIT13",()=>y),i.export(r,"BIT14",()=>w),i.export(r,"BIT15",()=>x),i.export(r,"BIT16",()=>b),i.export(r,"BIT17",()=>E),i.export(r,"BIT18",()=>I),i.export(r,"BIT19",()=>S),i.export(r,"BIT20",()=>v),i.export(r,"BIT21",()=>k),i.export(r,"BIT22",()=>U),i.export(r,"BIT23",()=>T),i.export(r,"BIT24",()=>C),i.export(r,"BIT25",()=>A),i.export(r,"BIT26",()=>_),i.export(r,"BIT27",()=>D),i.export(r,"BIT28",()=>j),i.export(r,"BIT29",()=>B),i.export(r,"BIT30",()=>O),i.export(r,"BIT31",()=>R),i.export(r,"BIT32",()=>M),i.export(r,"BITS0",()=>N),i.export(r,"BITS1",()=>L),i.export(r,"BITS2",()=>V),i.export(r,"BITS3",()=>P),i.export(r,"BITS4",()=>F),i.export(r,"BITS5",()=>q),i.export(r,"BITS6",()=>$),i.export(r,"BITS7",()=>z),i.export(r,"BITS8",()=>H),i.export(r,"BITS9",()=>J),i.export(r,"BITS10",()=>G),i.export(r,"BITS11",()=>Y),i.export(r,"BITS12",()=>W),i.export(r,"BITS13",()=>X),i.export(r,"BITS14",()=>K),i.export(r,"BITS15",()=>Q),i.export(r,"BITS16",()=>Z),i.export(r,"BITS17",()=>ee),i.export(r,"BITS18",()=>et),i.export(r,"BITS19",()=>er),i.export(r,"BITS20",()=>en),i.export(r,"BITS21",()=>ei),i.export(r,"BITS22",()=>es),i.export(r,"BITS23",()=>eo),i.export(r,"BITS24",()=>ea),i.export(r,"BITS25",()=>el),i.export(r,"BITS26",()=>ec),i.export(r,"BITS27",()=>eh),i.export(r,"BITS28",()=>ed),i.export(r,"BITS29",()=>eu),i.export(r,"BITS30",()=>ef),i.export(r,"BITS31",()=>ep),i.export(r,"BITS32",()=>eg);let s=1,o=2,a=4,l=8,c=16,h=32,d=64,u=128,f=256,p=512,g=1024,m=2048,y=4096,w=8192,x=16384,b=32768,E=65536,I=131072,S=262144,v=524288,k=1048576,U=2097152,T=4194304,C=8388608,A=0x1000000,_=0x2000000,D=0x4000000,j=0x8000000,B=0x10000000,O=0x20000000,R=0x40000000,M=-0x80000000,N=0,L=1,V=3,P=7,F=15,q=31,$=63,z=127,H=255,J=511,G=1023,Y=2047,W=4095,X=8191,K=16383,Q=32767,Z=65535,ee=131071,et=262143,er=524287,en=1048575,ei=2097151,es=4194303,eo=8388607,ea=0xffffff,el=0x1ffffff,ec=0x3ffffff,eh=0x7ffffff,ed=0xfffffff,eu=0x1fffffff,ef=0x3fffffff,ep=0x7fffffff,eg=0xffffffff},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],l5ap6:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"fromCharCode",()=>o),i.export(r,"fromCodePoint",()=>a),i.export(r,"MAX_UTF16_CHARACTER",()=>l),i.export(r,"trimLeft",()=>d),i.export(r,"fromCamelCase",()=>f),i.export(r,"utf8ByteLength",()=>p),i.export(r,"_encodeUtf8Polyfill",()=>g),i.export(r,"utf8TextEncoder",()=>m),i.export(r,"_encodeUtf8Native",()=>y),i.export(r,"encodeUtf8",()=>w),i.export(r,"_decodeUtf8Polyfill",()=>x),i.export(r,"utf8TextDecoder",()=>b),i.export(r,"_decodeUtf8Native",()=>E),i.export(r,"decodeUtf8",()=>I),i.export(r,"splice",()=>S),i.export(r,"repeat",()=>v);var s=e("./array.js");let o=String.fromCharCode,a=String.fromCodePoint,l=o(65535),c=e=>e.toLowerCase(),h=/^\s*/g,d=e=>e.replace(h,""),u=/([A-Z])/g,f=(e,t)=>d(e.replace(u,e=>`${t}${c(e)}`)),p=e=>unescape(encodeURIComponent(e)).length,g=e=>{let t=unescape(encodeURIComponent(e)),r=t.length,n=new Uint8Array(r);for(let e=0;e<r;e++)n[e]=t.codePointAt(e);return n},m="undefined"!=typeof TextEncoder?new TextEncoder:null,y=e=>m.encode(e),w=m?y:g,x=e=>{let t=e.length,r="",n=0;for(;t>0;){let i=t<1e4?t:1e4,s=e.subarray(n,n+i);n+=i,r+=String.fromCodePoint.apply(null,s),t-=i}return decodeURIComponent(escape(r))},b="undefined"==typeof TextDecoder?null:new TextDecoder("utf-8",{fatal:!0,ignoreBOM:!0});b&&1===b.decode(new Uint8Array).length&&(b=null);let E=e=>b.decode(e),I=b?E:x,S=(e,t,r,n="")=>e.slice(0,t)+n+e.slice(t+r),v=(e,t)=>s.unfold(t,()=>e).join("")},{"./array.js":"kcR8B","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],"2MQNo":[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"Decoder",()=>f),i.export(r,"createDecoder",()=>p),i.export(r,"hasContent",()=>g),i.export(r,"clone",()=>m),i.export(r,"readUint8Array",()=>y),i.export(r,"readVarUint8Array",()=>w),i.export(r,"readTailAsUint8Array",()=>x),i.export(r,"skip8",()=>b),i.export(r,"readUint8",()=>E),i.export(r,"readUint16",()=>I),i.export(r,"readUint32",()=>S),i.export(r,"readUint32BigEndian",()=>v),i.export(r,"peekUint8",()=>k),i.export(r,"peekUint16",()=>U),i.export(r,"peekUint32",()=>T),i.export(r,"readVarUint",()=>C),i.export(r,"readVarInt",()=>A),i.export(r,"peekVarUint",()=>_),i.export(r,"peekVarInt",()=>D),i.export(r,"_readVarStringPolyfill",()=>j),i.export(r,"_readVarStringNative",()=>B),i.export(r,"readVarString",()=>O),i.export(r,"readTerminatedUint8Array",()=>R),i.export(r,"readTerminatedString",()=>M),i.export(r,"peekVarString",()=>N),i.export(r,"readFromDataView",()=>L),i.export(r,"readFloat32",()=>V),i.export(r,"readFloat64",()=>P),i.export(r,"readBigInt64",()=>F),i.export(r,"readBigUint64",()=>q),i.export(r,"readAny",()=>z),i.export(r,"RleDecoder",()=>H),i.export(r,"IntDiffDecoder",()=>J),i.export(r,"RleIntDiffDecoder",()=>G),i.export(r,"UintOptRleDecoder",()=>Y),i.export(r,"IncUintOptRleDecoder",()=>W),i.export(r,"IntDiffOptRleDecoder",()=>X),i.export(r,"StringDecoder",()=>K);var s=e("./binary.js"),o=e("./math.js"),a=e("./number.js"),l=e("./string.js"),c=e("./error.js"),h=e("./encoding.js");let d=c.create("Unexpected end of array"),u=c.create("Integer out of Range");class f{constructor(e){this.arr=e,this.pos=0}}let p=e=>new f(e),g=e=>e.pos!==e.arr.length,m=(e,t=e.pos)=>{let r=p(e.arr);return r.pos=t,r},y=(e,t)=>{let r=new Uint8Array(e.arr.buffer,e.pos+e.arr.byteOffset,t);return e.pos+=t,r},w=e=>y(e,C(e)),x=e=>y(e,e.arr.length-e.pos),b=e=>e.pos++,E=e=>e.arr[e.pos++],I=e=>{let t=e.arr[e.pos]+(e.arr[e.pos+1]<<8);return e.pos+=2,t},S=e=>{let t=e.arr[e.pos]+(e.arr[e.pos+1]<<8)+(e.arr[e.pos+2]<<16)+(e.arr[e.pos+3]<<24)>>>0;return e.pos+=4,t},v=e=>{let t=e.arr[e.pos+3]+(e.arr[e.pos+2]<<8)+(e.arr[e.pos+1]<<16)+(e.arr[e.pos]<<24)>>>0;return e.pos+=4,t},k=e=>e.arr[e.pos],U=e=>e.arr[e.pos]+(e.arr[e.pos+1]<<8),T=e=>e.arr[e.pos]+(e.arr[e.pos+1]<<8)+(e.arr[e.pos+2]<<16)+(e.arr[e.pos+3]<<24)>>>0,C=e=>{let t=0,r=1,n=e.arr.length;for(;e.pos<n;){let n=e.arr[e.pos++];if(t+=(n&s.BITS7)*r,r*=128,n<s.BIT8)return t;if(t>a.MAX_SAFE_INTEGER)throw u}throw d},A=e=>{let t=e.arr[e.pos++],r=t&s.BITS6,n=64,i=(t&s.BIT7)>0?-1:1;if((t&s.BIT8)==0)return i*r;let o=e.arr.length;for(;e.pos<o;){if(r+=((t=e.arr[e.pos++])&s.BITS7)*n,n*=128,t<s.BIT8)return i*r;if(r>a.MAX_SAFE_INTEGER)throw u}throw d},_=e=>{let t=e.pos,r=C(e);return e.pos=t,r},D=e=>{let t=e.pos,r=A(e);return e.pos=t,r},j=e=>{let t=C(e);if(0===t)return"";{let r=String.fromCodePoint(E(e));if(--t<100)for(;t--;)r+=String.fromCodePoint(E(e));else for(;t>0;){let n=t<1e4?t:1e4,i=e.arr.subarray(e.pos,e.pos+n);e.pos+=n,r+=String.fromCodePoint.apply(null,i),t-=n}return decodeURIComponent(escape(r))}},B=e=>l.utf8TextDecoder.decode(w(e)),O=l.utf8TextDecoder?B:j,R=e=>{let t,r=h.createEncoder();for(;;){if(0===(t=E(e)))return h.toUint8Array(r);1===t&&(t=E(e)),h.write(r,t)}},M=e=>l.decodeUtf8(R(e)),N=e=>{let t=e.pos,r=O(e);return e.pos=t,r},L=(e,t)=>{let r=new DataView(e.arr.buffer,e.arr.byteOffset+e.pos,t);return e.pos+=t,r},V=e=>L(e,4).getFloat32(0,!1),P=e=>L(e,8).getFloat64(0,!1),F=e=>L(e,8).getBigInt64(0,!1),q=e=>L(e,8).getBigUint64(0,!1),$=[e=>void 0,e=>null,A,V,P,F,e=>!1,e=>!0,O,e=>{let t=C(e),r={};for(let n=0;n<t;n++)r[O(e)]=z(e);return r},e=>{let t=C(e),r=[];for(let n=0;n<t;n++)r.push(z(e));return r},w],z=e=>$[127-E(e)](e);class H extends f{constructor(e,t){super(e),this.reader=t,this.s=null,this.count=0}read(){return 0===this.count&&(this.s=this.reader(this),g(this)?this.count=C(this)+1:this.count=-1),this.count--,this.s}}class J extends f{constructor(e,t){super(e),this.s=t}read(){return this.s+=A(this),this.s}}class G extends f{constructor(e,t){super(e),this.s=t,this.count=0}read(){return 0===this.count&&(this.s+=A(this),g(this)?this.count=C(this)+1:this.count=-1),this.count--,this.s}}class Y extends f{constructor(e){super(e),this.s=0,this.count=0}read(){if(0===this.count){this.s=A(this);let e=o.isNegativeZero(this.s);this.count=1,e&&(this.s=-this.s,this.count=C(this)+2)}return this.count--,this.s}}class W extends f{constructor(e){super(e),this.s=0,this.count=0}read(){if(0===this.count){this.s=A(this);let e=o.isNegativeZero(this.s);this.count=1,e&&(this.s=-this.s,this.count=C(this)+2)}return this.count--,this.s++}}class X extends f{constructor(e){super(e),this.s=0,this.count=0,this.diff=0}read(){if(0===this.count){let e=A(this);this.diff=o.floor(e/2),this.count=1,1&e&&(this.count=C(this)+2)}return this.s+=this.diff,this.count--,this.s}}class K{constructor(e){this.decoder=new Y(e),this.str=O(this.decoder),this.spos=0}read(){let e=this.spos+this.decoder.read(),t=this.str.slice(this.spos,e);return this.spos=e,t}}},{"./binary.js":"c3vnv","./math.js":"icsnC","./number.js":"64qVp","./string.js":"l5ap6","./error.js":"gsHuq","./encoding.js":"jAo8y","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],gsHuq:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"create",()=>s),i.export(r,"methodUnimplemented",()=>o),i.export(r,"unexpectedCase",()=>a);let s=e=>Error(e),o=()=>{throw s("Method unimplemented")},a=()=>{throw s("Unexpected case")}},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],"6zQml":[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"rand",()=>l),i.export(r,"uint32",()=>c),i.export(r,"uint53",()=>h),i.export(r,"oneOf",()=>d),i.export(r,"uuidv4",()=>u);var s=e("./math.js"),o=e("./binary.js"),a=e("lib0/webcrypto");let l=Math.random,c=()=>(0,a.getRandomValues)(new Uint32Array(1))[0],h=()=>{let e=(0,a.getRandomValues)(new Uint32Array(8));return(e[0]&o.BITS21)*(o.BITS32+1)+(e[1]>>>0)},d=e=>e[s.floor(l()*e.length)],u=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^c()&15>>e/4).toString(16))},{"./math.js":"icsnC","./binary.js":"c3vnv","lib0/webcrypto":"g4bLl","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],g4bLl:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"subtle",()=>s),i.export(r,"getRandomValues",()=>o);let s=crypto.subtle,o=crypto.getRandomValues.bind(crypto)},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],"98Jbs":[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"create",()=>o),i.export(r,"createEmpty",()=>a),i.export(r,"all",()=>l),i.export(r,"reject",()=>c),i.export(r,"resolve",()=>h),i.export(r,"resolveWith",()=>d),i.export(r,"until",()=>u),i.export(r,"untilAsync",()=>f),i.export(r,"wait",()=>p),i.export(r,"isPromise",()=>g);var s=e("./time.js");let o=e=>new Promise(e),a=e=>new Promise(e),l=Promise.all.bind(Promise),c=e=>Promise.reject(e),h=e=>Promise.resolve(e),d=e=>Promise.resolve(e),u=(e,t,r=10)=>o((n,i)=>{let o=s.getUnixTime(),a=e>0,l=setInterval(()=>{t()?(clearInterval(l),n()):a&&s.getUnixTime()-o>e&&(clearInterval(l),i(Error("Timeout")))},r)}),f=async(e,t=0,r=10)=>{let n=s.getUnixTime(),i=t<=0;for(;i||s.getUnixTime()-n<=t;){if(await e())return;await p(r)}throw Error("Timeout")},p=e=>o((t,r)=>setTimeout(t,e)),g=e=>e instanceof Promise||e&&e.then&&e.catch&&e.finally},{"./time.js":"b6cMp","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],b6cMp:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"getDate",()=>a),i.export(r,"getUnixTime",()=>l),i.export(r,"humanizeDuration",()=>c);var s=e("./metric.js"),o=e("./math.js");let a=()=>new Date,l=Date.now,c=e=>{if(e<6e4){let t=s.prefix(e,-1);return o.round(100*t.n)/100+t.prefix+"s"}let t=(e=o.floor(e/1e3))%60,r=o.floor(e/60)%60,n=o.floor(e/3600)%24,i=o.floor(e/86400);return i>0?i+"d"+(n>0||r>30?" "+(r>30?n+1:n)+"h":""):n>0?n+"h"+(r>0||t>30?" "+(t>30?r+1:r)+"min":""):r+"min"+(t>0?" "+t+"s":"")}},{"./metric.js":"2ArNY","./math.js":"icsnC","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],"2ArNY":[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"yotta",()=>o),i.export(r,"zetta",()=>a),i.export(r,"exa",()=>l),i.export(r,"peta",()=>c),i.export(r,"tera",()=>h),i.export(r,"giga",()=>d),i.export(r,"mega",()=>u),i.export(r,"kilo",()=>f),i.export(r,"hecto",()=>p),i.export(r,"deca",()=>g),i.export(r,"deci",()=>m),i.export(r,"centi",()=>y),i.export(r,"milli",()=>w),i.export(r,"micro",()=>x),i.export(r,"nano",()=>b),i.export(r,"pico",()=>E),i.export(r,"femto",()=>I),i.export(r,"atto",()=>S),i.export(r,"zepto",()=>v),i.export(r,"yocto",()=>k),i.export(r,"prefix",()=>C);var s=e("./math.js");let o=1e24,a=1e21,l=1e18,c=1e15,h=1e12,d=1e9,u=1e6,f=1e3,p=100,g=10,m=.1,y=.01,w=.001,x=1e-6,b=1e-9,E=1e-12,I=1e-15,S=1e-18,v=1e-21,k=1e-24,U=["","k","M","G","T","P","E","Z","Y"],T=["","m","","n","p","f","a","z","y"],C=(e,t=0)=>{let r=0===e?0:s.log10(e),n=0;for(;r<3*n&&t>-8;)t--,n--;for(;r>=3+3*n&&t<8;)t++,n++;let i=t<0?T[-t]:U[t];return{n:s.round((n>0?e/s.exp10(3*n):e*s.exp10(-3*n))*1e12)/1e12,prefix:i}}},{"./math.js":"icsnC","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],ezlBF:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"createUint8ArrayFromLen",()=>u),i.export(r,"createUint8ArrayViewFromArrayBuffer",()=>f),i.export(r,"createUint8ArrayFromArrayBuffer",()=>p),i.export(r,"toBase64",()=>g),i.export(r,"fromBase64",()=>m),i.export(r,"toBase64UrlEncoded",()=>y),i.export(r,"fromBase64UrlEncoded",()=>w),i.export(r,"toHexString",()=>x),i.export(r,"fromHexString",()=>b),i.export(r,"copyUint8Array",()=>E),i.export(r,"encodeAny",()=>I),i.export(r,"decodeAny",()=>S),i.export(r,"shiftNBitsLeft",()=>v);var s=e("./string.js"),o=e("./environment.js"),a=e("./array.js"),l=e("./math.js"),c=e("./encoding.js"),h=e("./decoding.js"),d=e("6475e0e5014d10a8").Buffer;let u=e=>new Uint8Array(e),f=(e,t,r)=>new Uint8Array(e,t,r),p=e=>new Uint8Array(e),g=o.isBrowser?e=>{let t="";for(let r=0;r<e.byteLength;r++)t+=s.fromCharCode(e[r]);return btoa(t)}:e=>d.from(e.buffer,e.byteOffset,e.byteLength).toString("base64"),m=o.isBrowser?e=>{let t=atob(e),r=u(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}:e=>{let t=d.from(e,"base64");return f(t.buffer,t.byteOffset,t.byteLength)},y=e=>g(e).replaceAll("+","-").replaceAll("/","_").replaceAll("=",""),w=e=>m(e.replaceAll("-","+").replaceAll("_","/")),x=e=>a.map(e,e=>e.toString(16).padStart(2,"0")).join(""),b=e=>{let t=e.length,r=new Uint8Array(l.ceil(t/2));for(let n=0;n<t;n+=2)r[r.length-n/2-1]=Number.parseInt(e.slice(t-n-2,t-n),16);return r},E=e=>{let t=u(e.byteLength);return t.set(e),t},I=e=>c.encode(t=>c.writeAny(t,e)),S=e=>h.readAny(h.createDecoder(e)),v=(e,t)=>{if(0===t)return e;e=new Uint8Array(e),e[0]<<=t;for(let r=1;r<e.length;r++)e[r-1]|=e[r]>>>8-t,e[r]<<=t;return e}},{"6475e0e5014d10a8":"b48lF","./string.js":"l5ap6","./environment.js":"8YiHn","./array.js":"kcR8B","./math.js":"icsnC","./encoding.js":"jAo8y","./decoding.js":"2MQNo","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],b48lF:[function(e,t,r,n){"use strict";let i=e("9c62938f1dccc73c"),s=e("aceacb6a4531a9d2"),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function a(e){if(e>0x7fffffff)throw RangeError('The value "'+e+'" is invalid for option "size"');let t=new Uint8Array(e);return Object.setPrototypeOf(t,l.prototype),t}function l(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return d(e)}return c(e,t,r)}function c(e,t,r){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!l.isEncoding(t))throw TypeError("Unknown encoding: "+t);let r=0|g(e,t),n=a(r),i=n.write(e,t);return i!==r&&(n=n.slice(0,i)),n}(e,t);if(ArrayBuffer.isView(e))return function(e){if(L(e,Uint8Array)){let t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(L(e,ArrayBuffer)||e&&L(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(L(e,SharedArrayBuffer)||e&&L(e.buffer,SharedArrayBuffer)))return f(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');let n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return l.from(n,t,r);let i=function(e){if(l.isBuffer(e)){let t=0|p(e.length),r=a(t);return 0===r.length||e.copy(r,0,0,t),r}return void 0!==e.length?"number"!=typeof e.length||function(e){return e!=e}(e.length)?a(0):u(e):"Buffer"===e.type&&Array.isArray(e.data)?u(e.data):void 0}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return l.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function h(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function d(e){return h(e),a(e<0?0:0|p(e))}function u(e){let t=e.length<0?0:0|p(e.length),r=a(t);for(let n=0;n<t;n+=1)r[n]=255&e[n];return r}function f(e,t,r){let n;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),l.prototype),n}function p(e){if(e>=0x7fffffff)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function g(e,t){if(l.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||L(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);let r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return R(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return M(e).length;default:if(i)return n?-1:R(e).length;t=(""+t).toLowerCase(),i=!0}}function m(e,t,r){let n=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){let n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);let i="";for(let n=t;n<r;++n)i+=V[e[n]];return i}(this,t,r);case"utf8":case"utf-8":return b(this,t,r);case"ascii":return function(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){let n="";r=Math.min(e.length,r);for(let i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}(this,t,r);case"base64":var s,o,a;return s=this,o=t,a=r,0===o&&a===s.length?i.fromByteArray(s):i.fromByteArray(s.slice(o,a));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){let n=e.slice(t,r),i="";for(let e=0;e<n.length-1;e+=2)i+=String.fromCharCode(n[e]+256*n[e+1]);return i}(this,t,r);default:if(n)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function y(e,t,r){let n=e[t];e[t]=e[r],e[r]=n}function w(e,t,r,n,i){var s;if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>0x7fffffff?r=0x7fffffff:r<-0x80000000&&(r=-0x80000000),(s=r*=1)!=s&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return -1;r=e.length-1}else if(r<0){if(!i)return -1;r=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:x(e,t,r,n,i);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):x(e,[t],r,n,i);throw TypeError("val must be string, number or Buffer")}function x(e,t,r,n,i){let s,o=1,a=e.length,l=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;o=2,a/=2,l/=2,r/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let n=-1;for(s=r;s<a;s++)if(c(e,s)===c(t,-1===n?0:s-n)){if(-1===n&&(n=s),s-n+1===l)return n*o}else -1!==n&&(s-=s-n),n=-1}else for(r+l>a&&(r=a-l),s=r;s>=0;s--){let r=!0;for(let n=0;n<l;n++)if(c(e,s+n)!==c(t,n)){r=!1;break}if(r)return s}return -1}function b(e,t,r){r=Math.min(e.length,r);let n=[],i=t;for(;i<r;){let t=e[i],s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=r){let r,n,a,l;switch(o){case 1:t<128&&(s=t);break;case 2:(192&(r=e[i+1]))==128&&(l=(31&t)<<6|63&r)>127&&(s=l);break;case 3:r=e[i+1],n=e[i+2],(192&r)==128&&(192&n)==128&&(l=(15&t)<<12|(63&r)<<6|63&n)>2047&&(l<55296||l>57343)&&(s=l);break;case 4:r=e[i+1],n=e[i+2],a=e[i+3],(192&r)==128&&(192&n)==128&&(192&a)==128&&(l=(15&t)<<18|(63&r)<<12|(63&n)<<6|63&a)>65535&&l<1114112&&(s=l)}}null===s?(s=65533,o=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=o}return function(e){let t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);let r="",n=0;for(;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}function E(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function I(e,t,r,n,i,s){if(!l.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function S(e,t,r,n,i){D(t,n,i,e,r,7);let s=Number(t&BigInt(0xffffffff));e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s,s>>=8,e[r++]=s;let o=Number(t>>BigInt(32)&BigInt(0xffffffff));return e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,o>>=8,e[r++]=o,r}function v(e,t,r,n,i){D(t,n,i,e,r,7);let s=Number(t&BigInt(0xffffffff));e[r+7]=s,s>>=8,e[r+6]=s,s>>=8,e[r+5]=s,s>>=8,e[r+4]=s;let o=Number(t>>BigInt(32)&BigInt(0xffffffff));return e[r+3]=o,o>>=8,e[r+2]=o,o>>=8,e[r+1]=o,o>>=8,e[r]=o,r+8}function k(e,t,r,n,i,s){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function U(e,t,r,n,i){return t*=1,r>>>=0,i||k(e,t,r,4,34028234663852886e22,-34028234663852886e22),s.write(e,t,r,n,23,4),r+4}function T(e,t,r,n,i){return t*=1,r>>>=0,i||k(e,t,r,8,17976931348623157e292,-17976931348623157e292),s.write(e,t,r,n,52,8),r+8}r.Buffer=l,r.SlowBuffer=function(e){return+e!=e&&(e=0),l.alloc(+e)},r.INSPECT_MAX_BYTES=50,r.kMaxLength=0x7fffffff,l.TYPED_ARRAY_SUPPORT=function(){try{let e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(e,t,r){return c(e,t,r)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(e,t,r){return(h(e),e<=0)?a(e):void 0!==t?"string"==typeof r?a(e).fill(t,r):a(e).fill(t):a(e)},l.allocUnsafe=function(e){return d(e)},l.allocUnsafeSlow=function(e){return d(e)},l.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==l.prototype},l.compare=function(e,t){if(L(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),L(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(e)||!l.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let r=e.length,n=t.length;for(let i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:+(n<r)},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){let r;if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;let n=l.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){let t=e[r];if(L(t,Uint8Array))i+t.length>n.length?(l.isBuffer(t)||(t=l.from(t)),t.copy(n,i)):Uint8Array.prototype.set.call(n,t,i);else if(l.isBuffer(t))t.copy(n,i);else throw TypeError('"list" argument must be an Array of Buffers');i+=t.length}return n},l.byteLength=g,l.prototype._isBuffer=!0,l.prototype.swap16=function(){let e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},l.prototype.swap32=function(){let e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},l.prototype.swap64=function(){let e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},l.prototype.toString=function(){let e=this.length;return 0===e?"":0==arguments.length?b(this,0,e):m.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(e){if(!l.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){let e="",t=r.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(e,t,r,n,i){if(L(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;let s=i-n,o=r-t,a=Math.min(s,o),c=this.slice(n,i),h=e.slice(t,r);for(let e=0;e<a;++e)if(c[e]!==h[e]){s=c[e],o=h[e];break}return s<o?-1:+(o<s)},l.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return w(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return w(this,e,t,r,!1)},l.prototype.write=function(e,t,r,n){var i,s,o,a,l,c,h,d;if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let u=this.length-t;if((void 0===r||r>u)&&(r=u),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let f=!1;for(;;)switch(n){case"hex":return function(e,t,r,n){let i;r=Number(r)||0;let s=e.length-r;n?(n=Number(n))>s&&(n=s):n=s;let o=t.length;for(n>o/2&&(n=o/2),i=0;i<n;++i){var a;let n=parseInt(t.substr(2*i,2),16);if((a=n)!=a)break;e[r+i]=n}return i}(this,e,t,r);case"utf8":case"utf-8":return i=t,s=r,N(R(e,this.length-i),this,i,s);case"ascii":case"latin1":case"binary":return o=t,a=r,N(function(e){let t=[];for(let r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}(e),this,o,a);case"base64":return l=t,c=r,N(M(e),this,l,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return h=t,d=r,N(function(e,t){let r,n,i=[];for(let s=0;s<e.length&&!((t-=2)<0);++s)n=(r=e.charCodeAt(s))>>8,i.push(r%256),i.push(n);return i}(e,this.length-h),this,h,d);default:if(f)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),f=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},l.prototype.slice=function(e,t){let r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,l.prototype),n},l.prototype.readUintLE=l.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||E(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return n},l.prototype.readUintBE=l.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||E(e,t,this.length);let n=this[e+--t],i=1;for(;t>0&&(i*=256);)n+=this[e+--t]*i;return n},l.prototype.readUint8=l.prototype.readUInt8=function(e,t){return e>>>=0,t||E(e,1,this.length),this[e]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(e,t){return e>>>=0,t||E(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(e,t){return e>>>=0,t||E(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(e,t){return e>>>=0,t||E(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+0x1000000*this[e+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(e,t){return e>>>=0,t||E(e,4,this.length),0x1000000*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readBigUInt64LE=P(function(e){j(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&B(e,this.length-8);let n=t+256*this[++e]+65536*this[++e]+0x1000000*this[++e],i=this[++e]+256*this[++e]+65536*this[++e]+0x1000000*r;return BigInt(n)+(BigInt(i)<<BigInt(32))}),l.prototype.readBigUInt64BE=P(function(e){j(e>>>=0,"offset");let t=this[e],r=this[e+7];(void 0===t||void 0===r)&&B(e,this.length-8);let n=0x1000000*t+65536*this[++e]+256*this[++e]+this[++e],i=0x1000000*this[++e]+65536*this[++e]+256*this[++e]+r;return(BigInt(n)<<BigInt(32))+BigInt(i)}),l.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||E(e,t,this.length);let n=this[e],i=1,s=0;for(;++s<t&&(i*=256);)n+=this[e+s]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||E(e,t,this.length);let n=t,i=1,s=this[e+--n];for(;n>0&&(i*=256);)s+=this[e+--n]*i;return s>=(i*=128)&&(s-=Math.pow(2,8*t)),s},l.prototype.readInt8=function(e,t){return(e>>>=0,t||E(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},l.prototype.readInt16LE=function(e,t){e>>>=0,t||E(e,2,this.length);let r=this[e]|this[e+1]<<8;return 32768&r?0xffff0000|r:r},l.prototype.readInt16BE=function(e,t){e>>>=0,t||E(e,2,this.length);let r=this[e+1]|this[e]<<8;return 32768&r?0xffff0000|r:r},l.prototype.readInt32LE=function(e,t){return e>>>=0,t||E(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return e>>>=0,t||E(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readBigInt64LE=P(function(e){j(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&B(e,this.length-8),(BigInt(this[e+4]+256*this[e+5]+65536*this[e+6]+(r<<24))<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+0x1000000*this[++e])}),l.prototype.readBigInt64BE=P(function(e){j(e>>>=0,"offset");let t=this[e],r=this[e+7];return(void 0===t||void 0===r)&&B(e,this.length-8),(BigInt((t<<24)+65536*this[++e]+256*this[++e]+this[++e])<<BigInt(32))+BigInt(0x1000000*this[++e]+65536*this[++e]+256*this[++e]+r)}),l.prototype.readFloatLE=function(e,t){return e>>>=0,t||E(e,4,this.length),s.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return e>>>=0,t||E(e,4,this.length),s.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return e>>>=0,t||E(e,8,this.length),s.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return e>>>=0,t||E(e,8,this.length),s.read(this,e,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(e,t,r,n){if(e*=1,t>>>=0,r>>>=0,!n){let n=Math.pow(2,8*r)-1;I(this,e,t,r,n,0)}let i=1,s=0;for(this[t]=255&e;++s<r&&(i*=256);)this[t+s]=e/i&255;return t+r},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(e,t,r,n){if(e*=1,t>>>=0,r>>>=0,!n){let n=Math.pow(2,8*r)-1;I(this,e,t,r,n,0)}let i=r-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+r},l.prototype.writeUint8=l.prototype.writeUInt8=function(e,t,r){return e*=1,t>>>=0,r||I(this,e,t,1,255,0),this[t]=255&e,t+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(e,t,r){return e*=1,t>>>=0,r||I(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(e,t,r){return e*=1,t>>>=0,r||I(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(e,t,r){return e*=1,t>>>=0,r||I(this,e,t,4,0xffffffff,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(e,t,r){return e*=1,t>>>=0,r||I(this,e,t,4,0xffffffff,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigUInt64LE=P(function(e,t=0){return S(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeBigUInt64BE=P(function(e,t=0){return v(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),l.prototype.writeIntLE=function(e,t,r,n){if(e*=1,t>>>=0,!n){let n=Math.pow(2,8*r-1);I(this,e,t,r,n-1,-n)}let i=0,s=1,o=0;for(this[t]=255&e;++i<r&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},l.prototype.writeIntBE=function(e,t,r,n){if(e*=1,t>>>=0,!n){let n=Math.pow(2,8*r-1);I(this,e,t,r,n-1,-n)}let i=r-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e*=1,t>>>=0,r||I(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e*=1,t>>>=0,r||I(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},l.prototype.writeInt16BE=function(e,t,r){return e*=1,t>>>=0,r||I(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},l.prototype.writeInt32LE=function(e,t,r){return e*=1,t>>>=0,r||I(this,e,t,4,0x7fffffff,-0x80000000),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},l.prototype.writeInt32BE=function(e,t,r){return e*=1,t>>>=0,r||I(this,e,t,4,0x7fffffff,-0x80000000),e<0&&(e=0xffffffff+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},l.prototype.writeBigInt64LE=P(function(e,t=0){return S(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeBigInt64BE=P(function(e,t=0){return v(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),l.prototype.writeFloatLE=function(e,t,r){return U(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return U(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return T(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return T(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,n){if(!l.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);let i=n-r;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,r,n):Uint8Array.prototype.set.call(e,this.subarray(r,n),t),i},l.prototype.fill=function(e,t,r,n){let i;if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===e.length){let t=e.charCodeAt(0);("utf8"===n&&t<128||"latin1"===n)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{let s=l.isBuffer(e)?e:l.from(e,n),o=s.length;if(0===o)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<r-t;++i)this[i+t]=s[i%o]}return this};let C={};function A(e,t,r){C[e]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function _(e){let t="",r=e.length,n=+("-"===e[0]);for(;r>=n+4;r-=3)t=`_${e.slice(r-3,r)}${t}`;return`${e.slice(0,r)}${t}`}function D(e,t,r,n,i,s){if(e>r||e<t){let n,i="bigint"==typeof t?"n":"";throw n=s>3?0===t||t===BigInt(0)?`>= 0${i} and < 2${i} ** ${(s+1)*8}${i}`:`>= -(2${i} ** ${(s+1)*8-1}${i}) and < 2 ** ${(s+1)*8-1}${i}`:`>= ${t}${i} and <= ${r}${i}`,new C.ERR_OUT_OF_RANGE("value",n,e)}j(i,"offset"),(void 0===n[i]||void 0===n[i+s])&&B(i,n.length-(s+1))}function j(e,t){if("number"!=typeof e)throw new C.ERR_INVALID_ARG_TYPE(t,"number",e)}function B(e,t,r){if(Math.floor(e)!==e)throw j(e,r),new C.ERR_OUT_OF_RANGE(r||"offset","an integer",e);if(t<0)throw new C.ERR_BUFFER_OUT_OF_BOUNDS;throw new C.ERR_OUT_OF_RANGE(r||"offset",`>= ${+!!r} and <= ${t}`,e)}A("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),A("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),A("ERR_OUT_OF_RANGE",function(e,t,r){let n=`The value of "${e}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>0x100000000?i=_(String(r)):"bigint"==typeof r&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=_(i)),i+="n"),n+=` It must be ${t}. Received ${i}`},RangeError);let O=/[^+/0-9A-Za-z-_]/g;function R(e,t){let r;t=t||1/0;let n=e.length,i=null,s=[];for(let o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!i){if(r>56319||o+1===n){(t-=3)>-1&&s.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&s.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;s.push(r)}else if(r<2048){if((t-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return s}function M(e){return i.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(O,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function N(e,t,r,n){let i;for(i=0;i<n&&!(i+r>=t.length)&&!(i>=e.length);++i)t[i+r]=e[i];return i}function L(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}let V=function(){let e="0123456789abcdef",t=Array(256);for(let r=0;r<16;++r){let n=16*r;for(let i=0;i<16;++i)t[n+i]=e[r]+e[i]}return t}();function P(e){return"undefined"==typeof BigInt?F:e}function F(){throw Error("BigInt not supported")}},{"9c62938f1dccc73c":"5KmMx",aceacb6a4531a9d2:"9I9TM"}],"5KmMx":[function(e,t,r,n){"use strict";r.byteLength=function(e){var t=h(e),r=t[0],n=t[1];return(r+n)*3/4-n},r.toByteArray=function(e){var t,r,n=h(e),i=n[0],a=n[1],l=new o((i+a)*3/4-a),c=0,d=a>0?i-4:i;for(r=0;r<d;r+=4)t=s[e.charCodeAt(r)]<<18|s[e.charCodeAt(r+1)]<<12|s[e.charCodeAt(r+2)]<<6|s[e.charCodeAt(r+3)],l[c++]=t>>16&255,l[c++]=t>>8&255,l[c++]=255&t;return 2===a&&(t=s[e.charCodeAt(r)]<<2|s[e.charCodeAt(r+1)]>>4,l[c++]=255&t),1===a&&(t=s[e.charCodeAt(r)]<<10|s[e.charCodeAt(r+1)]<<4|s[e.charCodeAt(r+2)]>>2,l[c++]=t>>8&255,l[c++]=255&t),l},r.fromByteArray=function(e){for(var t,r=e.length,n=r%3,s=[],o=0,a=r-n;o<a;o+=16383)s.push(function(e,t,r){for(var n,s=[],o=t;o<r;o+=3)n=(e[o]<<16&0xff0000)+(e[o+1]<<8&65280)+(255&e[o+2]),s.push(i[n>>18&63]+i[n>>12&63]+i[n>>6&63]+i[63&n]);return s.join("")}(e,o,o+16383>a?a:o+16383));return 1===n?s.push(i[(t=e[r-1])>>2]+i[t<<4&63]+"=="):2===n&&s.push(i[(t=(e[r-2]<<8)+e[r-1])>>10]+i[t>>4&63]+i[t<<2&63]+"="),s.join("")};for(var i=[],s=[],o="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,c=a.length;l<c;++l)i[l]=a[l],s[a.charCodeAt(l)]=l;function h(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63},{}],"9I9TM":[function(e,t,r,n){r.read=function(e,t,r,n,i){var s,o,a=8*i-n-1,l=(1<<a)-1,c=l>>1,h=-7,d=r?i-1:0,u=r?-1:1,f=e[t+d];for(d+=u,s=f&(1<<-h)-1,f>>=-h,h+=a;h>0;s=256*s+e[t+d],d+=u,h-=8);for(o=s&(1<<-h)-1,s>>=-h,h+=n;h>0;o=256*o+e[t+d],d+=u,h-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,n),s-=c}return(f?-1:1)*o*Math.pow(2,s-n)},r.write=function(e,t,r,n,i,s){var o,a,l,c=8*s-i-1,h=(1<<c)-1,d=h>>1,u=5960464477539062e-23*(23===i),f=n?0:s-1,p=n?1:-1,g=+(t<0||0===t&&1/t<0);for(isNaN(t=Math.abs(t))||t===1/0?(a=+!!isNaN(t),o=h):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),o+d>=1?t+=u/l:t+=u*Math.pow(2,1-d),t*l>=2&&(o++,l/=2),o+d>=h?(a=0,o=h):o+d>=1?(a=(t*l-1)*Math.pow(2,i),o+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[r+f]=255&a,f+=p,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;e[r+f]=255&o,f+=p,o/=256,c-=8);e[r+f-p]|=128*g}},{}],"8YiHn":[function(e,t,r,n){let i;var s=e("@parcel/transformer-js/src/esmodule-helpers.js");s.defineInteropFlag(r),s.export(r,"isNode",()=>u),s.export(r,"isBrowser",()=>f),s.export(r,"isMac",()=>p),s.export(r,"hasParam",()=>y),s.export(r,"getParam",()=>w),s.export(r,"getVariable",()=>x),s.export(r,"getConf",()=>b),s.export(r,"ensureConf",()=>E),s.export(r,"hasConf",()=>I),s.export(r,"production",()=>S),s.export(r,"supportsColor",()=>v);var o=e("./map.js"),a=e("./string.js"),l=e("./conditions.js"),c=e("./storage.js"),h=e("./function.js"),d=e("2cfb8bcef1022e2a");let u=!1,f="undefined"!=typeof window&&"undefined"!=typeof document&&!u,p="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),g=[],m=()=>{if(void 0===i){if(u){i=o.create();let e=d.argv,t=null;for(let r=0;r<e.length;r++){let n=e[r];"-"===n[0]?(null!==t&&i.set(t,""),t=n):null!==t?(i.set(t,n),t=null):g.push(n)}null!==t&&i.set(t,"")}else"object"==typeof location?(i=o.create(),(location.search||"?").slice(1).split("&").forEach(e=>{if(0!==e.length){let[t,r]=e.split("=");i.set(`--${a.fromCamelCase(t,"-")}`,r),i.set(`-${a.fromCamelCase(t,"-")}`,r)}})):i=o.create()}return i},y=e=>m().has(e),w=(e,t)=>m().get(e)||t,x=e=>u?l.undefinedToNull(d.env[e.toUpperCase().replaceAll("-","_")]):l.undefinedToNull(c.varStorage.getItem(e)),b=e=>m().get("--"+e)||x(e),E=e=>{let t=b(e);if(null==t)throw Error(`Expected configuration "${e.toUpperCase().replaceAll("-","_")}"`);return t},I=e=>y("--"+e)||null!==x(e),S=I("production"),v=u&&h.isOneOf(void 0,["true","1","2"])||!y("--no-colors")&&!I("no-color")&&(!u||d.stdout.isTTY)&&(!u||y("--color")||null!==x("COLORTERM")||(x("TERM")||"").includes("color"))},{"2cfb8bcef1022e2a":"eFuRA","./map.js":"gsPjK","./string.js":"l5ap6","./conditions.js":"4BJf1","./storage.js":"iLeaV","./function.js":"5S3AJ","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],eFuRA:[function(e,t,r,n){var i,s,o,a=t.exports={};function l(){throw Error("setTimeout has not been defined")}function c(){throw Error("clearTimeout has not been defined")}function h(e){if(i===setTimeout)return setTimeout(e,0);if((i===l||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:l}catch(e){i=l}try{s="function"==typeof clearTimeout?clearTimeout:c}catch(e){s=c}}();var d=[],u=!1,f=-1;function p(){u&&o&&(u=!1,o.length?d=o.concat(d):f=-1,d.length&&g())}function g(){if(!u){var e=h(p);u=!0;for(var t=d.length;t;){for(o=d,d=[];++f<t;)o&&o[f].run();f=-1,t=d.length}o=null,u=!1,function(e){if(s===clearTimeout)return clearTimeout(e);if((s===c||!s)&&clearTimeout)return s=clearTimeout,clearTimeout(e);try{s(e)}catch(t){try{return s.call(null,e)}catch(t){return s.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function y(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new m(e,t)),1!==d.length||u||h(g)},m.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=y,a.addListener=y,a.once=y,a.off=y,a.removeListener=y,a.removeAllListeners=y,a.emit=y,a.prependListener=y,a.prependOnceListener=y,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}},{}],"4BJf1":[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"undefinedToNull",()=>s);let s=e=>void 0===e?null:e},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],iLeaV:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"varStorage",()=>a),i.export(r,"onChange",()=>l),i.export(r,"offChange",()=>c);let s=new class{constructor(){this.map=new Map}setItem(e,t){this.map.set(e,t)}getItem(e){return this.map.get(e)}},o=!0;try{"undefined"!=typeof localStorage&&localStorage&&(s=localStorage,o=!1)}catch(e){}let a=s,l=e=>o||addEventListener("storage",e),c=e=>o||removeEventListener("storage",e)},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],"5S3AJ":[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"callAll",()=>a),i.export(r,"nop",()=>l),i.export(r,"apply",()=>c),i.export(r,"id",()=>h),i.export(r,"equalityStrict",()=>d),i.export(r,"equalityFlat",()=>u),i.export(r,"equalityDeep",()=>f),i.export(r,"isOneOf",()=>p),i.export(r,"isArray",()=>g),i.export(r,"isString",()=>m),i.export(r,"isNumber",()=>y),i.export(r,"is",()=>w),i.export(r,"isTemplate",()=>x);var s=e("./array.js"),o=e("./object.js");let a=(e,t,r=0)=>{try{for(;r<e.length;r++)e[r](...t)}finally{r<e.length&&a(e,t,r+1)}},l=()=>{},c=e=>e(),h=e=>e,d=(e,t)=>e===t,u=(e,t)=>e===t||null!=e&&null!=t&&e.constructor===t.constructor&&(s.isArray(e)&&s.equalFlat(e,t)||"object"==typeof e&&o.equalFlat(e,t)),f=(e,t)=>{if(null==e||null==t)return d(e,t);if(e.constructor!==t.constructor)return!1;if(e===t)return!0;switch(e.constructor){case ArrayBuffer:e=new Uint8Array(e),t=new Uint8Array(t);case Uint8Array:if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;break;case Set:if(e.size!==t.size)return!1;for(let r of e)if(!t.has(r))return!1;break;case Map:if(e.size!==t.size)return!1;for(let r of e.keys())if(!t.has(r)||!f(e.get(r),t.get(r)))return!1;break;case Object:if(o.length(e)!==o.length(t))return!1;for(let r in e)if(!o.hasProperty(e,r)||!f(e[r],t[r]))return!1;break;case Array:if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(!f(e[r],t[r]))return!1;break;default:return!1}return!0},p=(e,t)=>t.includes(e),g=s.isArray,m=e=>e&&e.constructor===String,y=e=>null!=e&&e.constructor===Number,w=(e,t)=>e&&e.constructor===t,x=e=>t=>t&&t.constructor===e},{"./array.js":"kcR8B","./object.js":"eUSla","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],eUSla:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"create",()=>s),i.export(r,"assign",()=>o),i.export(r,"keys",()=>a),i.export(r,"forEach",()=>l),i.export(r,"map",()=>c),i.export(r,"length",()=>h),i.export(r,"size",()=>d),i.export(r,"some",()=>u),i.export(r,"isEmpty",()=>f),i.export(r,"every",()=>p),i.export(r,"hasProperty",()=>g),i.export(r,"equalFlat",()=>m),i.export(r,"freeze",()=>y),i.export(r,"deepFreeze",()=>w);let s=()=>Object.create(null),o=Object.assign,a=Object.keys,l=(e,t)=>{for(let r in e)t(e[r],r)},c=(e,t)=>{let r=[];for(let n in e)r.push(t(e[n],n));return r},h=e=>a(e).length,d=e=>a(e).length,u=(e,t)=>{for(let r in e)if(t(e[r],r))return!0;return!1},f=e=>{for(let t in e)return!1;return!0},p=(e,t)=>{for(let r in e)if(!t(e[r],r))return!1;return!0},g=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),m=(e,t)=>e===t||d(e)===d(t)&&p(e,(e,r)=>(void 0!==e||g(t,r))&&t[r]===e),y=Object.freeze,w=e=>{for(let t in e){let r=e[t];("object"==typeof r||"function"==typeof r)&&w(e[t])}return y(e)}},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],blwZs:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"BOLD",()=>f.BOLD),i.export(r,"UNBOLD",()=>f.UNBOLD),i.export(r,"BLUE",()=>f.BLUE),i.export(r,"GREY",()=>f.GREY),i.export(r,"GREEN",()=>f.GREEN),i.export(r,"RED",()=>f.RED),i.export(r,"PURPLE",()=>f.PURPLE),i.export(r,"ORANGE",()=>f.ORANGE),i.export(r,"UNCOLOR",()=>f.UNCOLOR),i.export(r,"print",()=>m),i.export(r,"warn",()=>y),i.export(r,"printError",()=>w),i.export(r,"printImg",()=>x),i.export(r,"printImgBase64",()=>b),i.export(r,"group",()=>E),i.export(r,"groupCollapsed",()=>I),i.export(r,"groupEnd",()=>S),i.export(r,"printDom",()=>v),i.export(r,"printCanvas",()=>k),i.export(r,"vconsoles",()=>U),i.export(r,"VConsole",()=>A),i.export(r,"createVConsole",()=>_),i.export(r,"createModuleLogger",()=>D);var s=e("./environment.js"),o=e("./set.js"),a=e("./pair.js"),l=e("./dom.js"),c=e("./json.js"),h=e("./map.js"),d=e("./eventloop.js"),u=e("./math.js"),f=e("./logging.common.js");let p={[f.BOLD]:a.create("font-weight","bold"),[f.UNBOLD]:a.create("font-weight","normal"),[f.BLUE]:a.create("color","blue"),[f.GREEN]:a.create("color","green"),[f.GREY]:a.create("color","grey"),[f.RED]:a.create("color","red"),[f.PURPLE]:a.create("color","purple"),[f.ORANGE]:a.create("color","orange"),[f.UNCOLOR]:a.create("color","black")},g=s.supportsColor?e=>{1===e.length&&e[0]?.constructor===Function&&(e=e[0]());let t=[],r=[],n=h.create(),i=[],s=0;for(;s<e.length;s++){let i=e[s],o=p[i];if(void 0!==o)n.set(o.left,o.right);else{if(void 0===i)break;if(i.constructor===String||i.constructor===Number){let e=l.mapToStyleString(n);s>0||e.length>0?(t.push("%c"+i),r.push(e)):t.push(i)}else break}}for(s>0&&(i=r).unshift(t.join(""));s<e.length;s++){let t=e[s];t instanceof Symbol||i.push(t)}return i}:f.computeNoColorLoggingArgs,m=(...e)=>{console.log(...g(e)),U.forEach(t=>t.print(e))},y=(...e)=>{console.warn(...g(e)),e.unshift(f.ORANGE),U.forEach(t=>t.print(e))},w=e=>{console.error(e),U.forEach(t=>t.printError(e))},x=(e,t)=>{s.isBrowser&&console.log("%c                      ",`font-size: ${t}px; background-size: contain; background-repeat: no-repeat; background-image: url(${e})`),U.forEach(r=>r.printImg(e,t))},b=(e,t)=>x(`data:image/gif;base64,${e}`,t),E=(...e)=>{console.group(...g(e)),U.forEach(t=>t.group(e))},I=(...e)=>{console.groupCollapsed(...g(e)),U.forEach(t=>t.groupCollapsed(e))},S=()=>{console.groupEnd(),U.forEach(e=>e.groupEnd())},v=e=>U.forEach(t=>t.printDom(e())),k=(e,t)=>x(e.toDataURL(),t),U=o.create(),T=e=>{let t=[],r=new Map,n=0;for(;n<e.length;n++){let i=e[n],s=p[i];if(void 0!==s)r.set(s.left,s.right);else if(void 0===i&&(i="undefined "),i.constructor===String||i.constructor===Number){let e=l.element("span",[a.create("style",l.mapToStyleString(r))],[l.text(i.toString())]);""===e.innerHTML&&(e.innerHTML="&nbsp;"),t.push(e)}else break}for(;n<e.length;n++){let r=e[n];r instanceof Symbol||(r.constructor!==String&&r.constructor!==Number&&(r=" "+c.stringify(r)+" "),t.push(l.element("span",[],[l.text(r)])))}return t},C="font-family:monospace;border-bottom:1px solid #e2e2e2;padding:2px;";class A{constructor(e){this.dom=e,this.ccontainer=this.dom,this.depth=0,U.add(this)}group(e,t=!1){d.enqueue(()=>{let r=l.element("span",[a.create("hidden",t),a.create("style","color:grey;font-size:120%;")],[l.text("")]),n=l.element("span",[a.create("hidden",!t),a.create("style","color:grey;font-size:125%;")],[l.text("")]),i=l.element("div",[a.create("style",`${C};padding-left:${10*this.depth}px`)],[r,n,l.text(" ")].concat(T(e))),s=l.element("div",[a.create("hidden",t)]),o=l.element("div",[],[i,s]);l.append(this.ccontainer,[o]),this.ccontainer=s,this.depth++,l.addEventListener(i,"click",e=>{s.toggleAttribute("hidden"),r.toggleAttribute("hidden"),n.toggleAttribute("hidden")})})}groupCollapsed(e){this.group(e,!0)}groupEnd(){d.enqueue(()=>{this.depth>0&&(this.depth--,this.ccontainer=this.ccontainer.parentElement.parentElement)})}print(e){d.enqueue(()=>{l.append(this.ccontainer,[l.element("div",[a.create("style",`${C};padding-left:${10*this.depth}px`)],T(e))])})}printError(e){this.print([f.RED,f.BOLD,e.toString()])}printImg(e,t){d.enqueue(()=>{l.append(this.ccontainer,[l.element("img",[a.create("src",e),a.create("height",`${u.round(1.5*t)}px`)])])})}printDom(e){d.enqueue(()=>{l.append(this.ccontainer,[e])})}destroy(){d.enqueue(()=>{U.delete(this)})}}let _=e=>new A(e),D=e=>f.createModuleLogger(m,e)},{"./environment.js":"8YiHn","./set.js":"5gNQm","./pair.js":"iKw8x","./dom.js":"dpUjQ","./json.js":"jGOoC","./map.js":"gsPjK","./eventloop.js":"hLEBe","./math.js":"icsnC","./logging.common.js":"6FeDb","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],iKw8x:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"Pair",()=>s),i.export(r,"create",()=>o),i.export(r,"createReversed",()=>a),i.export(r,"forEach",()=>l),i.export(r,"map",()=>c);class s{constructor(e,t){this.left=e,this.right=t}}let o=(e,t)=>new s(e,t),a=(e,t)=>new s(t,e),l=(e,t)=>e.forEach(e=>t(e.left,e.right)),c=(e,t)=>e.map(e=>t(e.left,e.right))},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],dpUjQ:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"doc",()=>a),i.export(r,"createElement",()=>l),i.export(r,"createDocumentFragment",()=>c),i.export(r,"createTextNode",()=>h),i.export(r,"domParser",()=>d),i.export(r,"emitCustomEvent",()=>u),i.export(r,"setAttributes",()=>f),i.export(r,"setAttributesMap",()=>p),i.export(r,"fragment",()=>g),i.export(r,"append",()=>m),i.export(r,"remove",()=>y),i.export(r,"addEventListener",()=>w),i.export(r,"removeEventListener",()=>x),i.export(r,"addEventListeners",()=>b),i.export(r,"removeEventListeners",()=>E),i.export(r,"element",()=>I),i.export(r,"canvas",()=>S),i.export(r,"text",()=>v),i.export(r,"pairToStyleString",()=>k),i.export(r,"pairsToStyleString",()=>U),i.export(r,"mapToStyleString",()=>T),i.export(r,"querySelector",()=>C),i.export(r,"querySelectorAll",()=>A),i.export(r,"getElementById",()=>_),i.export(r,"parseFragment",()=>j),i.export(r,"parseElement",()=>B),i.export(r,"replaceWith",()=>O),i.export(r,"insertBefore",()=>R),i.export(r,"appendChild",()=>M),i.export(r,"ELEMENT_NODE",()=>N),i.export(r,"TEXT_NODE",()=>L),i.export(r,"CDATA_SECTION_NODE",()=>V),i.export(r,"COMMENT_NODE",()=>P),i.export(r,"DOCUMENT_NODE",()=>F),i.export(r,"DOCUMENT_TYPE_NODE",()=>q),i.export(r,"DOCUMENT_FRAGMENT_NODE",()=>$),i.export(r,"checkNodeType",()=>z),i.export(r,"isParentOf",()=>H);var s=e("./pair.js"),o=e("./map.js");let a="undefined"!=typeof document?document:{},l=e=>a.createElement(e),c=()=>a.createDocumentFragment(),h=e=>a.createTextNode(e),d="undefined"!=typeof DOMParser?new DOMParser:null,u=(e,t,r)=>e.dispatchEvent(new CustomEvent(t,r)),f=(e,t)=>(s.forEach(t,(t,r)=>{!1===r?e.removeAttribute(t):!0===r?e.setAttribute(t,""):e.setAttribute(t,r)}),e),p=(e,t)=>(t.forEach((t,r)=>{e.setAttribute(r,t)}),e),g=e=>{let t=c();for(let r=0;r<e.length;r++)M(t,e[r]);return t},m=(e,t)=>(M(e,g(t)),e),y=e=>e.remove(),w=(e,t,r)=>e.addEventListener(t,r),x=(e,t,r)=>e.removeEventListener(t,r),b=(e,t)=>(s.forEach(t,(t,r)=>w(e,t,r)),e),E=(e,t)=>(s.forEach(t,(t,r)=>x(e,t,r)),e),I=(e,t=[],r=[])=>m(f(l(e),t),r),S=(e,t)=>{let r=l("canvas");return r.height=t,r.width=e,r},v=h,k=e=>`${e.left}:${e.right};`,U=e=>e.map(k).join(""),T=e=>o.map(e,(e,t)=>`${t}:${e};`).join(""),C=(e,t)=>e.querySelector(t),A=(e,t)=>e.querySelectorAll(t),_=e=>a.getElementById(e),D=e=>d.parseFromString(`<html><body>${e}</body></html>`,"text/html").body,j=e=>g(D(e).childNodes),B=e=>D(e).firstElementChild,O=(e,t)=>e.replaceWith(t),R=(e,t,r)=>e.insertBefore(t,r),M=(e,t)=>e.appendChild(t),N=a.ELEMENT_NODE,L=a.TEXT_NODE,V=a.CDATA_SECTION_NODE,P=a.COMMENT_NODE,F=a.DOCUMENT_NODE,q=a.DOCUMENT_TYPE_NODE,$=a.DOCUMENT_FRAGMENT_NODE,z=(e,t)=>e.nodeType===t,H=(e,t)=>{let r=t.parentNode;for(;r&&r!==e;)r=r.parentNode;return r===e}},{"./pair.js":"iKw8x","./map.js":"gsPjK","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],jGOoC:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"stringify",()=>s),i.export(r,"parse",()=>o);let s=JSON.stringify,o=JSON.parse},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],hLEBe:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"enqueue",()=>a),i.export(r,"timeout",()=>h),i.export(r,"interval",()=>u),i.export(r,"Animation",()=>f),i.export(r,"animationFrame",()=>p),i.export(r,"idleCallback",()=>m),i.export(r,"createDebouncer",()=>y);let s=[],o=()=>{for(let e=0;e<s.length;e++)s[e]();s=[]},a=e=>{s.push(e),1===s.length&&setTimeout(o,0)},l=e=>class{constructor(e){this._=e}destroy(){e(this._)}},c=l(clearTimeout),h=(e,t)=>new c(setTimeout(t,e)),d=l(clearInterval),u=(e,t)=>new d(setInterval(t,e)),f=l(e=>"undefined"!=typeof requestAnimationFrame&&cancelAnimationFrame(e)),p=e=>"undefined"==typeof requestAnimationFrame?h(0,e):new f(requestAnimationFrame(e)),g=l(e=>"undefined"!=typeof cancelIdleCallback&&cancelIdleCallback(e)),m=e=>"undefined"!=typeof requestIdleCallback?new g(requestIdleCallback(e)):h(1e3,e),y=e=>{let t=-1;return r=>{clearTimeout(t),r&&(t=setTimeout(r,e))}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],"6FeDb":[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"BOLD",()=>h),i.export(r,"UNBOLD",()=>d),i.export(r,"BLUE",()=>u),i.export(r,"GREY",()=>f),i.export(r,"GREEN",()=>p),i.export(r,"RED",()=>g),i.export(r,"PURPLE",()=>m),i.export(r,"ORANGE",()=>y),i.export(r,"UNCOLOR",()=>w),i.export(r,"computeNoColorLoggingArgs",()=>x),i.export(r,"createModuleLogger",()=>S);var s=e("./symbol.js"),o=e("./time.js"),a=e("./environment.js"),l=e("./function.js"),c=e("./json.js");let h=s.create(),d=s.create(),u=s.create(),f=s.create(),p=s.create(),g=s.create(),m=s.create(),y=s.create(),w=s.create(),x=e=>{1===e.length&&e[0]?.constructor===Function&&(e=e[0]());let t=[],r=[],n=0;for(;n<e.length;n++){let r=e[n];if(void 0===r)break;if(r.constructor===String||r.constructor===Number)t.push(r);else if(r.constructor===Object)break}for(n>0&&r.push(t.join(""));n<e.length;n++){let t=e[n];t instanceof Symbol||r.push(t)}return r},b=[p,m,y,u],E=0,I=o.getUnixTime(),S=(e,t)=>{let r=b[E],n=a.getVariable("log"),i=null!==n&&("*"===n||"true"===n||RegExp(n,"gi").test(t));return E=(E+1)%b.length,t+=": ",i?(...n)=>{1===n.length&&n[0]?.constructor===Function&&(n=n[0]());let i=o.getUnixTime(),s=i-I;I=i,e(r,t,w,...n.map(e=>{switch(null!=e&&e.constructor===Uint8Array&&(e=Array.from(e)),typeof e){case"string":case"symbol":return e;default:return c.stringify(e)}}),r," +"+s+"ms")}:l.nop}},{"./symbol.js":"b8AcA","./time.js":"b6cMp","./environment.js":"8YiHn","./function.js":"5S3AJ","./json.js":"jGOoC","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],b8AcA:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"create",()=>s),i.export(r,"isSymbol",()=>o);let s=Symbol,o=e=>"symbol"==typeof e},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],dOXgT:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"mapIterator",()=>s),i.export(r,"createIterator",()=>o),i.export(r,"iteratorFilter",()=>a),i.export(r,"iteratorMap",()=>l);let s=(e,t)=>({[Symbol.iterator](){return this},next(){let r=e.next();return{value:r.done?void 0:t(r.value),done:r.done}}}),o=e=>({[Symbol.iterator](){return this},next:e}),a=(e,t)=>o(()=>{let r;do r=e.next();while(!r.done&&!t(r.value))return r}),l=(e,t)=>o(()=>{let{done:r,value:n}=e.next();return{done:r,value:r?void 0:t(n)}})},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],jCq4q:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"Packr",()=>s.Packr),i.export(r,"Encoder",()=>s.Encoder),i.export(r,"addExtension",()=>s.addExtension),i.export(r,"pack",()=>s.pack),i.export(r,"encode",()=>s.encode),i.export(r,"NEVER",()=>s.NEVER),i.export(r,"ALWAYS",()=>s.ALWAYS),i.export(r,"DECIMAL_ROUND",()=>s.DECIMAL_ROUND),i.export(r,"DECIMAL_FIT",()=>s.DECIMAL_FIT),i.export(r,"REUSE_BUFFER_MODE",()=>s.REUSE_BUFFER_MODE),i.export(r,"RESET_BUFFER_MODE",()=>s.RESET_BUFFER_MODE),i.export(r,"RESERVE_START_SPACE",()=>s.RESERVE_START_SPACE),i.export(r,"Unpackr",()=>o.Unpackr),i.export(r,"Decoder",()=>o.Decoder),i.export(r,"C1",()=>o.C1),i.export(r,"unpack",()=>o.unpack),i.export(r,"unpackMultiple",()=>o.unpackMultiple),i.export(r,"decode",()=>o.decode),i.export(r,"FLOAT32_OPTIONS",()=>o.FLOAT32_OPTIONS),i.export(r,"clearSource",()=>o.clearSource),i.export(r,"roundFloat32",()=>o.roundFloat32),i.export(r,"isNativeAccelerationEnabled",()=>o.isNativeAccelerationEnabled),i.export(r,"decodeIter",()=>a.decodeIter),i.export(r,"encodeIter",()=>a.encodeIter),i.export(r,"useRecords",()=>l),i.export(r,"mapsAsObjects",()=>c);var s=e("./pack.js"),o=e("./unpack.js"),a=e("./iterators.js");let l=!1,c=!0},{"./pack.js":"1Gqa1","./unpack.js":"34MFG","./iterators.js":"737vE","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],"1Gqa1":[function(e,t,r,n){let i,s,o,a,l,c,h,d;var u=e("@parcel/transformer-js/src/esmodule-helpers.js");u.defineInteropFlag(r),u.export(r,"FLOAT32_OPTIONS",()=>f.FLOAT32_OPTIONS),u.export(r,"RECORD_SYMBOL",()=>I),u.export(r,"Packr",()=>S),u.export(r,"addExtension",()=>T),u.export(r,"setWriteStructSlots",()=>A),u.export(r,"pack",()=>D),u.export(r,"encode",()=>j),u.export(r,"Encoder",()=>B),u.export(r,"NEVER",()=>O),u.export(r,"ALWAYS",()=>R),u.export(r,"DECIMAL_ROUND",()=>M),u.export(r,"DECIMAL_FIT",()=>N),u.export(r,"REUSE_BUFFER_MODE",()=>L),u.export(r,"RESET_BUFFER_MODE",()=>V),u.export(r,"RESERVE_START_SPACE",()=>P);var f=e("./unpack.js"),p=e("d39b59f28483d155").Buffer;try{i=new TextEncoder}catch(e){}let g=void 0!==p,m=g?function(e){return p.allocUnsafeSlow(e)}:Uint8Array,y=g?p:Uint8Array,w=g?0x100000000:0x7fd00000,x=0,b=null,E=/[\u0080-\uFFFF]/,I=Symbol("record-id");class S extends f.Unpackr{constructor(e){let t,r,n,u;super(e),this.offset=0;let p=y.prototype.utf8Write?function(e,t){return a.utf8Write(e,t,a.byteLength-t)}:!!i&&!!i.encodeInto&&function(e,t){return i.encodeInto(e,a.subarray(t)).written},g=this;e||(e={});let S=e&&e.sequential,v=e.structures||e.saveStructures,k=e.maxSharedStructures;if(null==k&&(k=32*!!v),k>8160)throw Error("Maximum maxSharedStructure is 8160");e.structuredClone&&void 0==e.moreTypes&&(this.moreTypes=!0);let T=e.maxOwnStructures;null==T&&(T=v?32:64),this.structures||!1==e.useRecords||(this.structures=[]);let A=k>32||T+k>64,_=k+64,D=k+T+64;if(D>8256)throw Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let j=[],B=0,O=0;this.pack=this.encode=function(e,i){let s;if(a||(c=(a=new m(8192)).dataView||(a.dataView=new DataView(a.buffer,0,8192)),x=0),(h=a.length-10)-x<2048?(c=(a=new m(a.length)).dataView||(a.dataView=new DataView(a.buffer,0,a.length)),h=a.length-10,x=0):x=x+7&0x7ffffff8,t=x,i&P&&(x+=255&i),u=g.structuredClone?new Map:null,g.bundleStrings&&"string"!=typeof e?(b=[]).size=1/0:b=null,n=g.structures){n.uninitialized&&(n=g._mergeStructures(g.getStructures()));let e=n.sharedLength||0;if(e>k)throw Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+n.sharedLength);if(!n.transitions){n.transitions=Object.create(null);for(let t=0;t<e;t++){let e=n[t];if(!e)continue;let r,i=n.transitions;for(let t=0,n=e.length;t<n;t++){let n=e[t];(r=i[n])||(r=i[n]=Object.create(null)),i=r}i[I]=t+64}this.lastNamedStructuresLength=e}S||(n.nextId=e+64)}r&&(r=!1);try{g.randomAccessStructure&&e&&e.constructor&&e.constructor===Object?Y(e):N(e);let r=b;if(b&&U(t,N,0),u&&u.idsToInsert){let e=u.idsToInsert.sort((e,t)=>e.offset>t.offset?1:-1),n=e.length,i=-1;for(;r&&n>0;){let s=e[--n].offset+t;s<r.stringsPosition+t&&-1===i&&(i=0),s>r.position+t?i>=0&&(i+=6):(i>=0&&(c.setUint32(r.position+t,c.getUint32(r.position+t)+i),i=-1),r=r.previous,n++)}i>=0&&r&&c.setUint32(r.position+t,c.getUint32(r.position+t)+i),(x+=6*e.length)>h&&H(x),g.offset=x;let s=function(e,t){let r,n=6*t.length,i=e.length-n;for(;r=t.pop();){let t=r.offset,s=r.id;e.copyWithin(t+n,t,i);let o=t+(n-=6);e[o++]=214,e[o++]=105,e[o++]=s>>24,e[o++]=s>>16&255,e[o++]=s>>8&255,e[o++]=255&s,i=t}return e}(a.subarray(t,x),e);return u=null,s}if(g.offset=x,i&L)return a.start=t,a.end=x,a;return a.subarray(t,x)}catch(e){throw s=e,e}finally{if(n&&(R(),r&&g.saveStructures)){let r=n.sharedLength||0,o=a.subarray(t,x),l=C(n,g);if(!s){if(!1===g.saveStructures(l,l.isCompatible))return g.pack(e,i);return g.lastNamedStructuresLength=r,a.length>0x40000000&&(a=null),o}}a.length>0x40000000&&(a=null),i&V&&(x=t)}};let R=()=>{O<10&&O++;let e=n.sharedLength||0;if(n.length>e&&!S&&(n.length=e),B>1e4)n.transitions=null,O=0,B=0,j.length>0&&(j=[]);else if(j.length>0&&!S){for(let e=0,t=j.length;e<t;e++)j[e][I]=0;j=[]}},M=e=>{var t=e.length;t<16?a[x++]=144|t:t<65536?(a[x++]=220,a[x++]=t>>8,a[x++]=255&t):(a[x++]=221,c.setUint32(x,t),x+=4);for(let r=0;r<t;r++)N(e[r])},N=e=>{x>h&&(a=H(x));var r,n=typeof e;if("string"===n){let n,i=e.length;if(b&&i>=4&&i<4096){if((b.size+=i)>21760){let e,r,n=(b[0]?3*b[0].length+b[1].length:0)+10;x+n>h&&(a=H(x+n)),b.position?(r=b,a[x]=200,x+=3,a[x++]=98,e=x-t,x+=4,U(t,N,0),c.setUint16(e+t-3,x-t-e)):(a[x++]=214,a[x++]=98,e=x-t,x+=4),(b=["",""]).previous=r,b.size=0,b.position=e}let r=E.test(e);b[+!r]+=e,a[x++]=193,N(r?-i:i);return}n=i<32?1:i<256?2:i<65536?3:5;let s=3*i;if(x+s>h&&(a=H(x+s)),i<64||!p){let t,s,o,l=x+n;for(t=0;t<i;t++)(s=e.charCodeAt(t))<128?a[l++]=s:(s<2048?a[l++]=s>>6|192:((64512&s)==55296&&(64512&(o=e.charCodeAt(t+1)))==56320?(s=65536+((1023&s)<<10)+(1023&o),t++,a[l++]=s>>18|240,a[l++]=s>>12&63|128):a[l++]=s>>12|224,a[l++]=s>>6&63|128),a[l++]=63&s|128);r=l-x-n}else r=p(e,x+n);r<32?a[x++]=160|r:r<256?(n<2&&a.copyWithin(x+2,x+1,x+1+r),a[x++]=217,a[x++]=r):r<65536?(n<3&&a.copyWithin(x+3,x+2,x+2+r),a[x++]=218,a[x++]=r>>8,a[x++]=255&r):(n<5&&a.copyWithin(x+5,x+3,x+3+r),a[x++]=219,c.setUint32(x,r),x+=4),x+=r}else if("number"===n){if(e>>>0===e)e<32||e<128&&!1===this.useRecords||e<64&&!this.randomAccessStructure?a[x++]=e:e<256?(a[x++]=204,a[x++]=e):e<65536?(a[x++]=205,a[x++]=e>>8,a[x++]=255&e):(a[x++]=206,c.setUint32(x,e),x+=4);else if(e>>0===e)e>=-32?a[x++]=256+e:e>=-128?(a[x++]=208,a[x++]=e+256):e>=-32768?(a[x++]=209,c.setInt16(x,e),x+=2):(a[x++]=210,c.setInt32(x,e),x+=4);else{let t;if((t=this.useFloat32)>0&&e<0x100000000&&e>=-0x80000000){let r;if(a[x++]=202,c.setFloat32(x,e),t<4||(r=e*f.mult10[(127&a[x])<<1|a[x+1]>>7])>>0===r){x+=4;return}x--}a[x++]=203,c.setFloat64(x,e),x+=8}}else if("object"===n||"function"===n){if(e){if(u){let r=u.get(e);if(r){r.id||(r.id=(u.idsToInsert||(u.idsToInsert=[])).push(r)),a[x++]=214,a[x++]=112,c.setUint32(x,r.id),x+=4;return}u.set(e,{offset:x-t})}let i=e.constructor;if(i===Object)z(e);else if(i===Array)M(e);else if(i===Map){if(this.mapAsEmptyObject)a[x++]=128;else for(let[t,n]of((r=e.size)<16?a[x++]=128|r:r<65536?(a[x++]=222,a[x++]=r>>8,a[x++]=255&r):(a[x++]=223,c.setUint32(x,r),x+=4),e))N(t),N(n)}else{for(let t=0,r=s.length;t<r;t++)if(e instanceof o[t]){let r,n=s[t];if(n.write){n.type&&(a[x++]=212,a[x++]=n.type,a[x++]=0);let t=n.write.call(this,e);t===e?Array.isArray(e)?M(e):z(e):N(t);return}let i=a,o=c,l=x;a=null;try{r=n.pack.call(this,e,e=>(a=i,i=null,(x+=e)>h&&H(x),{target:a,targetView:c,position:x-e}),N)}finally{i&&(a=i,c=o,x=l,h=a.length-10)}r&&(r.length+x>h&&H(r.length+x),x=function(e,t,r,n){let i=e.length;switch(i){case 1:t[r++]=212;break;case 2:t[r++]=213;break;case 4:t[r++]=214;break;case 8:t[r++]=215;break;case 16:t[r++]=216;break;default:i<256?(t[r++]=199,t[r++]=i):(i<65536?(t[r++]=200,t[r++]=i>>8):(t[r++]=201,t[r++]=i>>24,t[r++]=i>>16&255,t[r++]=i>>8&255),t[r++]=255&i)}return t[r++]=n,t.set(e,r),r+=i}(r,a,x,n.type));return}if(Array.isArray(e))M(e);else{if(e.toJSON){let t=e.toJSON();if(t!==e)return N(t)}if("function"===n)return N(this.writeFunction&&this.writeFunction(e));z(e)}}}else a[x++]=192}else if("boolean"===n)a[x++]=e?195:194;else if("bigint"===n){if(e<BigInt(1)<<BigInt(63)&&e>=-(BigInt(1)<<BigInt(63)))a[x++]=211,c.setBigInt64(x,e);else if(e<BigInt(1)<<BigInt(64)&&e>0)a[x++]=207,c.setBigUint64(x,e);else if(this.largeBigIntToFloat)a[x++]=203,c.setFloat64(x,Number(e));else if(this.largeBigIntToString)return N(e.toString());else if(this.useBigIntExtension&&e<BigInt(2)**BigInt(1023)&&e>-(BigInt(2)**BigInt(1023))){let t;a[x++]=199,x++,a[x++]=66;let r=[];do{let n=e&BigInt(255);t=(n&BigInt(128))===(e<BigInt(0)?BigInt(128):BigInt(0)),r.push(n),e>>=BigInt(8)}while(!((e===BigInt(0)||e===BigInt(-1))&&t))a[x-2]=r.length;for(let e=r.length;e>0;)a[x++]=Number(r[--e]);return}else throw RangeError(e+" was too large to fit in MessagePack 64-bit integer format, use useBigIntExtension, or set largeBigIntToFloat to convert to float-64, or set largeBigIntToString to convert to string");x+=8}else if("undefined"===n)this.encodeUndefinedAsNil?a[x++]=192:(a[x++]=212,a[x++]=0,a[x++]=0);else throw Error("Unknown type: "+n)},F=this.variableMapSize||this.coercibleKeyAsNumber||this.skipValues?e=>{let t,r;if(this.skipValues)for(let r in t=[],e)("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(r))&&!this.skipValues.includes(e[r])&&t.push(r);else t=Object.keys(e);let n=t.length;if(n<16?a[x++]=128|n:n<65536?(a[x++]=222,a[x++]=n>>8,a[x++]=255&n):(a[x++]=223,c.setUint32(x,n),x+=4),this.coercibleKeyAsNumber)for(let i=0;i<n;i++){let n=Number(r=t[i]);N(isNaN(n)?r:n),N(e[r])}else for(let i=0;i<n;i++)N(r=t[i]),N(e[r])}:e=>{a[x++]=222;let r=x-t;x+=2;let n=0;for(let t in e)("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(t))&&(N(t),N(e[t]),n++);if(n>65535)throw Error('Object is too large to serialize with fast 16-bit map size, use the "variableMapSize" option to serialize this object');a[r+++t]=n>>8,a[r+t]=255&n},q=!1===this.useRecords?F:e.progressiveRecords&&!A?e=>{let r,i,s=n.transitions||(n.transitions=Object.create(null)),o=x++-t;for(let a in e)if("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(a)){if(i=s[a])s=i;else{let l=Object.keys(e),c=s;s=n.transitions;let h=0;for(let e=0,t=l.length;e<t;e++){let t=l[e];!(i=s[t])&&(i=s[t]=Object.create(null),h++),s=i}o+t+1==x?(x--,J(s,l,h)):G(s,l,o,h),r=!0,s=c[a]}N(e[a])}if(!r){let r=s[I];r?a[o+t]=r:G(s,Object.keys(e),o,0)}}:e=>{let t,r=n.transitions||(n.transitions=Object.create(null)),i=0;for(let n in e)("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(n))&&(!(t=r[n])&&(t=r[n]=Object.create(null),i++),r=t);let s=r[I];for(let t in s?s>=96&&A?(a[x++]=(31&(s-=96))+96,a[x++]=s>>5):a[x++]=s:J(r,r.__keys__||Object.keys(e),i),e)("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(t))&&N(e[t])},$="function"==typeof this.useRecords&&this.useRecords,z=$?e=>{$(e)?q(e):F(e)}:q,H=e=>{let r;if(e>0x1000000){if(e-t>w)throw Error("Packed buffer would be larger than maximum buffer size");r=Math.min(w,4096*Math.round(Math.max((e-t)*(e>0x4000000?1.25:2),4194304)/4096))}else r=(Math.max(e-t<<2,a.length-1)>>12)+1<<12;let n=new m(r);return c=n.dataView||(n.dataView=new DataView(n.buffer,0,r)),e=Math.min(e,a.length),a.copy?a.copy(n,0,t,e):n.set(a.slice(t,e)),x-=t,t=0,h=n.length-10,a=n},J=(e,t,i)=>{let s=n.nextId;s||(s=64),s<_&&this.shouldShareStructure&&!this.shouldShareStructure(t)?((s=n.nextOwnId)<D||(s=_),n.nextOwnId=s+1):(s>=D&&(s=_),n.nextId=s+1);let o=t.highByte=s>=96&&A?s-96>>5:-1;e[I]=s,e.__keys__=t,n[s-64]=t,s<_?(t.isShared=!0,n.sharedLength=s-63,r=!0,o>=0?(a[x++]=(31&s)+96,a[x++]=o):a[x++]=s):(o>=0?(a[x++]=213,a[x++]=114,a[x++]=(31&s)+96,a[x++]=o):(a[x++]=212,a[x++]=114,a[x++]=s),i&&(B+=O*i),j.length>=T&&(j.shift()[I]=0),j.push(e),N(t))},G=(e,r,n,i)=>{let s=a,o=x,c=h,d=t;x=0,t=0,(a=l)||(l=a=new m(8192)),h=a.length-10,J(e,r,i),l=a;let u=x;if(a=s,x=o,h=c,t=d,u>1){let e=x+u-1;e>h&&H(e);let r=n+t;a.copyWithin(r+u,r+1,x),a.set(l.slice(0,u),r),x=e}else a[n+t]=l[0]},Y=e=>{let i=d(e,a,t,x,n,H,(e,t,n)=>{if(n)return r=!0;x=t;let i=a;return(N(e),R(),i!==a)?{position:x,targetView:c,target:a}:x},this);if(0===i)return z(e);x=i}}useBuffer(e){(a=e).dataView||(a.dataView=new DataView(a.buffer,a.byteOffset,a.byteLength)),x=0}set position(e){x=e}get position(){return x}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}function v(e,t,r,n){let i=e.byteLength;if(i+1<256){var{target:s,position:o}=r(4+i);s[o++]=199,s[o++]=i+1}else if(i+1<65536){var{target:s,position:o}=r(5+i);s[o++]=200,s[o++]=i+1>>8,s[o++]=i+1&255}else{var{target:s,position:o,targetView:a}=r(7+i);s[o++]=201,a.setUint32(o,i+1),o+=4}s[o++]=116,s[o++]=t,e.buffer||(e=new Uint8Array(e)),s.set(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),o)}function k(e,t){let r=e.byteLength;if(r<256){var n,i,{target:n,position:i}=t(r+2);n[i++]=196,n[i++]=r}else if(r<65536){var{target:n,position:i}=t(r+3);n[i++]=197,n[i++]=r>>8,n[i++]=255&r}else{var{target:n,position:i,targetView:s}=t(r+5);n[i++]=198,s.setUint32(i,r),i+=4}n.set(e,i)}function U(e,t,r){if(b.length>0){c.setUint32(b.position+e,x+r-b.position-e),b.stringsPosition=x-e;let n=b;b=null,t(n[0]),t(n[1])}}function T(e){if(e.Class){if(!e.pack&&!e.write)throw Error("Extension has no pack or write function");if(e.pack&&!e.type)throw Error("Extension has no type (numeric code to identify the extension)");o.unshift(e.Class),s.unshift(e)}(0,f.addExtension)(e)}function C(e,t){return e.isCompatible=e=>{let r=!e||(t.lastNamedStructuresLength||0)===e.length;return r||t._mergeStructures(e),r},e}function A(e,t){d=e,C=t}o=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,f.C1Type],s=[{pack(e,t,r){let n=e.getTime()/1e3;if((this.useTimestamp32||0===e.getMilliseconds())&&n>=0&&n<0x100000000){let{target:e,targetView:r,position:i}=t(6);e[i++]=214,e[i++]=255,r.setUint32(i,n)}else if(n>0&&n<0x100000000){let{target:r,targetView:i,position:s}=t(10);r[s++]=215,r[s++]=255,i.setUint32(s,4e6*e.getMilliseconds()+(n/1e3/0x100000000>>0)),i.setUint32(s+4,n)}else if(isNaN(n)){if(this.onInvalidDate)return t(0),r(this.onInvalidDate());let{target:e,targetView:n,position:i}=t(3);e[i++]=212,e[i++]=255,e[i++]=255}else{let{target:r,targetView:i,position:s}=t(15);r[s++]=199,r[s++]=12,r[s++]=255,i.setUint32(s,1e6*e.getMilliseconds()),i.setBigInt64(s+4,BigInt(Math.floor(n)))}}},{pack(e,t,r){if(this.setAsEmptyObject)return t(0),r({});let n=Array.from(e),{target:i,position:s}=t(3*!!this.moreTypes);this.moreTypes&&(i[s++]=212,i[s++]=115,i[s++]=0),r(n)}},{pack(e,t,r){let{target:n,position:i}=t(3*!!this.moreTypes);this.moreTypes&&(n[i++]=212,n[i++]=101,n[i++]=0),r([e.name,e.message,e.cause])}},{pack(e,t,r){let{target:n,position:i}=t(3*!!this.moreTypes);this.moreTypes&&(n[i++]=212,n[i++]=120,n[i++]=0),r([e.source,e.flags])}},{pack(e,t){this.moreTypes?v(e,16,t):k(g?p.from(e):new Uint8Array(e),t)}},{pack(e,t){let r=e.constructor;r!==y&&this.moreTypes?v(e,(0,f.typedArrays).indexOf(r.name),t):k(e,t)}},{pack(e,t){let{target:r,position:n}=t(1);r[n]=193}}];let _=new S({useRecords:!1}),D=_.pack,j=_.pack,B=S,{NEVER:O,ALWAYS:R,DECIMAL_ROUND:M,DECIMAL_FIT:N}=f.FLOAT32_OPTIONS,L=512,V=1024,P=2048},{d39b59f28483d155:"b48lF","./unpack.js":"34MFG","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],"34MFG":[function(e,t,r,n){var i,s,o,a,l,c,h,d,u,f,p,g=e("@parcel/transformer-js/src/esmodule-helpers.js");g.defineInteropFlag(r),g.export(r,"C1Type",()=>U),g.export(r,"C1",()=>T),g.export(r,"Unpackr",()=>_),g.export(r,"getPosition",()=>D),g.export(r,"checkedRead",()=>j),g.export(r,"read",()=>O),g.export(r,"loadStructures",()=>L),g.export(r,"isNativeAccelerationEnabled",()=>$),g.export(r,"setExtractor",()=>z),g.export(r,"readString",()=>J),g.export(r,"typedArrays",()=>eo),g.export(r,"clearSource",()=>eh),g.export(r,"addExtension",()=>ed),g.export(r,"mult10",()=>eu),g.export(r,"Decoder",()=>ef),g.export(r,"unpack",()=>eg),g.export(r,"unpackMultiple",()=>em),g.export(r,"decode",()=>ey),g.export(r,"FLOAT32_OPTIONS",()=>ew),g.export(r,"roundFloat32",()=>eE),g.export(r,"setReadStruct",()=>eI);var m=e("b5a1b40c14b71778").Buffer;try{i=new TextDecoder}catch(e){}var y=0;let w=[];var x=w,b=0,E={},I=0,S=0,v=[],k={useRecords:!1,mapsAsObjects:!0};class U{}let T=new U;T.name="MessagePack 0xC1";var C=!1,A=2;try{Function("")}catch(e){A=1/0}class _{constructor(e){e&&(!1===e.useRecords&&void 0===e.mapsAsObjects&&(e.mapsAsObjects=!0),!e.sequential||!1===e.trusted||(e.trusted=!0,e.structures||!1==e.useRecords||(e.structures=[],e.maxSharedStructures||(e.maxSharedStructures=0))),e.structures?e.structures.sharedLength=e.structures.length:e.getStructures&&((e.structures=[]).uninitialized=!0,e.structures.sharedLength=0),e.int64AsNumber&&(e.int64AsType="number")),Object.assign(this,e)}unpack(e,t){if(s)return ec(()=>(eh(),this?this.unpack(e,t):_.prototype.unpack.call(k,e,t)));e.buffer||e.constructor!==ArrayBuffer||(e=void 0!==m?m.from(e):new Uint8Array(e)),"object"==typeof t?(o=t.end||e.length,y=t.start||0):(y=0,o=t>-1?t:e.length),b=0,S=0,l=null,x=w,c=null,s=e;try{d=e.dataView||(e.dataView=new DataView(e.buffer,e.byteOffset,e.byteLength))}catch(t){if(s=null,e instanceof Uint8Array)throw t;throw Error("Source must be a Uint8Array or Buffer but was a "+(e&&"object"==typeof e?e.constructor.name:typeof e))}return this instanceof _?(E=this,this.structures?a=this.structures:(!a||a.length>0)&&(a=[])):(E=k,(!a||a.length>0)&&(a=[])),j(t)}unpackMultiple(e,t){let r,n=0;try{C=!0;let i=e.length,s=this?this.unpack(e,i):ep.unpack(e,i);if(t){if(!1===t(s,n,y))return;for(;y<i;)if(n=y,!1===t(j(),n,y))return}else{for(r=[s];y<i;)n=y,r.push(j());return r}}catch(e){throw e.lastPosition=n,e.values=r,e}finally{C=!1,eh()}}_mergeStructures(e,t){f&&(e=f.call(this,e)),Object.isFrozen(e=e||[])&&(e=e.map(e=>e.slice(0)));for(let t=0,r=e.length;t<r;t++){let r=e[t];r&&(r.isShared=!0,t>=32&&(r.highByte=t-32>>5))}for(let r in e.sharedLength=e.length,t||[])if(r>=0){let n=e[r],i=t[r];i&&(n&&((e.restoreStructures||(e.restoreStructures=[]))[r]=n),e[r]=i)}return this.structures=e}decode(e,t){return this.unpack(e,t)}}function D(){return y}function j(e){try{let t;if(!E.trusted&&!C){let e=a.sharedLength||0;e<a.length&&(a.length=e)}if(E.randomAccessStructure&&s[y]<64&&s[y]>=32&&u?(t=u(s,y,o,E),s=null,!(e&&e.lazy)&&t&&(t=t.toJSON()),y=o):t=O(),c&&(y=c.postBundlePosition,c=null),C&&(a.restoreStructures=null),y==o)a&&a.restoreStructures&&B(),a=null,s=null,h&&(h=null);else if(y>o)throw Error("Unexpected end of MessagePack data");else if(!C){let e;try{e=JSON.stringify(t,(e,t)=>"bigint"==typeof t?`${t}n`:t).slice(0,100)}catch(t){e="(JSON view not available "+t+")"}throw Error("Data read, but end of buffer not reached "+e)}return t}catch(e){throw a&&a.restoreStructures&&B(),eh(),(e instanceof RangeError||e.message.startsWith("Unexpected end of buffer")||y>o)&&(e.incomplete=!0),e}}function B(){for(let e in a.restoreStructures)a[e]=a.restoreStructures[e];a.restoreStructures=null}function O(){let e=s[y++];if(e<160){if(e<128){if(e<64)return e;{let t=a[63&e]||E.getStructures&&L()[63&e];return t?(t.read||(t.read=M(t,63&e)),t.read()):e}}if(e<144){if(e-=128,E.mapsAsObjects){let t={};for(let r=0;r<e;r++){let e=er();"__proto__"===e&&(e="__proto_"),t[e]=O()}return t}{let t=new Map;for(let r=0;r<e;r++)t.set(O(),O());return t}}{let t=Array(e-=144);for(let r=0;r<e;r++)t[r]=O();return E.freezeData?Object.freeze(t):t}}if(e<192){let t=e-160;if(S>=y)return l.slice(y-I,(y+=t)-I);if(0==S&&o<140){let e=t<16?K(t):X(t);if(null!=e)return e}return V(t)}{let t;switch(e){case 192:return null;case 193:if(c){if((t=O())>0)return c[1].slice(c.position1,c.position1+=t);return c[0].slice(c.position0,c.position0-=t)}return T;case 194:return!1;case 195:return!0;case 196:if(void 0===(t=s[y++]))throw Error("Unexpected end of buffer");return Z(t);case 197:return t=d.getUint16(y),y+=2,Z(t);case 198:return t=d.getUint32(y),y+=4,Z(t);case 199:return ee(s[y++]);case 200:return t=d.getUint16(y),y+=2,ee(t);case 201:return t=d.getUint32(y),y+=4,ee(t);case 202:if(t=d.getFloat32(y),E.useFloat32>2){let e=eu[(127&s[y])<<1|s[y+1]>>7];return y+=4,(e*t+(t>0?.5:-.5)>>0)/e}return y+=4,t;case 203:return t=d.getFloat64(y),y+=8,t;case 204:return s[y++];case 205:return t=d.getUint16(y),y+=2,t;case 206:return t=d.getUint32(y),y+=4,t;case 207:return"number"===E.int64AsType?t=0x100000000*d.getUint32(y)+d.getUint32(y+4):"string"===E.int64AsType?t=d.getBigUint64(y).toString():"auto"===E.int64AsType?(t=d.getBigUint64(y))<=BigInt(2)<<BigInt(52)&&(t=Number(t)):t=d.getBigUint64(y),y+=8,t;case 208:return d.getInt8(y++);case 209:return t=d.getInt16(y),y+=2,t;case 210:return t=d.getInt32(y),y+=4,t;case 211:return"number"===E.int64AsType?t=0x100000000*d.getInt32(y)+d.getUint32(y+4):"string"===E.int64AsType?t=d.getBigInt64(y).toString():"auto"===E.int64AsType?(t=d.getBigInt64(y))>=BigInt(-2)<<BigInt(52)&&t<=BigInt(2)<<BigInt(52)&&(t=Number(t)):t=d.getBigInt64(y),y+=8,t;case 212:if(114==(t=s[y++]))return ei(63&s[y++]);{let e=v[t];if(e){if(e.read)return y++,e.read(O());if(e.noBuffer)return y++,e();return e(s.subarray(y,++y))}throw Error("Unknown extension "+t)}case 213:if(114==(t=s[y]))return y++,ei(63&s[y++],s[y++]);return ee(2);case 214:return ee(4);case 215:return ee(8);case 216:return ee(16);case 217:if(t=s[y++],S>=y)return l.slice(y-I,(y+=t)-I);return P(t);case 218:if(t=d.getUint16(y),y+=2,S>=y)return l.slice(y-I,(y+=t)-I);return F(t);case 219:if(t=d.getUint32(y),y+=4,S>=y)return l.slice(y-I,(y+=t)-I);return q(t);case 220:return t=d.getUint16(y),y+=2,G(t);case 221:return t=d.getUint32(y),y+=4,G(t);case 222:return t=d.getUint16(y),y+=2,Y(t);case 223:return t=d.getUint32(y),y+=4,Y(t);default:if(e>=224)return e-256;if(void 0===e){let e=Error("Unexpected end of MessagePack data");throw e.incomplete=!0,e}throw Error("Unknown MessagePack token "+e)}}}let R=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function M(e,t){function r(){if(r.count++>A){let r=e.read=Function("r","return function(){return "+(E.freezeData?"Object.freeze":"")+"({"+e.map(e=>"__proto__"===e?"__proto_:r()":R.test(e)?e+":r()":"["+JSON.stringify(e)+"]:r()").join(",")+"})}")(O);return 0===e.highByte&&(e.read=N(t,e.read)),r()}let n={};for(let t=0,r=e.length;t<r;t++){let r=e[t];"__proto__"===r&&(r="__proto_"),n[r]=O()}return E.freezeData?Object.freeze(n):n}return(r.count=0,0===e.highByte)?N(t,r):r}let N=(e,t)=>function(){let r=s[y++];if(0===r)return t();let n=e<32?-(e+(r<<5)):e+(r<<5),i=a[n]||L()[n];if(!i)throw Error("Record id is not defined for "+n);return i.read||(i.read=M(i,e)),i.read()};function L(){let e=ec(()=>(s=null,E.getStructures()));return a=E._mergeStructures(e,a)}var V=H,P=H,F=H,q=H;let $=!1;function z(e){function t(t){return function(r){let n=x[b++];if(null==n){if(c)return H(r);let i=s.byteOffset,a=e(y-t+i,o+i,s.buffer);if("string"==typeof a)n=a,x=w;else if(b=1,S=1,void 0===(n=(x=a)[0]))throw Error("Unexpected end of buffer")}let i=n.length;return i<=r?(y+=r,n):(l=n,I=y,S=y+i,y+=r,n.slice(0,r))}}$=!0,V=t(1),P=t(2),F=t(3),q=t(5)}function H(e){let t;if(e<16&&(t=K(e)))return t;if(e>64&&i)return i.decode(s.subarray(y,y+=e));let r=y+e,n=[];for(t="";y<r;){let e=s[y++];if((128&e)==0)n.push(e);else if((224&e)==192){let t=63&s[y++];n.push((31&e)<<6|t)}else if((240&e)==224){let t=63&s[y++],r=63&s[y++];n.push((31&e)<<12|t<<6|r)}else if((248&e)==240){let t=63&s[y++],r=(7&e)<<18|t<<12|(63&s[y++])<<6|63&s[y++];r>65535&&(r-=65536,n.push(r>>>10&1023|55296),r=56320|1023&r),n.push(r)}else n.push(e);n.length>=4096&&(t+=W.apply(String,n),n.length=0)}return n.length>0&&(t+=W.apply(String,n)),t}function J(e,t,r){let n=s;s=e,y=t;try{return H(r)}finally{s=n}}function G(e){let t=Array(e);for(let r=0;r<e;r++)t[r]=O();return E.freezeData?Object.freeze(t):t}function Y(e){if(E.mapsAsObjects){let t={};for(let r=0;r<e;r++){let e=er();"__proto__"===e&&(e="__proto_"),t[e]=O()}return t}{let t=new Map;for(let r=0;r<e;r++)t.set(O(),O());return t}}var W=String.fromCharCode;function X(e){let t=y,r=Array(e);for(let n=0;n<e;n++){let e=s[y++];if((128&e)>0){y=t;return}r[n]=e}return W.apply(String,r)}function K(e){if(e<4){if(e<2){if(0===e)return"";{let e=s[y++];if((128&e)>1){y-=1;return}return W(e)}}{let t=s[y++],r=s[y++];if((128&t)>0||(128&r)>0){y-=2;return}if(e<3)return W(t,r);let n=s[y++];if((128&n)>0){y-=3;return}return W(t,r,n)}}{let t=s[y++],r=s[y++],n=s[y++],i=s[y++];if((128&t)>0||(128&r)>0||(128&n)>0||(128&i)>0){y-=4;return}if(e<6){if(4===e)return W(t,r,n,i);{let e=s[y++];if((128&e)>0){y-=5;return}return W(t,r,n,i,e)}}if(e<8){let o=s[y++],a=s[y++];if((128&o)>0||(128&a)>0){y-=6;return}if(e<7)return W(t,r,n,i,o,a);let l=s[y++];if((128&l)>0){y-=7;return}return W(t,r,n,i,o,a,l)}{let o=s[y++],a=s[y++],l=s[y++],c=s[y++];if((128&o)>0||(128&a)>0||(128&l)>0||(128&c)>0){y-=8;return}if(e<10){if(8===e)return W(t,r,n,i,o,a,l,c);{let e=s[y++];if((128&e)>0){y-=9;return}return W(t,r,n,i,o,a,l,c,e)}}if(e<12){let h=s[y++],d=s[y++];if((128&h)>0||(128&d)>0){y-=10;return}if(e<11)return W(t,r,n,i,o,a,l,c,h,d);let u=s[y++];if((128&u)>0){y-=11;return}return W(t,r,n,i,o,a,l,c,h,d,u)}{let h=s[y++],d=s[y++],u=s[y++],f=s[y++];if((128&h)>0||(128&d)>0||(128&u)>0||(128&f)>0){y-=12;return}if(e<14){if(12===e)return W(t,r,n,i,o,a,l,c,h,d,u,f);{let e=s[y++];if((128&e)>0){y-=13;return}return W(t,r,n,i,o,a,l,c,h,d,u,f,e)}}{let p=s[y++],g=s[y++];if((128&p)>0||(128&g)>0){y-=14;return}if(e<15)return W(t,r,n,i,o,a,l,c,h,d,u,f,p,g);let m=s[y++];if((128&m)>0){y-=15;return}return W(t,r,n,i,o,a,l,c,h,d,u,f,p,g,m)}}}}}function Q(){let e,t=s[y++];if(t<192)e=t-160;else switch(t){case 217:e=s[y++];break;case 218:e=d.getUint16(y),y+=2;break;case 219:e=d.getUint32(y),y+=4;break;default:throw Error("Expected string")}return H(e)}function Z(e){return E.copyBuffers?Uint8Array.prototype.slice.call(s,y,y+=e):s.subarray(y,y+=e)}function ee(e){let t=s[y++];if(v[t]){let r;return v[t](s.subarray(y,r=y+=e),e=>{y=e;try{return O()}finally{y=r}})}throw Error("Unknown extension type "+t)}var et=Array(4096);function er(){let e,t=s[y++];if(!(t>=160)||!(t<192))return y--,en(O());if(t-=160,S>=y)return l.slice(y-I,(y+=t)-I);if(!(0==S&&o<180))return V(t);let r=(t<<5^(t>1?d.getUint16(y):t>0?s[y]:0))&4095,n=et[r],i=y,a=y+t-3,c=0;if(n&&n.bytes==t){for(;i<a;){if((e=d.getUint32(i))!=n[c++]){i=0x70000000;break}i+=4}for(a+=3;i<a;)if((e=s[i++])!=n[c++]){i=0x70000000;break}if(i===a)return y=i,n.string;a-=3,i=y}for(n=[],et[r]=n,n.bytes=t;i<a;)e=d.getUint32(i),n.push(e),i+=4;for(a+=3;i<a;)e=s[i++],n.push(e);let h=t<16?K(t):X(t);return null!=h?n.string=h:n.string=V(t)}function en(e){if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e||"bigint"==typeof e)return e.toString();if(null==e)return e+"";throw Error("Invalid property type for record",typeof e)}let ei=(e,t)=>{let r=O().map(en),n=e;void 0!==t&&(e=e<32?-((t<<5)+e):(t<<5)+e,r.highByte=t);let i=a[e];return i&&(i.isShared||C)&&((a.restoreStructures||(a.restoreStructures=[]))[e]=i),a[e]=r,r.read=M(r,n),r.read()};v[0]=()=>{},v[0].noBuffer=!0,v[66]=e=>{let t=e.length,r=BigInt(128&e[0]?e[0]-256:e[0]);for(let n=1;n<t;n++)r<<=BigInt(8),r+=BigInt(e[n]);return r};let es={Error,TypeError,ReferenceError};v[101]=()=>{let e=O();return(es[e[0]]||Error)(e[1],{cause:e[2]})},v[105]=e=>{let t;if(!1===E.structuredClone)throw Error("Structured clone extension is disabled");let r=d.getUint32(y-4);h||(h=new Map);let n=s[y],i={target:t=n>=144&&n<160||220==n||221==n?[]:{}};h.set(r,i);let o=O();return i.used?Object.assign(t,o):(i.target=o,o)},v[112]=e=>{if(!1===E.structuredClone)throw Error("Structured clone extension is disabled");let t=d.getUint32(y-4),r=h.get(t);return r.used=!0,r.target},v[115]=()=>new Set(O());let eo=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(e=>e+"Array"),ea="object"==typeof globalThis?globalThis:window;v[116]=e=>{let t=e[0],r=eo[t];if(!r){if(16===t){let t=new ArrayBuffer(e.length-1);return new Uint8Array(t).set(e.subarray(1)),t}throw Error("Could not find typed array for code "+t)}return new ea[r](Uint8Array.prototype.slice.call(e,1).buffer)},v[120]=()=>{let e=O();return new RegExp(e[0],e[1])};let el=[];function ec(e){p&&p();let t=o,r=y,n=b,i=I,u=S,f=l,g=x,m=h,w=c,v=new Uint8Array(s.slice(0,o)),k=a,U=a.slice(0,a.length),T=E,A=C,_=e();return o=t,y=r,b=n,I=i,S=u,l=f,x=g,h=m,c=w,s=v,C=A,(a=k).splice(0,a.length,...U),E=T,d=new DataView(s.buffer,s.byteOffset,s.byteLength),_}function eh(){s=null,h=null,a=null}function ed(e){e.unpack?v[e.type]=e.unpack:v[e.type]=e}v[98]=e=>{let t=(e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3],r=y;return y+=t-e.length,c=el,(c=[Q(),Q()]).position0=0,c.position1=0,c.postBundlePosition=y,y=r,O()},v[255]=e=>4==e.length?new Date((0x1000000*e[0]+(e[1]<<16)+(e[2]<<8)+e[3])*1e3):8==e.length?new Date(((e[0]<<22)+(e[1]<<14)+(e[2]<<6)+(e[3]>>2))/1e6+((3&e[3])*0x100000000+0x1000000*e[4]+(e[5]<<16)+(e[6]<<8)+e[7])*1e3):12==e.length?new Date(((e[0]<<24)+(e[1]<<16)+(e[2]<<8)+e[3])/1e6+((128&e[4]?-0x1000000000000:0)+0x10000000000*e[6]+0x100000000*e[7]+0x1000000*e[8]+(e[9]<<16)+(e[10]<<8)+e[11])*1e3):new Date("invalid");let eu=Array(147);for(let e=0;e<256;e++)eu[e]=+("1e"+Math.floor(45.15-.30103*e));let ef=_;var ep=new _({useRecords:!1});let eg=ep.unpack,em=ep.unpackMultiple,ey=ep.unpack,ew={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4},ex=new Float32Array(1),eb=new Uint8Array(ex.buffer,0,4);function eE(e){ex[0]=e;let t=eu[(127&eb[3])<<1|eb[2]>>7];return(t*e+(e>0?.5:-.5)>>0)/t}function eI(e,t,r){u=e,f=t,p=r}},{b5a1b40c14b71778:"b48lF","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],"737vE":[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");i.defineInteropFlag(r),i.export(r,"packIter",()=>l),i.export(r,"unpackIter",()=>h),i.export(r,"decodeIter",()=>d),i.export(r,"encodeIter",()=>u);var s=e("./pack.js"),o=e("./unpack.js"),a=e("cf54f4ca76cd8e1c").Buffer;function l(e,t={}){if(e&&"object"==typeof e){if("function"==typeof e[Symbol.iterator])return function*(e,t){let r=new s.Packr(t);for(let t of e)yield r.pack(t)}(e,t);if("function"==typeof e.then||"function"==typeof e[Symbol.asyncIterator])return c(e,t);else throw Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a Promise")}throw Error("first argument must be an Iterable, Async Iterable, or a Promise for an Async Iterable")}async function*c(e,t){let r=new s.Packr(t);for await(let t of e)yield r.pack(t)}function h(e,t={}){let r;if(!e||"object"!=typeof e)throw Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a promise");let n=new o.Unpackr(t),i=e=>{let t;r&&(e=a.concat([r,e]),r=void 0);try{t=n.unpackMultiple(e)}catch(n){if(n.incomplete)r=e.slice(n.lastPosition),t=n.values;else throw n}return t};return"function"==typeof e[Symbol.iterator]?function*(){for(let t of e)yield*i(t)}():"function"==typeof e[Symbol.asyncIterator]?async function*(){for await(let t of e)yield*i(t)}():void 0}let d=h,u=l},{cf54f4ca76cd8e1c:"b48lF","./pack.js":"1Gqa1","./unpack.js":"34MFG","@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}],blYkP:[function(e,t,r,n){var i=e("@parcel/transformer-js/src/esmodule-helpers.js");async function s(e,t){for(;!e.remoteDescription;)await new Promise(e=>setTimeout(e,500));if(t.length>0)try{await Promise.all(t.map(t=>e.addIceCandidate(new RTCIceCandidate(t)))),t=[]}catch(e){console.error("Error adding pending ICE candidates:",e)}return t}async function o(e,t,r){if(!e)return r;try{e.remoteDescription?await e.addIceCandidate(new RTCIceCandidate(t)):r.push(t)}catch(e){console.log("ICE candidate error:",e)}return r}i.defineInteropFlag(r),i.export(r,"StreamServer",()=>l),i.export(r,"StreamClient",()=>c);let a=new Map;class l{constructor(e,t,r){this.pendingCandidates=new Map,this.peerConnections=new Map,this.sessionTimeout=6e5,this.streamHealthChecks=new Map,this.diagnosticsEnabled=!0,this.diagnosticsLog=[],this.maxLogEntries=100,this.context=e,this.stream=t,this.rtcConfig=r,this.sessionId=Date.now().toString(),a.set(this.sessionId,this),this.lastActivity=Date.now(),this.sessionTimeoutTimer=window.setInterval(()=>this.checkSessionTimeout(),6e4),this.heartbeatTimer=window.setInterval(()=>this.checkHeartbeat(),5e3),this.setupMessageHandlers(),this.logDiagnostic("session","created",{sessionId:this.sessionId})}updateActivity(){this.lastActivity=Date.now()}checkSessionTimeout(){Date.now()-this.lastActivity>this.sessionTimeout&&(this.logDiagnostic("session","timeout",{sessionId:this.sessionId,inactiveTime:Date.now()-this.lastActivity}),this.stop())}checkHeartbeat(){this.streamHealthChecks.forEach((e,t)=>{let r=Date.now()-e.lastActivity;r>15e3&&this.logDiagnostic("heartbeat","missing",{peerId:t,timeSinceActivity:r})})}setupMessageHandlers(){this.context.onMessage(({subject:e,from:t,body:r})=>{"requestStream"===e?(this.updateActivity(),this.logDiagnostic("stream","requested",{from:t}),this.broadcastStreamInfo(t)):"heartbeat"===e?(this.updateActivity(),this.streamHealthChecks.has(t)&&(this.streamHealthChecks.get(t).lastActivity=Date.now()),this.context.sendMessage("heartbeatAck",{sessionId:this.sessionId,timestamp:Date.now()},t)):"stream-diagnostic"===e?this.logDiagnostic("client-diagnostic","received",r):"quality-change"===e&&r.sessionId===this.sessionId&&this.logDiagnostic("quality","change-requested",{from:t,quality:r.quality})}),this.context.onMessage(async({subject:e,body:t,from:r})=>{"webrtc-signal"!==e||t.targetPeerId!==this.context.username||t.sessionId!==this.sessionId&&t.sessionId||(this.updateActivity(),this.streamHealthChecks.has(r)&&(this.streamHealthChecks.get(r).lastActivity=Date.now()),this.handleSignaling(r,t))}),setTimeout(()=>{this.updateActivity(),this.broadcastStreamInfo()},500)}broadcastStreamInfo(e=null){let t={roomId:this.context.class_id,peerId:this.context.username,sessionId:this.sessionId,settings:{mirrorX:this.context.module.stationConfig?.mirrorX??!1,mirrorY:this.context.module.stationConfig?.mirrorY??!1,rotate:this.context.module.stationConfig?.rotate??0},stream:{id:this.stream.id,tracks:this.stream.getTracks().map(e=>({kind:e.kind,enabled:e.enabled,id:e.id}))}};e?(this.context.sendMessage("streamCredentials",t,e),this.logDiagnostic("stream","credentials-sent",{to:e})):(this.context.sendMessage("streamCredentials",t),this.logDiagnostic("stream","credentials-broadcast"))}async handleSignaling(e,t){let r=this.peerConnections.get(e);try{if("offer"===t.type){this.logDiagnostic("signaling","offer-received",{from:e}),t.iceRestart&&this.logDiagnostic("ice","restart-requested",{from:e}),r=this.createNewPeerConnection(e),await r.setRemoteDescription(new RTCSessionDescription(t.sdp)).catch(e=>{throw this.logDiagnostic("error","set-remote-description-failed",{error:e.toString()}),e}),this.pendingCandidates.set(e,await s(r,this.pendingCandidates.get(e)||[]));let n=await r.createAnswer().catch(e=>{throw this.logDiagnostic("error","create-answer-failed",{error:e.toString()}),e});await r.setLocalDescription(n).catch(e=>{throw this.logDiagnostic("error","set-local-description-failed",{error:e.toString()}),e}),this.context.sendMessage("webrtc-signal",{type:"answer",sdp:n,sessionId:this.sessionId,targetPeerId:e,fromPeerId:this.context.username}),this.logDiagnostic("signaling","answer-sent",{to:e})}else if("ice-candidate"===t.type)r||(r=this.createNewPeerConnection(e)),this.pendingCandidates.has(e)||this.pendingCandidates.set(e,[]),this.pendingCandidates.set(e,await o(r,t.candidate,this.pendingCandidates.get(e)||[])),this.logDiagnostic("ice","candidate-received",{from:e});else if("renegotiate"===t.type){if(this.logDiagnostic("signaling","renegotiation-requested",{from:e}),this.peerConnections.has(e)){let t=this.peerConnections.get(e);if(t)try{t.close()}catch(e){this.logDiagnostic("warning","close-old-connection-failed",{error:e.toString()})}}r=this.createNewPeerConnection(e),this.context.sendMessage("webrtc-signal",{type:"reconnect",sessionId:this.sessionId,targetPeerId:e,fromPeerId:this.context.username}),this.logDiagnostic("signaling","reconnect-sent",{to:e})}else"ice-restart-request"===t.type&&(this.logDiagnostic("ice","restart-request-received",{from:e}),r&&"closed"!==r.iceConnectionState&&(this.context.sendMessage("webrtc-signal",{type:"reconnect",sessionId:this.sessionId,targetPeerId:e,fromPeerId:this.context.username}),this.logDiagnostic("signaling","reconnect-sent-for-ice-restart",{to:e})))}catch(r){this.logDiagnostic("error","signaling-error",{from:e,error:r.toString(),signalType:t.type}),this.context.sendMessage("webrtc-signal",{type:"reconnect",sessionId:this.sessionId,targetPeerId:e,fromPeerId:this.context.username})}}createNewPeerConnection(e){if(this.peerConnections.has(e)){let t=this.peerConnections.get(e);if(t)try{t.close()}catch(e){this.logDiagnostic("warning","close-old-connection-failed",{error:e.toString()})}}let t=new RTCPeerConnection(this.rtcConfig);return this.peerConnections.set(e,t),this.pendingCandidates.set(e,[]),this.streamHealthChecks.set(e,{lastActivity:Date.now(),trackStates:new Map}),this.stream.getTracks().forEach(r=>{let n=r.id;this.streamHealthChecks.get(e)?.trackStates.set(n,!0),r.onended=()=>{this.logDiagnostic("track","ended",{trackId:n,kind:r.kind}),this.streamHealthChecks.has(e)&&this.streamHealthChecks.get(e).trackStates.set(n,!1),this.attemptTrackRecovery(e,n)},r.onmute=()=>{this.logDiagnostic("track","muted",{trackId:n,kind:r.kind})},r.onunmute=()=>{this.logDiagnostic("track","unmuted",{trackId:n,kind:r.kind})},t.addTrack(r,this.stream)}),t.onicecandidate=t=>{t.candidate&&(this.context.sendMessage("webrtc-signal",{type:"ice-candidate",candidate:t.candidate,sessionId:this.sessionId,targetPeerId:e,fromPeerId:this.context.username}),this.logDiagnostic("ice","candidate-sent",{to:e}))},t.oniceconnectionstatechange=()=>{this.logDiagnostic("ice","connection-state-change",{state:t.iceConnectionState,peerId:e}),("failed"===t.iceConnectionState||"disconnected"===t.iceConnectionState)&&(t.restartIce(),this.logDiagnostic("ice","restart-initiated",{peerId:e}),"disconnected"===t.iceConnectionState&&setTimeout(()=>{("disconnected"===t.iceConnectionState||"failed"===t.iceConnectionState)&&(this.context.sendMessage("webrtc-signal",{type:"reconnect",sessionId:this.sessionId,targetPeerId:e,fromPeerId:this.context.username}),this.logDiagnostic("signaling","reconnect-sent-after-ice-failure",{to:e}))},2e3))},t.onsignalingstatechange=()=>{this.logDiagnostic("signaling","state-change",{state:t.signalingState,peerId:e})},t.onconnectionstatechange=()=>{this.logDiagnostic("connection","state-change",{state:t.connectionState,peerId:e}),"connected"===t.connectionState?this.streamHealthChecks.has(e)&&(this.streamHealthChecks.get(e).lastActivity=Date.now()):("failed"===t.connectionState||"disconnected"===t.connectionState)&&(this.logDiagnostic("connection","failure",{state:t.connectionState,peerId:e}),this.context.sendMessage("webrtc-signal",{type:"reconnect",sessionId:this.sessionId,targetPeerId:e,fromPeerId:this.context.username}))},this.startConnectionHealthCheck(e,t),t}startConnectionHealthCheck(e,t){let r=setInterval(()=>{if(!this.peerConnections.has(e)){clearInterval(r);return}"connected"===t.connectionState&&t.getStats().then(r=>{let n=!1;r.forEach(r=>{if("outbound-rtp"===r.type&&"video"===r.kind){n=!0;let i=r.bytesSent,s=this.streamHealthChecks.get(e);s&&void 0!==s.lastBytesSent&&(i<=s.lastBytesSent?(this.logDiagnostic("warning","no-new-video-data",{peerId:e,bytesSent:i,lastBytesSent:s.lastBytesSent}),s.staleIntervals=(s.staleIntervals||0)+1,s.staleIntervals>=3&&(this.logDiagnostic("warning","video-stalled",{peerId:e,staleIntervals:s.staleIntervals}),this.attemptConnectionRecovery(e,t),s.staleIntervals=0)):s.staleIntervals=0),s&&(s.lastBytesSent=i)}}),!n&&this.stream.getVideoTracks().length>0&&(this.logDiagnostic("warning","no-outbound-video-track",{peerId:e}),this.attemptConnectionRecovery(e,t))}).catch(t=>{this.logDiagnostic("error","stats-collection-failed",{peerId:e,error:t.toString()})})},1e4)}attemptTrackRecovery(e,t){let r=this.stream.getTracks().find(e=>e.id===t);if(!r){this.logDiagnostic("warning","track-recovery-failed-not-found",{trackId:t,peerId:e});return}if("video"===r.kind){this.logDiagnostic("recovery","attempting-video-track-recovery",{trackId:t,peerId:e});let n={video:{width:r.getConstraints().width||{ideal:1280},height:r.getConstraints().height||{ideal:720},frameRate:r.getConstraints().frameRate||{ideal:30}}};navigator.mediaDevices.getUserMedia(n).then(e=>{let t=e.getVideoTracks()[0];t&&(this.stream.removeTrack(r),this.stream.addTrack(t),this.peerConnections.forEach((e,r)=>{let n=e.getSenders().find(e=>e.track&&"video"===e.track.kind);n&&n.replaceTrack(t).then(()=>{this.logDiagnostic("recovery","video-track-replaced",{pcPeerId:r,newTrackId:t.id})}).catch(e=>{this.logDiagnostic("error","replace-track-failed",{pcPeerId:r,error:e.toString()})})}),this.logDiagnostic("recovery","video-track-recovery-complete"))}).catch(e=>{this.logDiagnostic("error","get-new-video-track-failed",{error:e.toString()})})}}attemptConnectionRecovery(e,t){this.logDiagnostic("recovery","attempting-connection-recovery",{peerId:e}),"closed"!==t.iceConnectionState?(this.context.sendMessage("webrtc-signal",{type:"ice-restart-request",sessionId:this.sessionId,targetPeerId:e,fromPeerId:this.context.username}),this.logDiagnostic("recovery","ice-restart-requested",{peerId:e}),setTimeout(()=>{this.peerConnections.has(e)&&("disconnected"===t.iceConnectionState||"failed"===t.iceConnectionState)&&(this.context.sendMessage("webrtc-signal",{type:"reconnect",sessionId:this.sessionId,targetPeerId:e,fromPeerId:this.context.username}),this.logDiagnostic("recovery","full-reconnect-requested",{peerId:e}))},5e3)):(this.context.sendMessage("webrtc-signal",{type:"reconnect",sessionId:this.sessionId,targetPeerId:e,fromPeerId:this.context.username}),this.logDiagnostic("recovery","full-reconnect-requested-closed-connection",{peerId:e}))}logDiagnostic(e,t,r){if(!this.diagnosticsEnabled)return;let n={timestamp:new Date().toISOString(),category:e,event:t,data:r};this.diagnosticsLog.push(n),this.diagnosticsLog.length>this.maxLogEntries&&this.diagnosticsLog.shift(),console.log(`[${e}] ${t}`,r||""),("error"===e||"critical"===e)&&r&&r.peerId&&this.context.sendMessage("stream-diagnostic",{diagnostic:n,sessionId:this.sessionId,fromPeerId:this.context.username},r.peerId)}getDiagnosticLogs(){let e={};return this.peerConnections.forEach((t,r)=>{e[r]={iceConnectionState:t.iceConnectionState,connectionState:t.connectionState,signalingState:t.signalingState}}),{logs:this.diagnosticsLog,connectionStates:e,trackStates:Array.from(this.stream.getTracks()).map(e=>({id:e.id,kind:e.kind,enabled:e.enabled,muted:e.muted,readyState:e.readyState}))}}stop(){this.peerConnections.forEach((e,t)=>{try{e.close()}catch(e){this.logDiagnostic("warning","close-connection-failed",{peerId:t,error:e.toString()})}}),this.peerConnections.clear(),this.pendingCandidates.clear(),this.context.sendMessage("streamStopped",{peerId:this.context.username,sessionId:this.sessionId}),clearInterval(this.sessionTimeoutTimer),clearInterval(this.heartbeatTimer),a.delete(this.sessionId),this.logDiagnostic("session","stopped",{sessionId:this.sessionId})}}class c{constructor(e,t,r){this.peerConnection=null,this.pendingIceCandidates=[],this.reconnectAttempts=0,this.heartbeatInterval=5e3,this.videoTrack=null,this.audioTrack=null,this.lastFrameTimestamp=0,this.lastStats={},this.lastIceActivity=0,this.iceActivityTimeout=8e3,this.adaptiveStreamSettings={currentQuality:"high",networkCondition:"good",resolutionLevels:{high:{width:1280,height:720,frameRate:30},medium:{width:640,height:480,frameRate:20},low:{width:320,height:240,frameRate:15}}},this.diagnosticsEnabled=!0,this.diagnosticsLog=[],this.maxLogEntries=100,this.context=e,this.handler=t,this.rtcConfig=r,this.setupMessageHandlers(),this.requestStream(),this.startHeartbeat(),this.logDiagnostic("client","initialized")}setupMessageHandlers(){this.context.onMessage(({subject:e,body:t})=>{"streamCredentials"===e?(this.logDiagnostic("stream","credentials-received",{peerId:t.peerId,sessionId:t.sessionId}),this.sessionId=t.sessionId,this.peerId=t.peerId,this.connectToPeer(t)):"streamStopped"===e&&t.peerId===this.peerId&&t.sessionId===this.sessionId?(this.logDiagnostic("stream","stopped-by-server",{peerId:t.peerId,sessionId:t.sessionId}),this.cleanupAndReconnect()):"webrtc-signal"===e&&t.targetPeerId===this.context.username?t.sessionId===this.sessionId&&("reconnect"===t.type?(this.logDiagnostic("signaling","reconnect-received"),this.cleanupAndReconnect()):"ice-restart-request"===t.type?(this.logDiagnostic("ice","restart-request-received"),this.performIceRestart()):this.handleSignaling(t)):"heartbeatAck"===e?this.logDiagnostic("heartbeat","ack-received",{sessionId:t.sessionId,serverTime:t.timestamp,roundTripTime:Date.now()-t.timestamp}):"stream-diagnostic"===e&&this.logDiagnostic("server-diagnostic","received",t.diagnostic)})}startHeartbeat(){this.heartbeatTimer=window.setInterval(()=>{this.sessionId&&(this.context.sendMessage("heartbeat",{timestamp:Date.now(),sessionId:this.sessionId}),this.logDiagnostic("heartbeat","sent"))},this.heartbeatInterval)}stopHeartbeat(){this.heartbeatTimer&&(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0)}cleanupAndReconnect(){if(this.logDiagnostic("connection","cleanup-and-reconnect"),this.stopTrackMonitoring(),this.stopIceConnectionMonitoring(),this.peerConnection){try{this.peerConnection.close()}catch(e){this.logDiagnostic("warning","close-connection-failed",{error:e.toString()})}this.peerConnection=null}this.pendingIceCandidates=[],this.stopHeartbeat(),this.reconnectAttempts++;let e=Math.min(2**this.reconnectAttempts*1e3,3e4);this.logDiagnostic("reconnect","scheduled",{attempt:this.reconnectAttempts,delay:e}),clearTimeout(this.reconnectTimer),this.reconnectTimer=window.setTimeout(()=>{this.requestStream(),this.startHeartbeat()},e)}resetReconnectAttempts(){this.reconnectAttempts=0}requestStream(){this.context.sendMessage("requestStream"),this.logDiagnostic("stream","requested")}handleSignaling(e){if(this.peerConnection)try{"answer"===e.type?(this.logDiagnostic("signaling","answer-received"),"have-local-offer"===this.peerConnection.signalingState&&this.peerConnection.setRemoteDescription(new RTCSessionDescription(e.sdp)).then(()=>(this.logDiagnostic("signaling","remote-description-set"),s(this.peerConnection,this.pendingIceCandidates))).then(()=>{this.pendingIceCandidates=[],this.logDiagnostic("ice","pending-candidates-added")}).catch(e=>{this.logDiagnostic("error","handle-answer-failed",{error:e.toString()})})):"ice-candidate"===e.type&&(this.logDiagnostic("ice","candidate-received"),this.peerConnection.remoteDescription?this.peerConnection.addIceCandidate(new RTCIceCandidate(e.candidate)).catch(e=>{this.logDiagnostic("warning","add-ice-candidate-failed",{error:e.toString()})}):(this.pendingIceCandidates.push(e.candidate),this.logDiagnostic("ice","candidate-queued")))}catch(t){this.logDiagnostic("error","signaling-error",{error:t.toString(),signalType:e.type})}}async connectToPeer({roomId:e,peerId:t,settings:r,sessionId:n}){if(this.logDiagnostic("connection","connecting-to-peer",{peerId:t,sessionId:n}),this.peerConnection){try{this.peerConnection.close()}catch(e){this.logDiagnostic("warning","close-existing-connection-failed",{error:e.toString()})}this.pendingIceCandidates=[]}try{this.peerConnection=new RTCPeerConnection(this.rtcConfig),this.setupConnectionStateHandlers(r);let e=await this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0});await this.peerConnection.setLocalDescription(e),this.logDiagnostic("signaling","offer-created-and-set"),this.context.sendMessage("webrtc-signal",{type:"offer",sdp:e,sessionId:n,targetPeerId:t,fromPeerId:this.context.username}),this.logDiagnostic("signaling","offer-sent",{to:t}),this.resetReconnectAttempts()}catch(e){this.logDiagnostic("error","connect-to-peer-failed",{error:e.toString()}),this.cleanupAndReconnect()}}setupConnectionStateHandlers(e){let t=this.peerConnection;t.onsignalingstatechange=()=>{this.logDiagnostic("signaling","state-change",{state:t.signalingState})},t.onconnectionstatechange=()=>{this.logDiagnostic("connection","state-change",{state:t.connectionState}),("failed"===t.connectionState||"disconnected"===t.connectionState)&&(this.logDiagnostic("connection","failure",{state:t.connectionState}),this.cleanupAndReconnect())},t.oniceconnectionstatechange=()=>{this.logDiagnostic("ice","connection-state-change",{state:t.iceConnectionState}),("connected"===t.iceConnectionState||"checking"===t.iceConnectionState)&&(this.lastIceActivity=Date.now()),"failed"===t.iceConnectionState?(this.logDiagnostic("ice","connection-failed"),this.performIceRestart()):"disconnected"===t.iceConnectionState&&(this.logDiagnostic("ice","connection-disconnected"),setTimeout(()=>{"disconnected"===t.iceConnectionState&&this.performIceRestart()},2e3))},t.onicecandidate=e=>{e.candidate&&(this.context.sendMessage("webrtc-signal",{type:"ice-candidate",candidate:e.candidate,sessionId:this.sessionId,targetPeerId:this.peerId,fromPeerId:this.context.username}),this.logDiagnostic("ice","candidate-sent"))},t.ontrack=t=>{this.logDiagnostic("track","received",{kind:t.track.kind,id:t.track.id}),t.streams[0].getTracks().forEach(e=>{"video"===e.kind?(this.videoTrack=e,this.monitorVideoTrack(e)):"audio"===e.kind&&(this.audioTrack=e)}),this.handler(t.streams[0],e),this.startTrackMonitoring(),this.startIceConnectionMonitoring(),this.startAdaptiveBitrateMonitoring()}}monitorVideoTrack(e){e.onmute=()=>{this.logDiagnostic("track","video-muted"),this.attemptTrackRecovery("video")},e.onended=()=>{this.logDiagnostic("track","video-ended"),this.attemptTrackRecovery("video")},e.onunmute=()=>{this.logDiagnostic("track","video-unmuted")}}startTrackMonitoring(){this.stopTrackMonitoring(),this.lastFrameTimestamp=Date.now(),this.trackMonitorInterval=window.setInterval(()=>{this.videoTrack&&((!this.videoTrack.enabled||this.videoTrack.muted)&&(this.logDiagnostic("warning","video-track-disabled-or-muted",{enabled:this.videoTrack.enabled,muted:this.videoTrack.muted}),this.attemptTrackRecovery("video")),this.peerConnection&&this.peerConnection.getStats(this.videoTrack).then(e=>{let t=!1,r=0,n=0;e.forEach(e=>{"inbound-rtp"===e.type&&"video"===e.kind&&(r=e.framesReceived||0,n=e.framesDecoded||0,r>0&&n>0&&(t=!0,this.lastFrameTimestamp=Date.now()))}),!t&&Date.now()-this.lastFrameTimestamp>5e3&&(this.logDiagnostic("warning","no-video-frames",{timeSinceLastFrame:Date.now()-this.lastFrameTimestamp,framesReceived:r,framesDecoded:n}),this.attemptTrackRecovery("video"))}).catch(e=>{this.logDiagnostic("error","get-stats-failed",{error:e.toString()})}))},3e3)}stopTrackMonitoring(){this.trackMonitorInterval&&(clearInterval(this.trackMonitorInterval),this.trackMonitorInterval=void 0)}startIceConnectionMonitoring(){this.stopIceConnectionMonitoring(),this.lastIceActivity=Date.now(),this.iceConnectionMonitorInterval=window.setInterval(()=>{if(!this.peerConnection)return;let e=this.peerConnection;"connected"===e.iceConnectionState&&Date.now()-this.lastIceActivity>this.iceActivityTimeout&&(this.logDiagnostic("warning","ice-connection-stalled",{timeSinceLastActivity:Date.now()-this.lastIceActivity}),this.performIceRestart()),"connected"===e.iceConnectionState&&this.videoTrack&&e.getStats(this.videoTrack).then(e=>{let t=0,r=0;e.forEach(e=>{if("inbound-rtp"===e.type&&"video"===e.kind){if(t=e.bytesReceived||0,r=e.timestamp||0,!this.lastStats.bytesReceived){this.lastStats={bytesReceived:t,timestamp:r};return}t<=this.lastStats.bytesReceived&&(this.logDiagnostic("warning","video-stream-frozen",{bytesReceived:t,lastBytesReceived:this.lastStats.bytesReceived}),this.performIceRestart()),this.lastStats={bytesReceived:t,timestamp:r}}})}).catch(e=>{this.logDiagnostic("error","get-stats-failed",{error:e.toString()})})},5e3)}stopIceConnectionMonitoring(){this.iceConnectionMonitorInterval&&(clearInterval(this.iceConnectionMonitorInterval),this.iceConnectionMonitorInterval=void 0)}startAdaptiveBitrateMonitoring(){let e=window.setInterval(()=>{if(!this.peerConnection){clearInterval(e);return}this.peerConnection.getStats().then(e=>{let t=0,r=0,n=0;e.forEach(e=>{"inbound-rtp"===e.type&&"video"===e.kind&&(t=e.packetsLost||0,r=e.packetsReceived||0),"remote-inbound-rtp"===e.type&&(n=e.roundTripTime||0)});let i=r+t,s=i>0?t/i:0,o="good";s>.1||n>.3?o="poor":(s>.03||n>.15)&&(o="fair"),o!==this.adaptiveStreamSettings.networkCondition&&(this.adaptiveStreamSettings.networkCondition=o,this.adjustStreamQuality(o))}).catch(e=>{this.logDiagnostic("error","get-stats-failed",{error:e.toString()})})},5e3)}adjustStreamQuality(e){let t="high";"poor"===e?t="low":"fair"===e&&(t="medium"),t!==this.adaptiveStreamSettings.currentQuality&&(this.logDiagnostic("quality","adjustment",{from:this.adaptiveStreamSettings.currentQuality,to:t,networkCondition:e}),this.adaptiveStreamSettings.currentQuality=t,this.context.sendMessage("webrtc-signal",{type:"quality-change",quality:t,sessionId:this.sessionId,targetPeerId:this.peerId,fromPeerId:this.context.username}))}attemptTrackRecovery(e){this.logDiagnostic("recovery",`attempting-${e}-track-recovery`),"video"===e&&this.videoTrack&&(this.videoTrack.enabled?this.requestStreamRenegotiation():(this.logDiagnostic("recovery","attempting-to-re-enable-video-track"),this.videoTrack.enabled=!0,setTimeout(()=>{this.videoTrack&&(this.videoTrack.muted||!this.videoTrack.enabled)&&(this.logDiagnostic("recovery","re-enable-failed-requesting-renegotiation"),this.requestStreamRenegotiation())},1e3)))}requestStreamRenegotiation(){this.logDiagnostic("recovery","requesting-stream-renegotiation"),this.context.sendMessage("webrtc-signal",{type:"renegotiate",sessionId:this.sessionId,targetPeerId:this.peerId,fromPeerId:this.context.username})}performIceRestart(){this.peerConnection&&(this.logDiagnostic("ice","performing-restart"),this.peerConnection.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0,iceRestart:!0}).then(e=>(this.logDiagnostic("ice","restart-offer-created"),this.peerConnection.setLocalDescription(e))).then(()=>{this.logDiagnostic("ice","restart-local-description-set"),this.context.sendMessage("webrtc-signal",{type:"offer",sdp:this.peerConnection.localDescription,sessionId:this.sessionId,targetPeerId:this.peerId,fromPeerId:this.context.username,iceRestart:!0}),this.logDiagnostic("ice","restart-offer-sent")}).catch(e=>{this.logDiagnostic("error","ice-restart-failed",{error:e.toString()}),this.cleanupAndReconnect()}))}logDiagnostic(e,t,r){if(!this.diagnosticsEnabled)return;let n={timestamp:new Date().toISOString(),category:e,event:t,data:r};this.diagnosticsLog.push(n),this.diagnosticsLog.length>this.maxLogEntries&&this.diagnosticsLog.shift(),console.log(`[${e}] ${t}`,r||""),("error"===e||"critical"===e)&&this.context.sendMessage("stream-diagnostic",{diagnostic:n,sessionId:this.sessionId,fromPeerId:this.context.username})}getDiagnosticLogs(){return{logs:this.diagnosticsLog,connectionState:this.peerConnection?{iceConnectionState:this.peerConnection.iceConnectionState,connectionState:this.peerConnection.connectionState,signalingState:this.peerConnection.signalingState}:null,videoTrackState:this.videoTrack?{enabled:this.videoTrack.enabled,muted:this.videoTrack.muted,readyState:this.videoTrack.readyState}:null,adaptiveStreamSettings:this.adaptiveStreamSettings}}stop(){this.logDiagnostic("client","stopping"),clearTimeout(this.reconnectTimer),this.stopHeartbeat(),this.stopTrackMonitoring(),this.stopIceConnectionMonitoring(),this.peerConnection&&(this.peerConnection.close(),this.peerConnection=null),this.logDiagnostic("client","stopped")}}},{"@parcel/transformer-js/src/esmodule-helpers.js":"j9EeU"}]},["5Hf22"],"5Hf22","parcelRequiredcf9");